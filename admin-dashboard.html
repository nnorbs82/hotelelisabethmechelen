<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Hotel Elisabeth Mechelen</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <!-- Quill Rich Text Editor -->
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
</head>
<body class="admin-page">
    <header class="admin-header">
        <nav class="admin-top-nav">
            <button class="menu-trigger-btn" id="menu-trigger-btn">MENU</button>
            <h1>Admin Dashboard</h1>
            <button id="logout-btn" class="btn nav-btn btn-logout" aria-label="Logout from admin dashboard">LOG OUT</button>
        </nav>
    </header>

    <!-- Vertical Sidebar Menu -->
    <aside class="vertical-menu" id="vertical-menu">
        <nav class="vertical-menu-nav">
            <ul class="vertical-menu-list">
                <li class="vertical-menu-item has-submenu">
                    <button class="vertical-menu-btn" data-menu="update-index">
                        <span>Update Index</span>
                        <span class="arrow">â€º</span>
                    </button>
                    <div class="vertical-submenu" id="submenu-update-index">
                        <button class="submenu-item" id="main-banner-btn">Main Banner</button>
                        <button class="submenu-item" id="ads-btn">Index Ads</button>
                        <button class="submenu-item" id="ads-bottom-btn">Ads Bottom</button>
                        <button class="submenu-item" id="about-us-btn">About Us</button>
                    </div>
                </li>
                <li class="vertical-menu-item">
                    <button class="vertical-menu-btn" id="manage-rooms-btn">
                        <span>Manage Rooms</span>
                    </button>
                </li>
                <li class="vertical-menu-item">
                    <button class="vertical-menu-btn" id="manage-packages-btn">
                        <span>Manage Packages</span>
                    </button>
                </li>
                <li class="vertical-menu-item">
                    <button class="vertical-menu-btn" id="main-images-btn">
                        <span>Main Images</span>
                    </button>
                </li>
                <li class="vertical-menu-item">
                    <button class="vertical-menu-btn" id="set-amenities-btn">
                        <span>Set Room Amenities</span>
                    </button>
                </li>
                <li class="vertical-menu-item">
                    <button class="vertical-menu-btn" id="manage-facilities-btn">
                        <span>Manage Facilities</span>
                    </button>
                </li>
                <li class="vertical-menu-item">
                    <button class="vertical-menu-btn" id="manage-meetings-btn">
                        <span>Manage Meetings</span>
                    </button>
                </li>
                <li class="vertical-menu-item">
                    <button class="vertical-menu-btn" id="manage-attractions-btn">
                        <span>Manage Attractions</span>
                    </button>
                </li>
                <li class="vertical-menu-item">
                    <button class="vertical-menu-btn" id="manage-info-btn">
                        <span>Manage Info</span>
                    </button>
                </li>
                <li class="vertical-menu-item">
                    <button class="vertical-menu-btn" id="manage-privacy-policy-btn">
                        <span>Manage Privacy Policy</span>
                    </button>
                </li>
                <li class="vertical-menu-item">
                    <button class="vertical-menu-btn" id="manage-terms-btn">
                        <span>Manage Terms & Conditions</span>
                    </button>
                </li>
                <li class="vertical-menu-item">
                    <button class="vertical-menu-btn" id="page-translations-btn">
                        <span>Page Translations</span>
                    </button>
                </li>
            </ul>
        </nav>
    </aside>

    <!-- Sticky Action Bar -->
    <div class="admin-action-bar" id="admin-action-bar">
        <h2 class="admin-action-bar-title" id="action-bar-title">Section Title</h2>
        <div class="admin-action-buttons" id="action-bar-buttons">
            <!-- Buttons will be dynamically added here -->
        </div>
    </div>

    <main class="container">
        <div id="loading" style="text-align: center; padding: 3rem;">
            <p>Loading...</p>
        </div>
        
        <div id="dashboard-content" style="display: none;">
            <!-- Photo Management Card -->
            <div id="photo-management-card" class="card" style="display: none;">
                <h2>Main Banner Photo Management</h2>
                <p style="color: var(--color-sage); margin-bottom: 1rem;">Upload and manage photos for the main banner. Drag and drop photos to reorder them.</p>
                
                <div class="photo-upload-section">
                    <input type="file" id="photo-upload-input" accept="image/*" multiple style="display: none;">
                    <button class="btn" id="add-photo-btn">Add Photos</button>
                    <span class="file-upload-info">(Max 10 images at once)</span>
                </div>

                <div id="photo-grid" class="photo-grid">
                    <!-- Photos will be dynamically added here -->
                </div>
            </div>

            <!-- Index Ads Management Card -->
            <div id="ads-management-card" class="card" style="display: none;">
                <h2>Index Ads Management</h2>
                <p style="color: var(--color-sage); margin-bottom: 1rem;">Manage the three promotional ads displayed on the index page.</p>
                
                <!-- Tab Navigation -->
                <div class="ads-tabs">
                    <button class="ads-tab active" data-ad="ad1">Ad Item 1</button>
                    <button class="ads-tab" data-ad="ad2">Ad Item 2</button>
                    <button class="ads-tab" data-ad="ad3">Ad Item 3</button>
                </div>
                
                <!-- Tab Content -->
                <div id="ads-tab-content">
                    <!-- Content will be rendered by JavaScript -->
                </div>
            </div>

            <!-- About Us Management Card -->
            <div id="about-us-management-card" class="card" style="display: none;">
                <h2>About Us Management</h2>
                <p style="color: var(--color-sage); margin-bottom: 1rem;">Manage the About Us section content displayed on the index page.</p>
                
                <!-- Tab Navigation -->
                <div class="about-us-tabs">
                    <button class="about-us-tab active" data-tab="title">About Us Title</button>
                    <button class="about-us-tab" data-tab="left">About Us Left</button>
                    <button class="about-us-tab" data-tab="right">About Us Right</button>
                </div>
                
                <!-- Tab Content -->
                <div id="about-us-tab-content">
                    <!-- Content will be rendered by JavaScript -->
                </div>
            </div>

            <!-- Ads Bottom Management Card -->
            <div id="ads-bottom-management-card" class="card" style="display: none;">
                <h2>Ads Bottom Management</h2>
                <p style="color: var(--color-sage); margin-bottom: 1rem;">Manage the three promotional ads displayed at the bottom of the index page.</p>
                
                <!-- Tab Navigation -->
                <div class="ads-bottom-tabs">
                    <button class="ads-bottom-tab active" data-tab="titles">Titles</button>
                    <button class="ads-bottom-tab" data-tab="ad1">Ad 1</button>
                    <button class="ads-bottom-tab" data-tab="ad2">Ad 2</button>
                    <button class="ads-bottom-tab" data-tab="ad3">Ad 3</button>
                </div>
                
                <!-- Tab Content -->
                <div id="ads-bottom-tab-content">
                    <!-- Content will be rendered by JavaScript -->
                </div>
            </div>

            <!-- Amenities Management Card -->
            <div id="amenities-management-card" class="card" style="display: none;">
                <h2>Room Amenities Management</h2>
                <p style="color: var(--color-sage); margin-bottom: 1.5rem;">Manage the master list of room amenities. These can be assigned to individual rooms.</p>
                
                <!-- Add New Amenity Section -->
                <div class="amenity-add-section">
                    <h3>Add New Amenity</h3>
                    
                    <!-- Language Tabs with Flags -->
                    <div class="lang-flag-tabs">
                        <button class="lang-flag-tab active" data-lang="en" title="English">ðŸ‡¬ðŸ‡§</button>
                        <button class="lang-flag-tab" data-lang="nl" title="Nederlands">ðŸ‡³ðŸ‡±</button>
                        <button class="lang-flag-tab" data-lang="fr" title="FranÃ§ais">ðŸ‡«ðŸ‡·</button>
                    </div>
                    
                    <div class="form-group">
                        <label id="amenity-name-label">Amenity Name (English)</label>
                        <input type="text" id="amenity-name-input" class="form-control" placeholder="e.g., Free Wi-Fi">
                    </div>
                    
                    <button class="btn" id="add-amenity-btn">Add Amenity</button>
                </div>
                
                <!-- Existing Amenities List -->
                <div class="amenities-list-section">
                    <h3>Existing Amenities</h3>
                    <div id="amenities-list" class="amenities-grid">
                        <!-- Amenities will be dynamically loaded here -->
                    </div>
                </div>
            </div>

            <!-- Room Management Card -->
            <div id="room-management-card" class="card" style="display: none;">
                <h2>Room Management</h2>
                <p style="color: var(--color-sage); margin-bottom: 1rem;">Create, edit, delete, and manage hotel rooms.</p>
                
                <!-- Add New Room Button -->
                <div style="margin: 1rem 0;">
                    <button class="btn" id="add-new-room-btn">Add New Room</button>
                </div>
                
                <!-- Room List Container -->
                <div id="room-list-container">
                    <!-- Rooms will be rendered here -->
                </div>
            </div>

            <!-- Package Management Card -->
            <div id="package-management-card" class="card" style="display: none;">
                <h2>Package Management</h2>
                <p style="color: var(--color-sage); margin-bottom: 1rem;">Create, edit, delete, and reorder hotel packages.</p>
                
                <!-- Tab Navigation for Active/Inactive -->
                <div class="package-tabs">
                    <button class="package-tab active" data-status="active">Active Packages</button>
                    <button class="package-tab" data-status="inactive">Inactive Packages</button>
                </div>
                
                <!-- Add New Package Button -->
                <div style="margin: 1rem 0;">
                    <button class="btn" id="add-package-btn">Add New Package</button>
                </div>
                
                <!-- Package List Container -->
                <div id="package-list-container">
                    <!-- Packages will be rendered here -->
                </div>
            </div>

            <!-- Facilities Management Card -->
            <div id="facilities-management-card" class="card" style="display: none;">
                <h2>Facilities Management</h2>
                <p style="color: var(--color-sage); margin-bottom: 1rem;">Create and manage facilities content, guidelines, and imagery for the facilities page.</p>
                <p class="facility-step-hint">Follow the steps below to add a facility and immediately upload its photos.</p>
                <div class="facility-steps">
                    <div class="facility-step"><span class="facility-step-number">1</span><span>Facility details</span></div>
                    <div class="facility-step"><span class="facility-step-number">2</span><span>Facility photos</span></div>
                    <div class="facility-step"><span class="facility-step-number">3</span><span>Existing facilities & hero image</span></div>
                </div>

                <div class="facility-add-section">
                    <h3>Step 1: Facility Details</h3>
                    <p class="facility-step-hint">Save the details to unlock photo uploads below. We will switch the photo section to the new facility automatically.</p>
                    <div class="lang-flag-tabs">
                        <button class="lang-flag-tab facility-lang-tab active" data-lang="en" title="English">ðŸ‡¬ðŸ‡§</button>
                        <button class="lang-flag-tab facility-lang-tab" data-lang="nl" title="Nederlands">ðŸ‡³ðŸ‡±</button>
                        <button class="lang-flag-tab facility-lang-tab" data-lang="fr" title="FranÃ§ais">ðŸ‡«ðŸ‡·</button>
                    </div>

                    <div class="form-group">
                        <label id="facility-name-label">Facility Name (English)</label>
                        <input type="text" id="facility-name-input" class="form-control" placeholder="e.g., Wellness & Spa">
                    </div>
                    <div class="form-group">
                        <label id="facility-operation-label">Operation & Description (English)</label>
                        <textarea id="facility-operation-input" class="admin-textarea" placeholder="Enter operation details and description"></textarea>
                    </div>
                    <div class="form-group">
                        <label id="facility-guidelines-label">Guidelines (English) - one per line</label>
                        <textarea id="facility-guidelines-input" class="admin-textarea" placeholder="Enter guidelines, one per line"></textarea>
                    </div>

                    <button class="btn" id="add-facility-btn">Save Facility & Start Photos</button>
                </div>

                <div class="facility-library-section">
                    <h3>Step 2: Facility Photo Library</h3>
                    <p style="color: var(--color-sage); margin-bottom: 0.5rem;">Upload and reorder photos for the selected facility. Newly saved facilities are selected automatically.</p>
                    <div id="facility-photo-status" class="facility-photo-status">Select a facility to upload photos.</div>
                    <div class="form-group">
                        <label for="facility-library-select">Facility photo album</label>
                        <select id="facility-library-select" class="form-control"></select>
                    </div>
                    <input type="file" id="facility-library-input" accept="image/*" multiple style="display: none;">
                    <button class="btn" id="upload-facility-library-btn">Add Library Photos</button>
                    <div id="facility-library-grid" class="photo-grid"></div>
                </div>

                <div class="facility-list-section">
                    <h3>Step 3: Existing Facilities</h3>
                    <p class="facility-step-hint">Review the existing facilities below.</p>
                    <div id="facility-list" class="facility-grid"></div>
                </div>
            </div>

            <!-- Meetings Management Card -->
            <div id="meetings-management-card" class="card" style="display: none;">
                <h2>Meetings Management</h2>
                <p style="color: var(--color-sage); margin-bottom: 1rem;">Create and manage meeting rooms for the meetings page.</p>
                
                <div class="meeting-add-section">
                    <h3>Add / Edit Meeting Room</h3>
                    
                    <!-- Language Tabs with Flags -->
                    <div class="lang-flag-tabs">
                        <button class="lang-flag-tab meeting-lang-tab active" data-lang="en" title="English">ðŸ‡¬ðŸ‡§</button>
                        <button class="lang-flag-tab meeting-lang-tab" data-lang="nl" title="Nederlands">ðŸ‡³ðŸ‡±</button>
                        <button class="lang-flag-tab meeting-lang-tab" data-lang="fr" title="FranÃ§ais">ðŸ‡«ðŸ‡·</button>
                    </div>
                    
                    <div class="form-group">
                        <label id="meeting-name-label">Meeting Room Name (English)</label>
                        <input type="text" id="meeting-name-input" class="form-control" placeholder="e.g., Executive Boardroom">
                    </div>
                    <div class="form-group">
                        <label id="meeting-description-label">Description (English)</label>
                        <textarea id="meeting-description-input" class="admin-textarea" placeholder="Enter meeting room description"></textarea>
                    </div>
                    <div class="form-group">
                        <label id="meeting-setup-label">Setup Styles (English) - one per line</label>
                        <textarea id="meeting-setup-input" class="admin-textarea" placeholder="e.g., Theater Style&#10;U-Shape&#10;Classroom"></textarea>
                    </div>
                    <div class="form-group">
                        <label id="meeting-facilities-label">Meeting Facilities (English) - one per line</label>
                        <textarea id="meeting-facilities-input" class="admin-textarea" placeholder="e.g., Projector&#10;Whiteboard&#10;Video Conferencing"></textarea>
                    </div>
                    <div class="form-group">
                        <label id="meeting-food-label">Food & Beverage (English)</label>
                        <textarea id="meeting-food-input" class="admin-textarea" placeholder="Describe food and beverage options"></textarea>
                    </div>
                    <div class="form-group">
                        <label id="meeting-parking-label">Parking Option (English)</label>
                        <textarea id="meeting-parking-input" class="admin-textarea" placeholder="Describe parking options"></textarea>
                    </div>
                    <div class="form-group">
                        <label id="meeting-accommodation-label">Overnight Accommodation (English)</label>
                        <textarea id="meeting-accommodation-input" class="admin-textarea" placeholder="Describe overnight accommodation options"></textarea>
                    </div>

                    <button class="btn" id="add-meeting-btn">Save Meeting Room</button>
                </div>

                <!-- Meeting Room Photos Section -->
                <div class="meeting-photos-section">
                    <h3>Meeting Room Photos</h3>
                    <p style="color: var(--color-sage); margin-bottom: 0.5rem;">Select a meeting room and upload photos. Drag to reorder.</p>
                    <div id="meeting-photo-status" class="meeting-photo-status">Save a meeting room to upload photos.</div>
                    <div class="form-group">
                        <label for="meeting-photo-select">Meeting Room Photo Album</label>
                        <select id="meeting-photo-select" class="form-control"></select>
                    </div>
                    <input type="file" id="meeting-photo-input" accept="image/*" multiple style="display: none;">
                    <button class="btn" id="upload-meeting-photo-btn">Add Photos</button>
                    <div id="meeting-photo-grid" class="photo-grid"></div>
                </div>

                <!-- Meeting Room Video Section -->
                <div class="meeting-video-section">
                    <h3>Meeting Room Video (Optional)</h3>
                    <p style="color: var(--color-sage); margin-bottom: 0.5rem;">Upload a video for the selected meeting room.</p>
                    <div class="form-group">
                        <label for="meeting-video-select">Meeting Room</label>
                        <select id="meeting-video-select" class="form-control"></select>
                    </div>
                    <input type="file" id="meeting-video-input" accept="video/*" style="display: none;">
                    <button class="btn" id="upload-meeting-video-btn">Upload Video</button>
                    <div id="meeting-video-preview"></div>
                </div>

                <!-- Existing Meeting Rooms List -->
                <div class="meeting-list-section">
                    <h3>Existing Meeting Rooms</h3>
                    <div id="meeting-list" class="meeting-grid"></div>
                </div>
            </div>

            <!-- Attractions Management Card -->
            <div id="attractions-management-card" class="card" style="display: none;">
                <h2>Attractions Management</h2>
                <p style="color: var(--color-sage); margin-bottom: 1rem;">Create and manage local attractions for the attractions page.</p>
                
                <div class="attraction-add-section">
                    <h3>Add / Edit Attraction</h3>
                    
                    <!-- Language Tabs with Flags -->
                    <div class="lang-flag-tabs">
                        <button class="lang-flag-tab attraction-lang-tab active" data-lang="en" title="English">ðŸ‡¬ðŸ‡§</button>
                        <button class="lang-flag-tab attraction-lang-tab" data-lang="nl" title="Nederlands">ðŸ‡³ðŸ‡±</button>
                        <button class="lang-flag-tab attraction-lang-tab" data-lang="fr" title="FranÃ§ais">ðŸ‡«ðŸ‡·</button>
                    </div>
                    
                    <div class="form-group">
                        <label id="attraction-title-label">Attraction Title (English)</label>
                        <input type="text" id="attraction-title-input" class="form-control" placeholder="e.g., St. Rumbold's Tower">
                    </div>
                    <div class="form-group">
                        <label id="attraction-description-label">Description (English)</label>
                        <textarea id="attraction-description-input" class="admin-textarea" placeholder="Enter attraction description"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Website Link (optional)</label>
                        <input type="url" id="attraction-link-input" class="form-control" placeholder="https://...">
                    </div>
                    <div class="form-group">
                        <label>Attraction Image</label>
                        <input type="file" id="attraction-image-input" accept="image/*" style="display: none;">
                        <button class="btn" id="upload-attraction-image-btn" type="button">Upload Image</button>
                        <div id="attraction-image-preview" style="margin-top: 0.5rem;"></div>
                    </div>

                    <button class="btn" id="add-attraction-btn">Save Attraction</button>
                </div>

                <!-- Existing Attractions List -->
                <div class="attraction-list-section">
                    <h3>Existing Attractions</h3>
                    <div id="attraction-list" class="attraction-grid"></div>
                </div>
            </div>

            <!-- Info Management Card -->
            <div id="info-management-card" class="card" style="display: none;">
                <h2>Info Management</h2>
                <p style="color: var(--color-sage); margin-bottom: 1rem;">Manage hotel information content displayed on the info page.</p>
                
                <!-- Tab Navigation -->
                <div class="info-tabs">
                    <button class="info-tab active" data-tab="checkin">Check-in</button>
                    <button class="info-tab" data-tab="checkout">Check-out</button>
                    <button class="info-tab" data-tab="breakfast">Breakfast</button>
                    <button class="info-tab" data-tab="payment">Payment Methods</button>
                    <button class="info-tab" data-tab="services">Services</button>
                    <button class="info-tab" data-tab="general">General</button>
                    <button class="info-tab" data-tab="parking">Parking Information</button>
                    <button class="info-tab" data-tab="traffic">Traffic-Calmed Streets</button>
                    <button class="info-tab" data-tab="camera">Camera Surveillance Notice</button>
                </div>
                
                <!-- Tab Content -->
                <div id="info-tab-content">
                    <!-- Content will be rendered by JavaScript -->
                </div>
            </div>

            <!-- Main Image Management Card -->
            <div id="main-image-management-card" class="card" style="display: none;">
                <h2>Main Image Management</h2>
                <p style="color: var(--color-sage); margin-bottom: 1.5rem;">Manage all main hero images used across the website pages.</p>
                
                <!-- Background Photo Section (moved from Main Banner Photo Management) -->
                <div class="main-image-section">
                    <h3>Background Photo</h3>
                    <p style="color: var(--color-sage);">Upload a background image for the website pages.</p>
                    
                    <input type="file" id="background-upload-input" accept="image/*" style="display: none;">
                    <button class="btn" id="add-background-btn">Upload Background</button>
                    
                    <div id="background-preview" style="margin-top: 1rem;">
                        <!-- Image preview will be displayed here with consistent size -->
                    </div>
                </div>

                <!-- Facilities Page Hero Image (moved from Facilities Management) -->
                <div class="main-image-section">
                    <h3>Facilities Page Hero Image</h3>
                    <p style="color: var(--color-sage); margin-bottom: 0.5rem;">Upload the hero image displayed at the top of the facilities page.</p>
                    <input type="file" id="facility-hero-upload-input" accept="image/*" style="display: none;">
                    <button class="btn" id="upload-facility-hero-btn">Upload Main Image</button>
                    <div id="facility-hero-preview" class="facility-hero-preview"></div>
                </div>

                <!-- Meetings Page Main Image (moved from Meetings Management) -->
                <div class="main-image-section">
                    <h3>Meetings Page Main Image</h3>
                    <p style="color: var(--color-sage); margin-bottom: 0.5rem;">Upload the main hero image for the meetings page.</p>
                    <input type="file" id="meeting-main-image-input" accept="image/*" style="display: none;">
                    <button class="btn" id="upload-meeting-main-image-btn">Upload Main Image</button>
                    <div id="meeting-main-image-preview" class="meeting-main-image-preview"></div>
                </div>

                <!-- Attractions Page Main Image (moved from Attractions Management) -->
                <div class="main-image-section">
                    <h3>Attractions Page Main Image</h3>
                    <p style="color: var(--color-sage); margin-bottom: 0.5rem;">Upload the main hero image for the attractions page.</p>
                    <input type="file" id="attraction-main-image-input" accept="image/*" style="display: none;">
                    <button class="btn" id="upload-attraction-main-image-btn">Upload Main Image</button>
                    <div id="attraction-main-image-preview" class="attraction-main-image-preview"></div>
                </div>

                <!-- NEW: Rooms Main Image -->
                <div class="main-image-section">
                    <h3>Rooms Main Image</h3>
                    <p style="color: var(--color-sage); margin-bottom: 0.5rem;">Upload the main hero image for the rooms page background.</p>
                    <input type="file" id="rooms-main-image-input" accept="image/*" style="display: none;">
                    <button class="btn" id="upload-rooms-main-image-btn">Upload Main Image</button>
                    <div id="rooms-main-image-preview" class="rooms-main-image-preview"></div>
                </div>

                <!-- NEW: Info Main Image -->
                <div class="main-image-section">
                    <h3>Info Main Image</h3>
                    <p style="color: var(--color-sage); margin-bottom: 0.5rem;">Upload the main hero image for the info page header background.</p>
                    <input type="file" id="info-main-image-input" accept="image/*" style="display: none;">
                    <button class="btn" id="upload-info-main-image-btn">Upload Main Image</button>
                    <div id="info-main-image-preview" class="info-main-image-preview"></div>
                </div>

                <!-- NEW: Group Main Image -->
                <div class="main-image-section">
                    <h3>Group Request Main Image</h3>
                    <p style="color: var(--color-sage); margin-bottom: 0.5rem;">Upload the main hero image for the group request page header background.</p>
                    <input type="file" id="group-main-image-input" accept="image/*" style="display: none;">
                    <button class="btn" id="upload-group-main-image-btn">Upload Main Image</button>
                    <div id="group-main-image-preview" class="group-main-image-preview"></div>
                </div>
            </div>

            <!-- Translation Management Card -->
            <div id="translation-management-card" class="card" style="display: none;">
                <h2>Translation Management</h2>
                <p style="color: var(--color-sage); margin-bottom: 1.5rem;">
                    Manage translations for all static frontend text across the website. 
                    English is the default language. Changes are saved immediately to Firebase.
                </p>

                <!-- Save All Button -->
                <div style="margin-bottom: 1.5rem;">
                    <button class="btn" id="save-all-translations-btn">Save All Translations</button>
                    <button class="btn" id="load-translations-btn" style="margin-left: 1rem; background-color: var(--color-sage);">Load from Firebase</button>
                </div>

                <!-- Translations organized by page -->
                <div id="translations-container">
                    <!-- Navigation Menu Section -->
                    <div class="translation-section">
                        <h3 class="translation-section-title">Main Navigation Menu</h3>
                        <div class="translation-items" id="nav-translations">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Home Page Section -->
                    <div class="translation-section">
                        <h3 class="translation-section-title">Home Page</h3>
                        <div class="translation-items" id="home-translations">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Rooms Page Section -->
                    <div class="translation-section">
                        <h3 class="translation-section-title">Rooms Page</h3>
                        <div class="translation-items" id="rooms-translations">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Packages Page Section -->
                    <div class="translation-section">
                        <h3 class="translation-section-title">Packages Page</h3>
                        <div class="translation-items" id="packages-translations">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Facilities Page Section -->
                    <div class="translation-section">
                        <h3 class="translation-section-title">Facilities Page</h3>
                        <div class="translation-items" id="facilities-translations">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Meetings Page Section -->
                    <div class="translation-section">
                        <h3 class="translation-section-title">Meetings Page</h3>
                        <div class="translation-items" id="meetings-translations">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Info Page Section -->
                    <div class="translation-section">
                        <h3 class="translation-section-title">Info Page</h3>
                        <div class="translation-items" id="info-translations">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Attractions Page Section -->
                    <div class="translation-section">
                        <h3 class="translation-section-title">Attractions Page</h3>
                        <div class="translation-items" id="attractions-translations">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Group Request Page Section -->
                    <div class="translation-section">
                        <h3 class="translation-section-title">Group Request Page</h3>
                        <div class="translation-items" id="group-request-translations">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Footer Section -->
                    <div class="translation-section">
                        <h3 class="translation-section-title">Footer</h3>
                        <div class="translation-items" id="footer-translations">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Common Elements Section -->
                    <div class="translation-section">
                        <h3 class="translation-section-title">Common Elements</h3>
                        <div class="translation-items" id="common-translations">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </main>

    <footer>
        <div class="footer-container">
            <!-- Logo Section -->
            <div class="footer-section footer-logo-section">
                <img src="logo/logo.png" alt="Hotel Elisabeth Logo" class="footer-logo">
            </div>

            <!-- Contact Section -->
            <div class="footer-section">
                <h3>Contact</h3>
                <div class="footer-contact-info">
                    <div class="footer-contact-item">
                        <strong>PHONE:</strong>
                        <a href="tel:+3215288400">+32 15 28 84 00</a>
                    </div>
                    <div class="footer-contact-item">
                        <strong>EMAIL:</strong>
                        <a href="mailto:info@elisabeth-hotel.be">info@elisabeth-hotel.be</a>
                    </div>
                    <div class="footer-contact-item">
                        <strong>ADDRESS:</strong>
                        <div class="footer-address">
                            <span>GOSWIN DE STASSARTSTRAAT</span>
                            <span>NR 26 / 28</span>
                            <span>MECHELEN 2800</span>
                            <span>BELGIUM</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Social Media Section -->
            <div class="footer-section">
                <h3>Social</h3>
                <div class="footer-social">
                    <a href="https://www.instagram.com/hotel.elisabeth" target="_blank" rel="noopener noreferrer" class="footer-social-link">
                        <svg class="footer-social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073z"/>
                        </svg>
                        Instagram
                    </a>
                    <a href="https://www.facebook.com/hotelelisabeth/" target="_blank" rel="noopener noreferrer" class="footer-social-link">
                        <svg class="footer-social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                        </svg>
                        Facebook
                    </a>
                    <a href="https://www.linkedin.com/company/hotel-elisabeth-mechelen/" target="_blank" rel="noopener noreferrer" class="footer-social-link">
                        <svg class="footer-social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                        </svg>
                        LinkedIn
                    </a>
                </div>
            </div>

            <!-- Information Links Section -->
            <div class="footer-section">
                <h3>Information</h3>
                <div class="footer-info-links">
                    <a href="privacypolicy.html">Privacy Policy</a>
                    <a href="termsandconditions.html">Terms & Conditions</a>
                    <a href="policies.html">Hotel Policies</a>
                    <a href="careers.html">Careers</a>
                </div>
            </div>
        </div>

        <!-- Footer Copyright -->
        <div class="footer-copyright-wrapper">
            <p class="footer-copyright">&copy; 2026 Hotel Elisabeth Mechelen. All rights reserved.</p>
        </div>

    </footer>

    <!-- Vertical Menu Interaction (non-module script to ensure it runs independently) -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // ============ VERTICAL MENU INTERACTION - FIXED ============
            const menuTriggerBtn = document.getElementById('menu-trigger-btn');
            const verticalMenu = document.getElementById('vertical-menu');
            let menuTimeout = null;

            // Show menu on MENU button hover
            menuTriggerBtn.addEventListener('mouseenter', () => {
                clearTimeout(menuTimeout);
                verticalMenu.classList.add('show');
            });

            menuTriggerBtn.addEventListener('mouseleave', () => {
                menuTimeout = setTimeout(() => {
                    if (!isHoveringMenu()) {
                        verticalMenu.classList.remove('show');
                    }
                }, 200);
            });

            // Keep menu visible when hovering menu or submenus
            verticalMenu.addEventListener('mouseenter', () => {
                clearTimeout(menuTimeout);
            });

            verticalMenu.addEventListener('mouseleave', () => {
                menuTimeout = setTimeout(() => {
                    verticalMenu.classList.remove('show');
                }, 300);
            });

            // Check if mouse is over menu or any submenu
            function isHoveringMenu() {
                return verticalMenu.matches(':hover') || 
                       document.querySelector('.vertical-submenu:hover') !== null;
            }

            // Handle submenu hover - keep parent and submenu visible
            document.querySelectorAll('.vertical-menu-item.has-submenu').forEach(item => {
                const submenu = item.querySelector('.vertical-submenu');
                const menuBtn = item.querySelector('.vertical-menu-btn');
                
                if (submenu && menuBtn) {
                    // Position submenu on hover
                    // Note: getBoundingClientRect() triggers layout reflow, but this is acceptable
                    // since it only happens once per mouseenter event (not continuous)
                    const positionSubmenu = () => {
                        const rect = menuBtn.getBoundingClientRect();
                        const menuRect = verticalMenu.getBoundingClientRect();
                        // Align submenu top edge with button top edge
                        // Since submenu is position:fixed inside a transformed parent (.vertical-menu),
                        // it's positioned relative to that parent, not the viewport
                        // So we subtract the parent menu's top position to get the correct offset
                        submenu.style.top = (rect.top - menuRect.top) + 'px';
                    };
                    
                    // Position on mouse enter
                    item.addEventListener('mouseenter', () => {
                        positionSubmenu();
                    });
                    
                    // When hovering submenu, keep everything visible
                    submenu.addEventListener('mouseenter', () => {
                        clearTimeout(menuTimeout);
                        item.classList.add('active');
                    });
                    
                    submenu.addEventListener('mouseleave', () => {
                        item.classList.remove('active');
                        menuTimeout = setTimeout(() => {
                            if (!isHoveringMenu()) {
                                verticalMenu.classList.remove('show');
                            }
                        }, 300);
                    });
                }
            });

            // Close menu when clicking any menu item
            document.querySelectorAll('.submenu-item').forEach(btn => {
                btn.addEventListener('click', () => {
                    verticalMenu.classList.remove('show');
                });
            });
            
            document.querySelectorAll('.vertical-menu-item:not(.has-submenu) .vertical-menu-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    verticalMenu.classList.remove('show');
                });
            });
        });
    </script>

    <!-- Firebase SDK and Authentication Check -->
    <script type="module">
        import { checkAuthState, logoutAdmin } from './auth.js';
        import { storage, database } from './firebase-config.js';
        import { ref as storageRef, uploadBytes, getDownloadURL, deleteObject } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js";
        import { ref as dbRef, set, get, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        let currentPhotos = [];

        // Check if user is authenticated
        checkAuthState((authState) => {
            const loading = document.getElementById('loading');
            const dashboardContent = document.getElementById('dashboard-content');
            
            if (authState.authenticated) {
                // User is logged in, show dashboard
                loading.style.display = 'none';
                dashboardContent.style.display = 'block';
                
                // Display admin email
                const adminEmailElement = document.getElementById('admin-email');
                if (adminEmailElement) {
                    adminEmailElement.textContent = `Logged in as: ${authState.user.email}`;
                }
            } else {
                // User is not logged in, redirect to login page
                window.location.href = 'hoteladmin.html';
            }
        });

        // Handle logout
        document.getElementById('logout-btn').addEventListener('click', async (e) => {
            e.preventDefault();
            const result = await logoutAdmin();
            if (result.success) {
                window.location.href = 'hoteladmin.html';
            }
        });

        // Helper function to ensure dashboard content is visible
        function ensureDashboardVisible() {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('dashboard-content').style.display = 'block';
        }

        // ============================================
        // MODERNIZATION HELPER FUNCTIONS
        // ============================================

        // Show/hide sticky action bar
        function showActionBar(title, buttons = []) {
            const actionBar = document.getElementById('admin-action-bar');
            const actionBarTitle = document.getElementById('action-bar-title');
            const actionBarButtons = document.getElementById('action-bar-buttons');
            
            actionBarTitle.textContent = title;
            actionBarButtons.innerHTML = '';
            
            buttons.forEach(btn => {
                const button = document.createElement('button');
                button.className = btn.className || 'btn';
                button.textContent = btn.text;
                button.onclick = btn.onClick;
                actionBarButtons.appendChild(button);
            });
            
            actionBar.classList.add('show');
        }

        function hideActionBar() {
            const actionBar = document.getElementById('admin-action-bar');
            actionBar.classList.remove('show');
        }

        // Show non-blocking success notification
        function showSuccessNotification(message) {
            // Remove any existing notification
            const existing = document.querySelector('.success-notification, .error-notification');
            if (existing) {
                existing.remove();
            }

            const notification = document.createElement('div');
            notification.className = 'success-notification';
            notification.innerHTML = `
                <span class="success-notification-icon">âœ“</span>
                <span class="success-notification-message">${message}</span>
            `;
            document.body.appendChild(notification);

            // Auto-remove after 3 seconds
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Show non-blocking error notification
        function showErrorNotification(message) {
            // Remove any existing notification
            const existing = document.querySelector('.success-notification, .error-notification');
            if (existing) {
                existing.remove();
            }

            const notification = document.createElement('div');
            notification.className = 'error-notification';
            notification.innerHTML = `
                <span class="error-notification-icon">âš </span>
                <span class="error-notification-message">${message}</span>
            `;
            document.body.appendChild(notification);

            // Auto-remove after 4 seconds (slightly longer for errors)
            setTimeout(() => {
                notification.remove();
            }, 4000);
        }

        // Create flag icon for language tabs
        function createFlagIcon(lang) {
            const flags = {
                'en': 'ðŸ‡¬ðŸ‡§',
                'nl': 'ðŸ‡³ðŸ‡±',
                'fr': 'ðŸ‡«ðŸ‡·'
            };
            return flags[lang] || lang.toUpperCase();
        }

        // Replace old language tabs with flag tabs
        function replaceLangTabsWithFlags(container) {
            const oldTabs = container.querySelectorAll('.lang-tab, .facility-lang-tab, .meeting-lang-tab, .attraction-lang-tab');
            if (oldTabs.length === 0) return;

            const parent = oldTabs[0].parentElement;
            const flagTabsContainer = document.createElement('div');
            flagTabsContainer.className = 'lang-flag-tabs';

            ['en', 'nl', 'fr'].forEach(lang => {
                const flagTab = document.createElement('button');
                flagTab.className = 'lang-flag-tab';
                flagTab.dataset.lang = lang;
                flagTab.textContent = createFlagIcon(lang);
                flagTab.title = {'en': 'English', 'nl': 'Nederlands', 'fr': 'FranÃ§ais'}[lang];
                
                // Copy active state from old tabs
                const oldTab = Array.from(oldTabs).find(t => t.dataset.lang === lang);
                if (oldTab && oldTab.classList.contains('active')) {
                    flagTab.classList.add('active');
                }

                // Preserve click handlers
                if (oldTab) {
                    flagTab.onclick = oldTab.onclick;
                }

                flagTabsContainer.appendChild(flagTab);
            });

            parent.replaceChild(flagTabsContainer, oldTabs[0]);
            
            // Remove remaining old tabs
            oldTabs.forEach((tab, i) => {
                if (i > 0) tab.remove();
            });
        }

        // Multi-language form data storage (prevents data loss when switching languages)
        const multiLangFormData = {};

        function initMultiLangForm(formId, fields) {
            if (!multiLangFormData[formId]) {
                multiLangFormData[formId] = {
                    en: {},
                    nl: {},
                    fr: {}
                };
            }

            // Store field names for this form
            multiLangFormData[formId]._fields = fields;
        }

        function saveCurrentLangData(formId, currentLang) {
            if (!multiLangFormData[formId]) return;

            const fields = multiLangFormData[formId]._fields || [];
            fields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field) {
                    multiLangFormData[formId][currentLang][fieldId] = field.value;
                }
            });
        }

        function loadLangData(formId, lang) {
            if (!multiLangFormData[formId]) return;

            const fields = multiLangFormData[formId]._fields || [];
            fields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field && multiLangFormData[formId][lang][fieldId] !== undefined) {
                    field.value = multiLangFormData[formId][lang][fieldId];
                }
            });
        }

        // Initialize drag-and-drop for any sortable list
        function initDragAndDrop(containerSelector, itemSelector, onReorder) {
            const container = document.querySelector(containerSelector);
            if (!container) return;

            let draggedItem = null;

            container.addEventListener('dragstart', (e) => {
                if (e.target.matches(itemSelector)) {
                    draggedItem = e.target;
                    e.target.classList.add('dragging');
                    e.dataTransfer.effectAllowed = 'move';
                }
            });

            container.addEventListener('dragend', (e) => {
                if (e.target.matches(itemSelector)) {
                    e.target.classList.remove('dragging');
                    draggedItem = null;
                }
            });

            container.addEventListener('dragover', (e) => {
                e.preventDefault();
                const afterElement = getDragAfterElement(container, e.clientY, itemSelector);
                if (afterElement == null) {
                    container.appendChild(draggedItem);
                } else {
                    container.insertBefore(draggedItem, afterElement);
                }
            });

            container.addEventListener('drop', (e) => {
                e.preventDefault();
                if (onReorder) {
                    onReorder();
                }
            });
        }

        function getDragAfterElement(container, y, itemSelector) {
            const draggableElements = [...container.querySelectorAll(`${itemSelector}:not(.dragging)`)];

            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;

                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }

        // ============================================
        // END MODERNIZATION HELPER FUNCTIONS
        // ============================================

        // Helper function to hide all management cards
        function hideAllManagementCards() {
            const allCards = document.querySelectorAll('#dashboard-content > .card');
            allCards.forEach(card => card.style.display = 'none');
            hideActionBar(); // Hide action bar when switching sections
        }

        // Show photo management card when Main Banner is clicked
        document.getElementById('main-banner-btn').addEventListener('click', async () => {
            const photoCard = document.getElementById('photo-management-card');
            const verticalMenu = document.getElementById('vertical-menu');
            
            ensureDashboardVisible();
            hideAllManagementCards();
            
            // Show only photo card
            photoCard.style.display = 'block';
            photoCard.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            // Show action bar
            showActionBar('Main Banner Photo Management', []);
            
            // Hide menu after selection
            verticalMenu.classList.remove('show');
            
            await loadPhotos();
            await loadBackgroundPhoto();
        });

        // Show ads management card when Ads is clicked
        document.getElementById('ads-btn').addEventListener('click', async () => {
            const adsCard = document.getElementById('ads-management-card');
            const verticalMenu = document.getElementById('vertical-menu');
            
            ensureDashboardVisible();
            hideAllManagementCards();
            
            // Show only ads card
            adsCard.style.display = 'block';
            adsCard.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            // Show action bar
            showActionBar('Index Ads Management', []);
            
            // Hide menu after selection
            verticalMenu.classList.remove('show');
            
            await loadAds();
        });

        // Add photo button
        document.getElementById('add-photo-btn').addEventListener('click', () => {
            document.getElementById('photo-upload-input').click();
        });

        // Handle photo upload (multiple files)
        document.getElementById('photo-upload-input').addEventListener('change', async (e) => {
            const files = Array.from(e.target.files);
            if (files.length === 0) return;

            // Limit to 10 files
            const filesToUpload = files.slice(0, 10);
            if (files.length > 10) {
                showErrorNotification('Only first 10 images will be uploaded');
            }

            // Validate all files are images
            const invalidFiles = filesToUpload.filter(file => !file.type.startsWith('image/'));
            if (invalidFiles.length > 0) {
                showErrorNotification('Some files are not images and were skipped');
            }

            const validFiles = filesToUpload.filter(file => file.type.startsWith('image/'));
            if (validFiles.length === 0) return;

            const addBtn = document.getElementById('add-photo-btn');
            addBtn.disabled = true;
            addBtn.textContent = `Uploading ${validFiles.length} image(s)...`;

            try {
                let uploadedCount = 0;
                const baseOrder = currentPhotos.length;

                // Upload files sequentially to maintain order
                for (let i = 0; i < validFiles.length; i++) {
                    const file = validFiles[i];
                    const timestamp = Date.now() + i; // Ensure unique timestamps
                    const filename = `main-banner/${timestamp}-${file.name}`;
                    const fileRef = storageRef(storage, filename);

                    await uploadBytes(fileRef, file);
                    const downloadURL = await getDownloadURL(fileRef);

                    const photoData = {
                        url: downloadURL,
                        filename: filename,
                        timestamp: timestamp,
                        order: baseOrder + i
                    };

                    await set(dbRef(database, `mainBanner/${timestamp}`), photoData);
                    uploadedCount++;

                    // Update button text with progress
                    addBtn.textContent = `Uploaded ${uploadedCount}/${validFiles.length}...`;
                }

                // Reload photos
                await loadPhotos();
                showSuccessNotification(`${uploadedCount} image(s) uploaded successfully!`);

                // Reset input
                e.target.value = '';
            } catch (error) {
                console.error('Error uploading photos:', error);
                showErrorNotification('Failed to upload some photos. Please try again.');
            } finally {
                addBtn.disabled = false;
                addBtn.textContent = 'Add Photos';
            }
        });

        // Load photos from database
        async function loadPhotos() {
            try {
                const snapshot = await get(dbRef(database, 'mainBanner'));
                currentPhotos = [];

                if (snapshot.exists()) {
                    const data = snapshot.val();
                    currentPhotos = Object.values(data).sort((a, b) => a.order - b.order);
                }

                renderPhotos();
            } catch (error) {
                console.error('Error loading photos:', error);
            }
        }

        // Render photos in the grid
        function renderPhotos() {
            const grid = document.getElementById('photo-grid');
            grid.innerHTML = '';

            if (currentPhotos.length === 0) {
                grid.innerHTML = '<p style="color: var(--color-sage);">No photos uploaded yet. Click "Add Photo" to get started.</p>';
                return;
            }

            currentPhotos.forEach((photo, index) => {
                const photoItem = document.createElement('div');
                photoItem.className = 'photo-item';
                photoItem.draggable = true;
                photoItem.dataset.index = index;
                
                photoItem.innerHTML = `
                    <img src="${photo.url}" alt="Banner photo ${index + 1}">
                    <div class="photo-overlay">
                        <button class="btn-delete" onclick="deletePhoto(${index})">Delete</button>
                    </div>
                `;
                
                // Add drag event listeners
                photoItem.addEventListener('dragstart', handleDragStart);
                photoItem.addEventListener('dragover', handleDragOver);
                photoItem.addEventListener('drop', handleDrop);
                photoItem.addEventListener('dragend', handleDragEnd);
                
                grid.appendChild(photoItem);
            });
        }

        // Drag and drop event handlers
        let draggedIndex = null;

        function handleDragStart(e) {
            draggedIndex = parseInt(e.currentTarget.dataset.index);
            e.currentTarget.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
        }

        function handleDragEnd(e) {
            e.currentTarget.classList.remove('dragging');
            draggedIndex = null; // Reset to ensure cleanup
            // Remove drag-over class from all items
            document.querySelectorAll('.photo-item').forEach(item => {
                item.classList.remove('drag-over');
            });
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
        }

        function handleDragEnter(e) {
            e.currentTarget.classList.add('drag-over');
        }

        function handleDragLeave(e) {
            // Only remove drag-over if we're actually leaving the element
            // Check that relatedTarget is a valid DOM element before using contains
            if (!e.relatedTarget || 
                (e.relatedTarget instanceof Node && !e.currentTarget.contains(e.relatedTarget))) {
                e.currentTarget.classList.remove('drag-over');
            }
        }

        async function handleDrop(e) {
            e.stopPropagation();
            e.preventDefault();

            const dropIndex = parseInt(e.currentTarget.dataset.index);
            
            if (draggedIndex !== null && draggedIndex !== dropIndex) {
                await reorderPhotos(draggedIndex, dropIndex);
            }
        }

        // Reorder photos based on drag and drop
        async function reorderPhotos(fromIndex, toIndex) {
            try {
                // Create a new array with reordered photos
                const reorderedPhotos = [...currentPhotos];
                const [movedPhoto] = reorderedPhotos.splice(fromIndex, 1);
                reorderedPhotos.splice(toIndex, 0, movedPhoto);

                // Update order values first
                reorderedPhotos.forEach((photo, i) => {
                    photo.order = i;
                });

                // Prepare all database updates
                const updates = reorderedPhotos.map((photo) => {
                    return set(dbRef(database, `mainBanner/${photo.timestamp}`), photo);
                });

                // Execute all updates in parallel
                await Promise.all(updates);

                // Reload photos
                await loadPhotos();
            } catch (error) {
                console.error('Error reordering photos:', error);
                showErrorNotification('Failed to reorder photos. Please try again.');
            }
        }

        // Add delete photo function
        async function deletePhoto(index) {
            if (!confirm('Are you sure you want to delete this photo?')) {
                return;
            }
            
            try {
                // Bounds check for index
                if (index < 0 || index >= currentPhotos.length) {
                    console.error('Invalid index:', index);
                    showErrorNotification('Invalid photo index.');
                    return;
                }
                
                const photo = currentPhotos[index];
                
                // Delete from storage
                if (photo.filename) {
                    const fileRef = storageRef(storage, photo.filename);
                    await deleteObject(fileRef);
                }
                
                // Delete from database
                await remove(dbRef(database, `mainBanner/${photo.timestamp}`));
                
                // Reload photos
                await loadPhotos();
                
                showSuccessNotification('Photo deleted successfully!');
            } catch (error) {
                console.error('Error deleting photo:', error);
                showErrorNotification('Failed to delete photo. Please try again.');
            }
        }
        
        // Make deletePhoto globally accessible
        window.deletePhoto = deletePhoto;

        // Reindex photos after deletion
        async function reindexPhotos() {
            try {
                // Update order values first
                currentPhotos.forEach((photo, i) => {
                    photo.order = i;
                });

                // Prepare all database updates
                const updates = currentPhotos.map((photo) => {
                    return set(dbRef(database, `mainBanner/${photo.timestamp}`), photo);
                });
                
                // Execute all updates in parallel
                await Promise.all(updates);
            } catch (error) {
                console.error('Error reindexing photos:', error);
            }
        }

        // ============ INDEX ADS MANAGEMENT (REFACTORED WITH TABS) ============
        const languages = ['en', 'nl', 'fr'];
        const languageLabels = {
            en: { name: 'English', flag: 'ðŸ‡¬ðŸ‡§' },
            nl: { name: 'Dutch', flag: 'ðŸ‡³ðŸ‡±' },
            fr: { name: 'French', flag: 'ðŸ‡«ðŸ‡·' }
        };

        let adsData = {
            ad1: { imageUrl: '', topText_en: '', topText_nl: '', topText_fr: '', bottomText_en: '', bottomText_nl: '', bottomText_fr: '', buttonTitle_en: '', buttonTitle_nl: '', buttonTitle_fr: '', link: '' },
            ad2: { imageUrl: '', topText_en: '', topText_nl: '', topText_fr: '', bottomText_en: '', bottomText_nl: '', bottomText_fr: '', buttonTitle_en: '', buttonTitle_nl: '', buttonTitle_fr: '', link: '' },
            ad3: { imageUrl: '', topText_en: '', topText_nl: '', topText_fr: '', bottomText_en: '', bottomText_nl: '', bottomText_fr: '', buttonTitle_en: '', buttonTitle_nl: '', buttonTitle_fr: '', link: '' }
        };

        let currentAdTab = 'ad1';
        let currentAdLang = 'en';

        // Escape HTML to prevent XSS in attributes
        function escapeHtml(text) {
            if (!text) return '';
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Validate and sanitize image URLs
        function sanitizeImageUrl(url) {
            if (!url) return '';
            const trimmed = url.trim();
            // Only allow HTTPS URLs from Firebase Storage
            if (trimmed.startsWith('https://firebasestorage.googleapis.com/') || 
                trimmed.startsWith('https://storage.googleapis.com/')) {
                return escapeHtml(trimmed);
            }
            return '';
        }

        // Tab switching for ads
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('ads-tab')) {
                document.querySelectorAll('.ads-tab').forEach(tab => tab.classList.remove('active'));
                e.target.classList.add('active');
                currentAdTab = e.target.dataset.ad;
                renderAdTab();
            }
            
            if (e.target.classList.contains('ads-lang-tab')) {
                document.querySelectorAll('.ads-lang-tab').forEach(tab => tab.classList.remove('active'));
                e.target.classList.add('active');
                currentAdLang = e.target.dataset.lang;
                renderAdTab();
            }
        });

        // Load ads data
        async function loadAds() {
            try {
                const snapshot = await get(dbRef(database, 'indexAds'));
                
                if (snapshot.exists()) {
                    adsData = snapshot.val();
                }
                
                renderAdTab();
            } catch (error) {
                console.error('Error loading ads:', error);
            }
        }

        // Render ad tab content
        function renderAdTab() {
            const container = document.getElementById('ads-tab-content');
            const ad = adsData[currentAdTab];
            
            const langTabs = `
                <div class="ads-lang-tabs">
                    <button class="ads-lang-tab ${currentAdLang === 'en' ? 'active' : ''}" data-lang="en">ðŸ‡¬ðŸ‡§ EN</button>
                    <button class="ads-lang-tab ${currentAdLang === 'nl' ? 'active' : ''}" data-lang="nl">ðŸ‡³ðŸ‡± NL</button>
                    <button class="ads-lang-tab ${currentAdLang === 'fr' ? 'active' : ''}" data-lang="fr">ðŸ‡«ðŸ‡· FR</button>
                </div>
            `;
            
            const content = `
                ${langTabs}
                
                <div class="form-group">
                    <label>Image</label>
                    <input type="file" id="ad-image-upload-${currentAdTab}" accept="image/*" style="margin-bottom: 0.5rem;">
                    ${ad.imageUrl ? `<img src="${ad.imageUrl}" style="max-width: 300px; display: block; margin-top: 0.5rem; border-radius: 4px;">` : '<p style="color: var(--color-sage);">No image uploaded</p>'}
                </div>
                
                <div class="form-group">
                    <label>Top Text</label>
                    <input type="text" id="ad-top-text" class="form-control" value="${escapeHtml(ad[`topText_${currentAdLang}`] || '')}" placeholder="Enter top text">
                </div>
                
                <div class="form-group">
                    <label>Bottom Text</label>
                    <input type="text" id="ad-bottom-text" class="form-control" value="${escapeHtml(ad[`bottomText_${currentAdLang}`] || '')}" placeholder="Enter bottom text">
                </div>
                
                <div class="form-group">
                    <label>Button Title</label>
                    <input type="text" id="ad-button-title" class="form-control" value="${escapeHtml(ad[`buttonTitle_${currentAdLang}`] || '')}" placeholder="Enter button text">
                </div>
                
                <div class="form-group">
                    <label>Link URL</label>
                    <input type="text" id="ad-link" class="form-control" value="${escapeHtml(ad.link || '')}" placeholder="https://...">
                </div>
                
                <button class="btn" id="save-ad-btn">Save Ad</button>
            `;
            
            container.innerHTML = content;
            
            // Attach handlers (no Quill initialization)
            attachAdSaveHandlers();
        }

        // Attach save handlers for ads
        function attachAdSaveHandlers() {
            const saveBtn = document.getElementById('save-ad-btn');
            const imageInput = document.getElementById(`ad-image-upload-${currentAdTab}`);
            
            if (imageInput) {
                imageInput.addEventListener('change', async (e) => {
                    const file = e.target.files[0];
                    if (!file) return;
                    
                    if (!file.type.startsWith('image/')) {
                        showErrorNotification('Please select an image file');
                        return;
                    }
                    
                    try {
                        const timestamp = Date.now();
                        const filename = `index-ads/${currentAdTab}-${timestamp}-${file.name}`;
                        const fileRef = storageRef(storage, filename);
                        
                        await uploadBytes(fileRef, file);
                        const downloadURL = await getDownloadURL(fileRef);
                        
                        adsData[currentAdTab].imageUrl = downloadURL;
                        
                        await set(dbRef(database, 'indexAds'), adsData);
                        
                        renderAdTab();
                        showSuccessNotification('Image uploaded successfully!');
                    } catch (error) {
                        console.error('Error uploading image:', error);
                        showErrorNotification('Failed to upload image.');
                    }
                });
            }
            
            if (saveBtn) {
                saveBtn.addEventListener('click', async () => {
                    const topText = document.getElementById('ad-top-text').value;
                    const bottomText = document.getElementById('ad-bottom-text').value;
                    const buttonTitle = document.getElementById('ad-button-title').value;
                    const link = document.getElementById('ad-link').value;
                    
                    adsData[currentAdTab][`topText_${currentAdLang}`] = topText;
                    adsData[currentAdTab][`bottomText_${currentAdLang}`] = bottomText;
                    adsData[currentAdTab][`buttonTitle_${currentAdLang}`] = buttonTitle;
                    adsData[currentAdTab].link = link;
                    
                    try {
                        await set(dbRef(database, 'indexAds'), adsData);
                        showSuccessNotification('Ad saved successfully!');
                    } catch (error) {
                        console.error('Error saving ad:', error);
                        showErrorNotification('Failed to save ad.');
                    }
                });
            }
        }

        // ============ BACKGROUND PHOTO MANAGEMENT ============
        let currentBackground = null;

        // Load background photo
        async function loadBackgroundPhoto() {
            try {
                const snapshot = await get(dbRef(database, 'indexBackground'));
                
                const backgroundPreview = document.getElementById('background-preview');
                
                if (snapshot.exists() && snapshot.val().url) {
                    currentBackground = snapshot.val();
                    const url = currentBackground.url;
                    backgroundPreview.innerHTML = `
                        <div class="photo-item">
                            <img src="${url}" alt="Background photo">
                            <div class="photo-overlay">
                                <button class="btn-delete" onclick="deleteBackgroundPhoto()">Delete</button>
                            </div>
                        </div>
                    `;
                } else {
                    currentBackground = null;
                    backgroundPreview.innerHTML = '<p style="color: var(--color-sage);">No background photo uploaded</p>';
                }
            } catch (error) {
                console.error('Error loading background photo:', error);
            }
        }

        // Upload background photo
        document.getElementById('add-background-btn').addEventListener('click', () => {
            document.getElementById('background-upload-input').click();
        });

        document.getElementById('background-upload-input').addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if (!file) return;
            
            if (!file.type.startsWith('image/')) {
                showErrorNotification('Please select an image file');
                return;
            }
            
            const addBtn = document.getElementById('add-background-btn');
            addBtn.disabled = true;
            addBtn.textContent = 'Uploading...';
            
            try {
                // Delete old background if exists
                if (currentBackground && currentBackground.filename) {
                    try {
                        const oldFileRef = storageRef(storage, currentBackground.filename);
                        await deleteObject(oldFileRef);
                    } catch (deleteError) {
                        // Log specific error but don't fail the upload
                        console.warn('Failed to delete old background file:', deleteError?.message || 'Unknown error');
                    }
                }
                
                // Upload new background
                const timestamp = Date.now();
                const filename = `index-background/${timestamp}-${file.name}`;
                const fileRef = storageRef(storage, filename);
                
                await uploadBytes(fileRef, file);
                const downloadURL = await getDownloadURL(fileRef);
                
                // Save to database
                const backgroundData = {
                    url: downloadURL,
                    filename: filename,
                    timestamp: timestamp
                };
                
                await set(dbRef(database, 'indexBackground'), backgroundData);
                
                // Reload background
                await loadBackgroundPhoto();
                
                // Reset input
                e.target.value = '';
                
                showSuccessNotification('Background photo uploaded successfully!');
            } catch (error) {
                console.error('Error uploading background:', error);
                showErrorNotification('Failed to upload background photo. Please try again.');
            } finally {
                addBtn.disabled = false;
                addBtn.textContent = 'Upload Background';
            }
        });

        // Add delete background photo function
        async function deleteBackgroundPhoto() {
            if (!confirm('Are you sure you want to delete the background photo?')) {
                return;
            }
            
            try {
                // Delete from storage
                if (currentBackground && currentBackground.filename) {
                    const fileRef = storageRef(storage, currentBackground.filename);
                    await deleteObject(fileRef);
                }
                
                // Delete from database
                await remove(dbRef(database, 'indexBackground'));
                
                // Reload
                await loadBackgroundPhoto();
                
                showSuccessNotification('Background photo deleted successfully!');
            } catch (error) {
                console.error('Error deleting background photo:', error);
                showErrorNotification('Failed to delete background photo.');
            }
        }
        
        // Make deleteBackgroundPhoto globally accessible
        window.deleteBackgroundPhoto = deleteBackgroundPhoto;

        // ============ ABOUT US MANAGEMENT ============
        let aboutUsData = {
            title: { en: '', nl: '', fr: '' },
            left: {
                subtitle1: { en: '', nl: '', fr: '' },
                subtitle2: { en: '', nl: '', fr: '' },
                textBody: { en: '', nl: '', fr: '' }
            },
            right: {
                subtitle1: { en: '', nl: '', fr: '' },
                subtitle2: { en: '', nl: '', fr: '' },
                textBody: { en: '', nl: '', fr: '' }
            }
        };

        let currentAboutUsTab = 'title';
        let currentAboutUsLang = 'en';

        // Show About Us management card
        document.getElementById('about-us-btn').addEventListener('click', async () => {
            const aboutUsCard = document.getElementById('about-us-management-card');
            const verticalMenu = document.getElementById('vertical-menu');
            
            ensureDashboardVisible();
            hideAllManagementCards();
            
            aboutUsCard.style.display = 'block';
            aboutUsCard.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            // Show action bar
            showActionBar('About Us Management', []);
            
            // Hide menu after selection
            verticalMenu.classList.remove('show');
            
            await loadAboutUsData();
            renderAboutUsTab();
        });

        // Show Ads Bottom management card
        document.getElementById('ads-bottom-btn').addEventListener('click', async () => {
            const adsBottomCard = document.getElementById('ads-bottom-management-card');
            const verticalMenu = document.getElementById('vertical-menu');
            
            ensureDashboardVisible();
            hideAllManagementCards();
            
            adsBottomCard.style.display = 'block';
            adsBottomCard.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            // Show action bar
            showActionBar('Ads Bottom Management', []);
            
            // Hide menu after selection
            verticalMenu.classList.remove('show');
            
            await loadAdsBottomData();
            renderAdsBottomTab();
        });

        // Add click handlers for other menu items (Manage Rooms, Manage Packages, View Bookings)
        document.getElementById('manage-rooms-btn').addEventListener('click', async () => {
            const roomCard = document.getElementById('room-management-card');
            const verticalMenu = document.getElementById('vertical-menu');
            
            ensureDashboardVisible();
            hideAllManagementCards();
            
            // Show only room card
            roomCard.style.display = 'block';
            roomCard.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            // Hide menu after selection
            
            // Show action bar
            showActionBar('Room Management', []);
            verticalMenu.classList.remove('show');
            
            await loadRoomsData();
            renderRoomsList();
        });

        document.getElementById('manage-packages-btn').addEventListener('click', async () => {
            const packageCard = document.getElementById('package-management-card');
            const verticalMenu = document.getElementById('vertical-menu');
            
            ensureDashboardVisible();
            hideAllManagementCards();
            
            // Show only package card
            packageCard.style.display = 'block';
            packageCard.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            // Hide menu after selection
            
            // Show action bar
            showActionBar('Package Management', []);
            verticalMenu.classList.remove('show');
            
            await loadPackagesData();
            renderPackagesList();
        });

        document.getElementById('main-images-btn').addEventListener('click', async () => {
            const mainImageCard = document.getElementById('main-image-management-card');
            const verticalMenu = document.getElementById('vertical-menu');
            
            ensureDashboardVisible();
            hideAllManagementCards();
            
            // Show only main image card
            mainImageCard.style.display = 'block';
            mainImageCard.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            // Hide menu after selection
            
            // Show action bar
            showActionBar('Main Images', []);
            verticalMenu.classList.remove('show');
            
            // Load all main images
            await loadBackgroundPhoto();
            await loadFacilitiesHero();
            await loadMeetingMainImage();
            await loadAttractionsMainImage();
            await loadRoomsMainImage();
            await loadInfoMainImage();
            await loadGroupMainImage();
        });

        // ============ FACILITIES MANAGEMENT ============
        let currentFacilityLang = 'en';
        let facilitiesData = {};
        let facilitiesLibrary = [];
        let facilitiesHeroImage = null;
        let editingFacilityId = null;
        let facilityDraft = null;
        let currentFacilityLibraryId = null;

        // Show facilities management card
        document.getElementById('manage-facilities-btn').addEventListener('click', async () => {
            const facilitiesCard = document.getElementById('facilities-management-card');
            const verticalMenu = document.getElementById('vertical-menu');

            ensureDashboardVisible();
            hideAllManagementCards();

            facilitiesCard.style.display = 'block';
            facilitiesCard.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            // Show action bar
            showActionBar('Facilities Management', []);
            verticalMenu.classList.remove('show');

            currentFacilityLang = 'en';
            document.querySelectorAll('.facility-lang-tab').forEach(tab => {
                tab.classList.toggle('active', tab.dataset.lang === 'en');
            });
            updateFacilityLabels();
            initializeFacilityDraft();
            applyFacilityDraft(currentFacilityLang);

            await loadFacilitiesData();
            await loadFacilitiesHero();
            await loadFacilitiesLibrary();
        });

        document.getElementById('facility-library-select').addEventListener('change', async (event) => {
            currentFacilityLibraryId = event.target.value || null;
            const status = document.getElementById('facility-photo-status');
            if (status) {
                const facility = currentFacilityLibraryId ? facilitiesData[currentFacilityLibraryId] : null;
                const name = facility ? (facility.name_en || facility.name_nl || facility.name_fr || 'Facility') : 'a facility';
                status.textContent = currentFacilityLibraryId ? `Uploading photos for ${name}.` : 'Select a facility to upload photos.';
            }
            await loadFacilitiesLibrary();
        });

        function updateFacilityLabels() {
            const labels = {
                en: {
                    name: 'Facility Name (English)',
                    operation: 'Operation & Description (English)',
                    guidelines: 'Guidelines (English) - one per line'
                },
                nl: {
                    name: 'Facility Name (Nederlands)',
                    operation: 'Operation & Description (Nederlands)',
                    guidelines: 'Guidelines (Nederlands) - one per line'
                },
                fr: {
                    name: 'Facility Name (FranÃ§ais)',
                    operation: 'Operation & Description (FranÃ§ais)',
                    guidelines: 'Guidelines (FranÃ§ais) - one per line'
                }
            };
            document.getElementById('facility-name-label').textContent = labels[currentFacilityLang].name;
            document.getElementById('facility-operation-label').textContent = labels[currentFacilityLang].operation;
            document.getElementById('facility-guidelines-label').textContent = labels[currentFacilityLang].guidelines;
        }

        function initializeFacilityDraft() {
            facilityDraft = {
                en: { name: '', operation: '', guidelines: '' },
                nl: { name: '', operation: '', guidelines: '' },
                fr: { name: '', operation: '', guidelines: '' }
            };
        }

        function syncFacilityDraft() {
            facilityDraft[currentFacilityLang] = {
                name: document.getElementById('facility-name-input').value,
                operation: document.getElementById('facility-operation-input').value,
                guidelines: document.getElementById('facility-guidelines-input').value
            };
        }

        function applyFacilityDraft(lang) {
            const draft = facilityDraft[lang];
            document.getElementById('facility-name-input').value = draft.name || '';
            document.getElementById('facility-operation-input').value = draft.operation || '';
            document.getElementById('facility-guidelines-input').value = draft.guidelines || '';
        }

        function parseGuidelines(value) {
            const trimmed = value.trim();
            if (!trimmed) return [];
            return trimmed.split('\n').map(line => line.trim()).filter(Boolean);
        }

        initializeFacilityDraft();

        document.querySelectorAll('.facility-lang-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                syncFacilityDraft();
                document.querySelectorAll('.facility-lang-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                currentFacilityLang = tab.dataset.lang;
                updateFacilityLabels();
                applyFacilityDraft(currentFacilityLang);
            });
        });

        document.getElementById('add-facility-btn').addEventListener('click', async () => {
            syncFacilityDraft();
            const nameEn = facilityDraft.en.name.trim();
            const nameNl = facilityDraft.nl.name.trim();
            const nameFr = facilityDraft.fr.name.trim();

            if (!nameEn && !nameNl && !nameFr) {
                showErrorNotification('Please enter a facility name in at least one language');
                return;
            }

            const timestamp = Date.now();
            const facilityId = `facility_${timestamp}`;

            const facilityData = {
                name_en: nameEn,
                name_nl: nameNl,
                name_fr: nameFr,
                operation_en: facilityDraft.en.operation.trim(),
                operation_nl: facilityDraft.nl.operation.trim(),
                operation_fr: facilityDraft.fr.operation.trim(),
                guidelines_en: parseGuidelines(facilityDraft.en.guidelines),
                guidelines_nl: parseGuidelines(facilityDraft.nl.guidelines),
                guidelines_fr: parseGuidelines(facilityDraft.fr.guidelines),
                timestamp
            };

            try {
                await set(dbRef(database, `facilities/${facilityId}`), facilityData);
                initializeFacilityDraft();
                applyFacilityDraft(currentFacilityLang);
                showSuccessNotification('Facility added successfully!');
                await loadFacilitiesData();
                currentFacilityLibraryId = facilityId;
                updateFacilityLibrarySelect();
                await loadFacilitiesLibrary();
            } catch (error) {
                console.error('Error adding facility:', error);
                showErrorNotification('Failed to add facility. Please try again.');
            }
        });

        async function loadFacilitiesData() {
            try {
                const snapshot = await get(dbRef(database, 'facilities'));
                facilitiesData = snapshot.exists() ? snapshot.val() : {};
                renderFacilitiesList();
            } catch (error) {
                console.error('Error loading facilities:', error);
            }
        }

        function renderFacilitiesList() {
            const container = document.getElementById('facility-list');
            if (!container) return;

            if (!facilitiesData || Object.keys(facilitiesData).length === 0) {
                container.innerHTML = '<p style="color: var(--color-sage); text-align: center;">No facilities added yet.</p>';
                updateFacilityLibrarySelect();
                return;
            }

            container.innerHTML = Object.keys(facilitiesData).map(id => {
                const facility = facilitiesData[id];
                const nameEn = facility.name_en || 'â€”';
                const nameNl = facility.name_nl || 'â€”';
                const nameFr = facility.name_fr || 'â€”';
                return `
                    <div class="facility-item">
                        <div class="facility-info">
                            <h4>${escapeHtml(nameEn)}</h4>
                            <p>NL: ${escapeHtml(nameNl)} | FR: ${escapeHtml(nameFr)}</p>
                        </div>
                        <div class="facility-actions">
                            <button class="btn-edit-amenity" onclick="editFacility('${id}')">Edit</button>
                            <button class="btn-delete-amenity" onclick="deleteFacility('${id}')">Delete</button>
                        </div>
                    </div>
                `;
            }).join('');
            updateFacilityLibrarySelect();
        }

        function updateFacilityLibrarySelect() {
            const select = document.getElementById('facility-library-select');
            if (!select) return;
            const previousSelection = currentFacilityLibraryId;
            const status = document.getElementById('facility-photo-status');

            if (!facilitiesData || Object.keys(facilitiesData).length === 0) {
                select.innerHTML = '<option value="">No facilities available</option>';
                select.disabled = true;
                currentFacilityLibraryId = null;
                if (status) {
                    status.textContent = 'Add a facility above to start uploading photos.';
                }
                return;
            }

            select.disabled = false;
            const facilities = Object.keys(facilitiesData).map(id => {
                const facility = facilitiesData[id];
                const name = facility.name_en || facility.name_nl || facility.name_fr || 'Facility';
                return { id, name };
            });

            if (!currentFacilityLibraryId || !facilitiesData[currentFacilityLibraryId]) {
                currentFacilityLibraryId = facilities[0]?.id || null;
            }

            select.innerHTML = facilities.map(({ id, name }) => `
                <option value="${id}" ${id === currentFacilityLibraryId ? 'selected' : ''}>
                    ${escapeHtml(name)}
                </option>
            `).join('');

            if (status) {
                const activeName = facilities.find(({ id }) => id === currentFacilityLibraryId)?.name || 'this facility';
                status.textContent = `Uploading photos for ${activeName}.`;
            }

            if (previousSelection !== currentFacilityLibraryId) {
                loadFacilitiesLibrary();
            }
        }

        window.editFacility = function(facilityId) {
            editingFacilityId = facilityId;
            const facility = facilitiesData[facilityId];

            const modal = document.createElement('div');
            modal.className = 'facility-edit-modal show';
            modal.innerHTML = `
                <div class="facility-edit-content">
                    <h3>Edit Facility</h3>
                    <div class="facility-modal-tabs">
                        <button class="facility-modal-tab active" data-lang="en">ðŸ‡¬ðŸ‡§ EN</button>
                        <button class="facility-modal-tab" data-lang="nl">ðŸ‡³ðŸ‡± NL</button>
                        <button class="facility-modal-tab" data-lang="fr">ðŸ‡«ðŸ‡· FR</button>
                    </div>
                    <div class="facility-modal-body">
                        <div class="facility-modal-panel" data-lang="en">
                            <div class="form-group">
                                <label>Facility Name (English)</label>
                                <input type="text" id="facility-edit-name-en" class="form-control" value="${escapeHtml(facility.name_en || '')}">
                            </div>
                            <div class="form-group">
                                <label>Operation & Description (English)</label>
                                <textarea id="facility-edit-operation-en" class="admin-textarea">${escapeHtml(facility.operation_en || '')}</textarea>
                            </div>
                            <div class="form-group">
                                <label>Guidelines (English) - one per line</label>
                                <textarea id="facility-edit-guidelines-en" class="admin-textarea">${escapeHtml((facility.guidelines_en || []).join('\n'))}</textarea>
                            </div>
                        </div>
                        <div class="facility-modal-panel" data-lang="nl" style="display: none;">
                            <div class="form-group">
                                <label>Facility Name (Nederlands)</label>
                                <input type="text" id="facility-edit-name-nl" class="form-control" value="${escapeHtml(facility.name_nl || '')}">
                            </div>
                            <div class="form-group">
                                <label>Operation & Description (Nederlands)</label>
                                <textarea id="facility-edit-operation-nl" class="admin-textarea">${escapeHtml(facility.operation_nl || '')}</textarea>
                            </div>
                            <div class="form-group">
                                <label>Guidelines (Nederlands) - one per line</label>
                                <textarea id="facility-edit-guidelines-nl" class="admin-textarea">${escapeHtml((facility.guidelines_nl || []).join('\n'))}</textarea>
                            </div>
                        </div>
                        <div class="facility-modal-panel" data-lang="fr" style="display: none;">
                            <div class="form-group">
                                <label>Facility Name (FranÃ§ais)</label>
                                <input type="text" id="facility-edit-name-fr" class="form-control" value="${escapeHtml(facility.name_fr || '')}">
                            </div>
                            <div class="form-group">
                                <label>Operation & Description (FranÃ§ais)</label>
                                <textarea id="facility-edit-operation-fr" class="admin-textarea">${escapeHtml(facility.operation_fr || '')}</textarea>
                            </div>
                            <div class="form-group">
                                <label>Guidelines (FranÃ§ais) - one per line</label>
                                <textarea id="facility-edit-guidelines-fr" class="admin-textarea">${escapeHtml((facility.guidelines_fr || []).join('\n'))}</textarea>
                            </div>
                        </div>
                    </div>
                    <div class="facility-edit-actions">
                        <button class="btn" onclick="saveFacilityEdit()">Save Changes</button>
                        <button class="btn btn-cancel" onclick="closeFacilityEdit()">Cancel</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);

            modal.querySelectorAll('.facility-modal-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    modal.querySelectorAll('.facility-modal-tab').forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    const lang = tab.dataset.lang;
                    modal.querySelectorAll('.facility-modal-panel').forEach(panel => {
                        panel.style.display = panel.dataset.lang === lang ? 'block' : 'none';
                    });
                });
            });
        };

        window.closeFacilityEdit = function() {
            document.querySelector('.facility-edit-modal')?.remove();
            editingFacilityId = null;
        };

        window.saveFacilityEdit = async function() {
            const nameEn = document.getElementById('facility-edit-name-en').value.trim();
            const nameNl = document.getElementById('facility-edit-name-nl').value.trim();
            const nameFr = document.getElementById('facility-edit-name-fr').value.trim();
            const operationEn = document.getElementById('facility-edit-operation-en').value.trim();
            const operationNl = document.getElementById('facility-edit-operation-nl').value.trim();
            const operationFr = document.getElementById('facility-edit-operation-fr').value.trim();
            const guidelinesEn = parseGuidelines(document.getElementById('facility-edit-guidelines-en').value);
            const guidelinesNl = parseGuidelines(document.getElementById('facility-edit-guidelines-nl').value);
            const guidelinesFr = parseGuidelines(document.getElementById('facility-edit-guidelines-fr').value);

            if (!nameEn && !nameNl && !nameFr) {
                showErrorNotification('Please enter at least one facility name');
                return;
            }

            try {
                await set(dbRef(database, `facilities/${editingFacilityId}`), {
                    name_en: nameEn,
                    name_nl: nameNl,
                    name_fr: nameFr,
                    operation_en: operationEn,
                    operation_nl: operationNl,
                    operation_fr: operationFr,
                    guidelines_en: guidelinesEn,
                    guidelines_nl: guidelinesNl,
                    guidelines_fr: guidelinesFr,
                    timestamp: facilitiesData[editingFacilityId].timestamp
                });
                closeFacilityEdit();
                showSuccessNotification('Facility updated successfully!');
                await loadFacilitiesData();
            } catch (error) {
                console.error('Error updating facility:', error);
                showErrorNotification('Failed to update facility. Please try again.');
            }
        };

        window.deleteFacility = async function(facilityId) {
            if (!confirm('Are you sure you want to delete this facility?')) {
                return;
            }

            try {
                const librarySnapshot = await get(dbRef(database, `facilitiesLibrary/${facilityId}`));
                if (librarySnapshot.exists()) {
                    await Promise.all(Object.values(librarySnapshot.val()).map(async (photo) => {
                        if (photo?.filename) {
                            try {
                                await deleteObject(storageRef(storage, photo.filename));
                            } catch (deleteError) {
                                console.warn('Failed to delete facility library photo:', deleteError?.message || 'Unknown error');
                            }
                        }
                    }));
                }
                await set(dbRef(database, `facilities/${facilityId}`), null);
                await set(dbRef(database, `facilitiesLibrary/${facilityId}`), null);
                if (currentFacilityLibraryId === facilityId) {
                    currentFacilityLibraryId = null;
                }
                showSuccessNotification('Facility deleted successfully!');
                await loadFacilitiesData();
            } catch (error) {
                console.error('Error deleting facility:', error);
                showErrorNotification('Failed to delete facility.');
            }
        };

        document.getElementById('upload-facility-hero-btn').addEventListener('click', () => {
            document.getElementById('facility-hero-upload-input').click();
        });

        document.getElementById('facility-hero-upload-input').addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if (!file) return;

            if (!file.type.startsWith('image/')) {
                showErrorNotification('Please select an image file');
                return;
            }

            const uploadBtn = document.getElementById('upload-facility-hero-btn');
            uploadBtn.disabled = true;
            uploadBtn.textContent = 'Uploading...';

            try {
                if (facilitiesHeroImage && facilitiesHeroImage.filename) {
                    try {
                        await deleteObject(storageRef(storage, facilitiesHeroImage.filename));
                    } catch (deleteError) {
                        console.warn('Failed to delete old facilities hero image:', deleteError?.message || 'Unknown error');
                    }
                }

                const timestamp = Date.now();
                const sanitizedName = sanitizeFilename(file.name);
                const filename = `facilities-hero/${timestamp}-${sanitizedName}`;
                const fileRef = storageRef(storage, filename);

                await uploadBytes(fileRef, file);
                const downloadURL = await getDownloadURL(fileRef);

                facilitiesHeroImage = {
                    url: downloadURL,
                    filename,
                    timestamp
                };

                await set(dbRef(database, 'facilitiesHero'), facilitiesHeroImage);
                await loadFacilitiesHero();

                e.target.value = '';
                showSuccessNotification('Facilities main image uploaded successfully!');
            } catch (error) {
                console.error('Error uploading facilities hero image:', error);
                const message = error?.message ? `: ${error.message}` : '';
                showErrorNotification(`Failed to upload main image${message}`);
            } finally {
                uploadBtn.disabled = false;
                uploadBtn.textContent = 'Upload Main Image';
            }
        });

        async function loadFacilitiesHero() {
            try {
                const snapshot = await get(dbRef(database, 'facilitiesHero'));
                facilitiesHeroImage = snapshot.exists() ? snapshot.val() : null;
                const preview = document.getElementById('facility-hero-preview');
                if (!preview) return;

                if (facilitiesHeroImage && facilitiesHeroImage.url) {
                    preview.innerHTML = `
                        <div class="photo-item">
                            <img src="${facilitiesHeroImage.url}" alt="Facilities main image">
                            <div class="photo-overlay">
                                <button class="btn-delete" onclick="deleteFacilitiesHero()">Delete</button>
                            </div>
                        </div>
                    `;
                } else {
                    preview.innerHTML = '<p style="color: var(--color-sage);">No main image uploaded.</p>';
                }
            } catch (error) {
                console.error('Error loading facilities hero image:', error);
            }
        }

        window.deleteFacilitiesHero = async function() {
            if (!confirm('Are you sure you want to delete the main image?')) {
                return;
            }

            try {
                if (facilitiesHeroImage && facilitiesHeroImage.filename) {
                    await deleteObject(storageRef(storage, facilitiesHeroImage.filename));
                }
                await remove(dbRef(database, 'facilitiesHero'));
                facilitiesHeroImage = null;
                await loadFacilitiesHero();
                showSuccessNotification('Main image deleted successfully!');
            } catch (error) {
                console.error('Error deleting facilities hero image:', error);
                showErrorNotification('Failed to delete main image.');
            }
        };

        document.getElementById('upload-facility-library-btn').addEventListener('click', () => {
            document.getElementById('facility-library-input').click();
        });

        document.getElementById('facility-library-input').addEventListener('change', async (e) => {
            const files = Array.from(e.target.files || []);
            if (!files.length) return;

            if (!currentFacilityLibraryId) {
                showErrorNotification('Please select a facility before uploading photos.');
                e.target.value = '';
                return;
            }

            const uploadBtn = document.getElementById('upload-facility-library-btn');
            uploadBtn.disabled = true;
            uploadBtn.textContent = 'Uploading...';

            try {
                let uploadCounter = 0;
                for (const file of files) {
                    if (!file.type.startsWith('image/')) {
                        continue;
                    }
                    const timestamp = Date.now() + uploadCounter;
                    uploadCounter += 1;
                    const sanitizedName = sanitizeFilename(file.name);
                    const filename = `facilities-library/${timestamp}-${sanitizedName}`;
                    const fileRef = storageRef(storage, filename);
                    await uploadBytes(fileRef, file);
                    const downloadURL = await getDownloadURL(fileRef);
                    facilitiesLibrary.push({
                        url: downloadURL,
                        filename,
                        timestamp,
                        order: facilitiesLibrary.length
                    });
                }

                await saveFacilitiesLibrary();
                await loadFacilitiesLibrary();
                e.target.value = '';
                showSuccessNotification('Facilities library updated!');
            } catch (error) {
                console.error('Error uploading facilities library images:', error);
                const message = error?.message ? `: ${error.message}` : '';
                showErrorNotification(`Failed to upload facility images${message}`);
            } finally {
                uploadBtn.disabled = false;
                uploadBtn.textContent = 'Add Library Photos';
            }
        });

        async function loadFacilitiesLibrary() {
            try {
                if (!currentFacilityLibraryId) {
                    facilitiesLibrary = [];
                    renderFacilitiesLibrary();
                    return;
                }
                const snapshot = await get(dbRef(database, `facilitiesLibrary/${currentFacilityLibraryId}`));
                facilitiesLibrary = [];
                if (snapshot.exists()) {
                    facilitiesLibrary = Object.values(snapshot.val()).sort((a, b) => (a.order ?? 0) - (b.order ?? 0));
                }
                renderFacilitiesLibrary();
            } catch (error) {
                console.error('Error loading facilities library:', error);
            }
        }

        function renderFacilitiesLibrary() {
            const grid = document.getElementById('facility-library-grid');
            if (!grid) return;

            if (!currentFacilityLibraryId) {
                grid.innerHTML = '<p style="color: var(--color-sage);">Select a facility to manage its photo album.</p>';
                return;
            }

            if (facilitiesLibrary.length === 0) {
                grid.innerHTML = '<p style="color: var(--color-sage);">No library photos uploaded yet.</p>';
                return;
            }

            grid.innerHTML = '';
            facilitiesLibrary.forEach((photo, index) => {
                const item = document.createElement('div');
                item.className = 'photo-item';
                item.draggable = true;
                item.dataset.index = index;
                item.innerHTML = `
                    <img src="${photo.url}" alt="Facility library photo ${index + 1}">
                    <div class="photo-overlay">
                        <button class="btn-delete" onclick="deleteFacilityLibraryPhoto(${index})">Delete</button>
                    </div>
                `;
                item.addEventListener('dragstart', handleFacilityLibraryDragStart);
                item.addEventListener('dragover', handleDragOver);
                item.addEventListener('drop', handleFacilityLibraryDrop);
                item.addEventListener('dragend', handleFacilityLibraryDragEnd);
                grid.appendChild(item);
            });
        }

        let facilityLibraryDraggedIndex = null;

        function handleFacilityLibraryDragStart(e) {
            facilityLibraryDraggedIndex = parseInt(e.currentTarget.dataset.index);
            e.currentTarget.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
        }

        async function handleFacilityLibraryDrop(e) {
            e.stopPropagation();
            e.preventDefault();

            const dropIndex = parseInt(e.currentTarget.dataset.index);
            if (facilityLibraryDraggedIndex !== null && facilityLibraryDraggedIndex !== dropIndex) {
                await reorderFacilitiesLibrary(facilityLibraryDraggedIndex, dropIndex);
            }
        }

        function handleFacilityLibraryDragEnd(e) {
            e.currentTarget.classList.remove('dragging');
            facilityLibraryDraggedIndex = null;
            document.querySelectorAll('#facility-library-grid .photo-item').forEach(item => {
                item.classList.remove('drag-over');
            });
        }

        async function reorderFacilitiesLibrary(fromIndex, toIndex) {
            try {
                const reordered = [...facilitiesLibrary];
                const [moved] = reordered.splice(fromIndex, 1);
                reordered.splice(toIndex, 0, moved);
                reordered.forEach((photo, index) => {
                    photo.order = index;
                });
                facilitiesLibrary = reordered;
                await saveFacilitiesLibrary();
                renderFacilitiesLibrary();
            } catch (error) {
                console.error('Error reordering facilities library:', error);
                showErrorNotification('Failed to reorder photos.');
            }
        }

        async function saveFacilitiesLibrary() {
            if (!currentFacilityLibraryId) {
                return;
            }
            const updates = {};
            facilitiesLibrary.forEach(photo => {
                updates[photo.timestamp] = photo;
            });
            await set(dbRef(database, `facilitiesLibrary/${currentFacilityLibraryId}`), updates);
        }

        window.deleteFacilityLibraryPhoto = async function(index) {
            if (!confirm('Are you sure you want to delete this photo?')) {
                return;
            }

            try {
                if (!currentFacilityLibraryId) {
                    showErrorNotification('Please select a facility album.');
                    return;
                }
                if (index < 0 || index >= facilitiesLibrary.length) {
                    showErrorNotification('Invalid photo index.');
                    return;
                }
                const photo = facilitiesLibrary[index];
                if (photo.filename) {
                    await deleteObject(storageRef(storage, photo.filename));
                }
                facilitiesLibrary.splice(index, 1);
                facilitiesLibrary.forEach((item, idx) => {
                    item.order = idx;
                });
                await saveFacilitiesLibrary();
                renderFacilitiesLibrary();
                showSuccessNotification('Photo deleted successfully!');
            } catch (error) {
                console.error('Error deleting facilities photo:', error);
                showErrorNotification('Failed to delete photo.');
            }
        };

        // ============ AMENITIES MANAGEMENT ============
        let currentAmenityLang = 'en';
        let amenitiesData = {};
        let editingAmenityId = null;

        // Show amenities management card
        document.getElementById('set-amenities-btn').addEventListener('click', async () => {
            const amenitiesCard = document.getElementById('amenities-management-card');
            const verticalMenu = document.getElementById('vertical-menu');
            
            ensureDashboardVisible();
            hideAllManagementCards();
            
            amenitiesCard.style.display = 'block';
            amenitiesCard.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            
            // Show action bar
            showActionBar('Room Amenities Management', []);
            verticalMenu.classList.remove('show');
            
            await loadAmenities();
        });

        // Language tab switching
        document.querySelectorAll('.lang-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.lang-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                currentAmenityLang = tab.dataset.lang;
                updateAmenityLabel();
            });
        });

        function updateAmenityLabel() {
            const labels = {
                en: 'Amenity Name (English)',
                nl: 'Amenity Name (Nederlands)',
                fr: 'Amenity Name (FranÃ§ais)'
            };
            document.getElementById('amenity-name-label').textContent = labels[currentAmenityLang];
        }

        // Add new amenity
        document.getElementById('add-amenity-btn').addEventListener('click', async () => {
            const input = document.getElementById('amenity-name-input');
            const name = input.value.trim();
            
            if (!name) {
                showErrorNotification('Please enter an amenity name');
                return;
            }
            
            // Create temporary amenity object with all languages
            const timestamp = Date.now();
            const amenityId = `amenity_${timestamp}`;
            
            // Initialize with current language, others can be edited later
            const amenityData = {
                name_en: currentAmenityLang === 'en' ? name : '',
                name_nl: currentAmenityLang === 'nl' ? name : '',
                name_fr: currentAmenityLang === 'fr' ? name : '',
                timestamp: timestamp
            };
            
            try {
                await set(dbRef(database, `amenitiesMaster/${amenityId}`), amenityData);
                input.value = '';
                showSuccessNotification('Amenity added successfully!');
                await loadAmenities();
            } catch (error) {
                console.error('Error adding amenity:', error);
                showErrorNotification('Failed to add amenity. Please try again.');
            }
        });

        // Load all amenities
        async function loadAmenities() {
            try {
                const snapshot = await get(dbRef(database, 'amenitiesMaster'));
                
                if (!snapshot.exists()) {
                    amenitiesData = {};
                    renderAmenitiesList();
                    return;
                }
                
                amenitiesData = snapshot.val();
                renderAmenitiesList();
            } catch (error) {
                console.error('Error loading amenities:', error);
            }
        }

        // Render amenities list
        function renderAmenitiesList() {
            const container = document.getElementById('amenities-list');
            
            if (Object.keys(amenitiesData).length === 0) {
                container.innerHTML = '<p style="color: var(--color-sage); text-align: center;">No amenities added yet. Add your first amenity above.</p>';
                return;
            }
            
            let html = '';
            
            Object.keys(amenitiesData).forEach(id => {
                const amenity = amenitiesData[id];
                const nameEn = amenity.name_en || 'â€”';
                const nameNl = amenity.name_nl || 'â€”';
                const nameFr = amenity.name_fr || 'â€”';
                
                html += `
                    <div class="amenity-item">
                        <div class="amenity-info">
                            <div class="amenity-name">${escapeHtml(nameEn)}</div>
                            <div class="amenity-translations">
                                NL: ${escapeHtml(nameNl)} | FR: ${escapeHtml(nameFr)}
                            </div>
                        </div>
                        <div class="amenity-actions">
                            <button class="btn-edit-amenity" onclick="editAmenity('${id}')">Edit</button>
                            <button class="btn-delete-amenity" onclick="deleteAmenity('${id}')">Delete</button>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // Edit amenity
        window.editAmenity = function(amenityId) {
            editingAmenityId = amenityId;
            const amenity = amenitiesData[amenityId];
            
            // Create modal
            const modal = document.createElement('div');
            modal.className = 'amenity-edit-modal show';
            modal.innerHTML = `
                <div class="amenity-edit-content">
                    <h3>Edit Amenity</h3>
                    <div class="form-group">
                        <label>English Name</label>
                        <input type="text" id="edit-name-en" class="form-control" value="${escapeHtml(amenity.name_en || '')}">
                    </div>
                    <div class="form-group">
                        <label>Nederlands Name</label>
                        <input type="text" id="edit-name-nl" class="form-control" value="${escapeHtml(amenity.name_nl || '')}">
                    </div>
                    <div class="form-group">
                        <label>FranÃ§ais Name</label>
                        <input type="text" id="edit-name-fr" class="form-control" value="${escapeHtml(amenity.name_fr || '')}">
                    </div>
                    <div class="amenity-edit-actions">
                        <button class="btn" onclick="saveAmenityEdit()">Save Changes</button>
                        <button class="btn btn-cancel" onclick="closeEditModal()">Cancel</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        };

        // Save amenity edit
        window.saveAmenityEdit = async function() {
            const nameEn = document.getElementById('edit-name-en').value.trim();
            const nameNl = document.getElementById('edit-name-nl').value.trim();
            const nameFr = document.getElementById('edit-name-fr').value.trim();
            
            if (!nameEn && !nameNl && !nameFr) {
                showErrorNotification('Please enter at least one name');
                return;
            }
            
            try {
                await set(dbRef(database, `amenitiesMaster/${editingAmenityId}`), {
                    name_en: nameEn,
                    name_nl: nameNl,
                    name_fr: nameFr,
                    timestamp: amenitiesData[editingAmenityId].timestamp
                });
                
                closeEditModal();
                showSuccessNotification('Amenity updated successfully!');
                await loadAmenities();
            } catch (error) {
                console.error('Error updating amenity:', error);
                showErrorNotification('Failed to update amenity. Please try again.');
            }
        };

        // Close edit modal
        window.closeEditModal = function() {
            const modal = document.querySelector('.amenity-edit-modal');
            if (modal) {
                modal.remove();
            }
            editingAmenityId = null;
        };

        // Delete amenity
        window.deleteAmenity = async function(amenityId) {
            if (!confirm('Are you sure you want to delete this amenity? It will be removed from all rooms that use it.')) {
                return;
            }
            
            try {
                await set(dbRef(database, `amenitiesMaster/${amenityId}`), null);
                showSuccessNotification('Amenity deleted successfully!');
                await loadAmenities();
            } catch (error) {
                console.error('Error deleting amenity:', error);
                showErrorNotification('Failed to delete amenity. Please try again.');
            }
        };

        // Tab switching
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('about-us-tab')) {
                document.querySelectorAll('.about-us-tab').forEach(tab => tab.classList.remove('active'));
                e.target.classList.add('active');
                currentAboutUsTab = e.target.dataset.tab;
                renderAboutUsTab();
            }
            
            if (e.target.classList.contains('about-us-lang-tab')) {
                document.querySelectorAll('.about-us-lang-tab').forEach(tab => tab.classList.remove('active'));
                e.target.classList.add('active');
                currentAboutUsLang = e.target.dataset.lang;
                renderAboutUsTab();
            }
        });

        // Load About Us data from Firebase
        async function loadAboutUsData() {
            try {
                const snapshot = await get(dbRef(database, 'aboutUs'));
                
                if (snapshot.exists()) {
                    aboutUsData = snapshot.val();
                }
            } catch (error) {
                console.error('Error loading About Us data:', error);
            }
        }

        // Render tab content
        function renderAboutUsTab() {
            const container = document.getElementById('about-us-tab-content');
            
            // Language tabs
            const langTabs = `
                <div class="about-us-lang-tabs">
                    <button class="about-us-lang-tab ${currentAboutUsLang === 'en' ? 'active' : ''}" data-lang="en" aria-label="English">ðŸ‡¬ðŸ‡§ EN</button>
                    <button class="about-us-lang-tab ${currentAboutUsLang === 'nl' ? 'active' : ''}" data-lang="nl" aria-label="Nederlands">ðŸ‡³ðŸ‡± NL</button>
                    <button class="about-us-lang-tab ${currentAboutUsLang === 'fr' ? 'active' : ''}" data-lang="fr" aria-label="FranÃ§ais">ðŸ‡«ðŸ‡· FR</button>
                </div>
            `;
            
            let content = '';
            
            if (currentAboutUsTab === 'title') {
                const titleValue = aboutUsData.title[currentAboutUsLang] || '';
                content = `
                    ${langTabs}
                    <div class="about-us-section">
                        <h4>About Us Title</h4>
                        <div class="form-group">
                            <input type="text" id="about-us-title-input" class="form-control" value="${escapeHtml(titleValue)}" placeholder="Enter title">
                        </div>
                    </div>
                    <button class="btn" id="save-about-us-title-btn">Save Title</button>
                `;
            } else if (currentAboutUsTab === 'left') {
                const sub1 = aboutUsData.left.subtitle1[currentAboutUsLang] || '';
                const sub2 = aboutUsData.left.subtitle2[currentAboutUsLang] || '';
                const body = aboutUsData.left.textBody[currentAboutUsLang] || '';
                
                content = `
                    ${langTabs}
                    <div class="about-us-section">
                        <h4>Subtitle 1</h4>
                        <div class="form-group">
                            <input type="text" id="about-us-left-sub1" class="form-control" value="${escapeHtml(sub1)}" placeholder="Enter subtitle 1">
                        </div>
                    </div>
                    <div class="about-us-section">
                        <h4>Subtitle 2</h4>
                        <div class="form-group">
                            <input type="text" id="about-us-left-sub2" class="form-control" value="${escapeHtml(sub2)}" placeholder="Enter subtitle 2">
                        </div>
                    </div>
                    <div class="about-us-section">
                        <h4>Text Body</h4>
                        <p style="color: var(--color-sage); font-size: 0.9rem; margin-bottom: 0.5rem;">Tip: Press Enter to add line spacing between paragraphs</p>
                        <textarea id="about-us-left-body" class="admin-textarea" placeholder="Enter text body">${escapeHtml(body)}</textarea>
                    </div>
                    <button class="btn" id="save-about-us-left-btn">Save Left Content</button>
                `;
            } else if (currentAboutUsTab === 'right') {
                const sub1 = aboutUsData.right.subtitle1[currentAboutUsLang] || '';
                const sub2 = aboutUsData.right.subtitle2[currentAboutUsLang] || '';
                const body = aboutUsData.right.textBody[currentAboutUsLang] || '';
                
                content = `
                    ${langTabs}
                    <div class="about-us-section">
                        <h4>Subtitle 1</h4>
                        <div class="form-group">
                            <input type="text" id="about-us-right-sub1" class="form-control" value="${escapeHtml(sub1)}" placeholder="Enter subtitle 1">
                        </div>
                    </div>
                    <div class="about-us-section">
                        <h4>Subtitle 2</h4>
                        <div class="form-group">
                            <input type="text" id="about-us-right-sub2" class="form-control" value="${escapeHtml(sub2)}" placeholder="Enter subtitle 2">
                        </div>
                    </div>
                    <div class="about-us-section">
                        <h4>Text Body</h4>
                        <p style="color: var(--color-sage); font-size: 0.9rem; margin-bottom: 0.5rem;">Tip: Press Enter to add line spacing between paragraphs</p>
                        <textarea id="about-us-right-body" class="admin-textarea" placeholder="Enter text body">${escapeHtml(body)}</textarea>
                    </div>
                    <button class="btn" id="save-about-us-right-btn">Save Right Content</button>
                `;
            }
            
            container.innerHTML = content;
            
            // Attach save handlers (no Quill initialization needed)
            attachAboutUsSaveHandlers();
        }

        // Attach save button handlers
        function attachAboutUsSaveHandlers() {
            const saveTitleBtn = document.getElementById('save-about-us-title-btn');
            const saveLeftBtn = document.getElementById('save-about-us-left-btn');
            const saveRightBtn = document.getElementById('save-about-us-right-btn');
            
            if (saveTitleBtn) {
                saveTitleBtn.addEventListener('click', async () => {
                    const value = document.getElementById('about-us-title-input').value;
                    aboutUsData.title[currentAboutUsLang] = value;
                    await saveAboutUsData();
                });
            }
            
            if (saveLeftBtn) {
                saveLeftBtn.addEventListener('click', async () => {
                    aboutUsData.left.subtitle1[currentAboutUsLang] = document.getElementById('about-us-left-sub1').value;
                    aboutUsData.left.subtitle2[currentAboutUsLang] = document.getElementById('about-us-left-sub2').value;
                    aboutUsData.left.textBody[currentAboutUsLang] = document.getElementById('about-us-left-body').value;
                    await saveAboutUsData();
                });
            }
            
            if (saveRightBtn) {
                saveRightBtn.addEventListener('click', async () => {
                    aboutUsData.right.subtitle1[currentAboutUsLang] = document.getElementById('about-us-right-sub1').value;
                    aboutUsData.right.subtitle2[currentAboutUsLang] = document.getElementById('about-us-right-sub2').value;
                    aboutUsData.right.textBody[currentAboutUsLang] = document.getElementById('about-us-right-body').value;
                    await saveAboutUsData();
                });
            }
        }

        // Save to Firebase
        async function saveAboutUsData() {
            try {
                await set(dbRef(database, 'aboutUs'), aboutUsData);
                showSuccessNotification('About Us content saved successfully!');
            } catch (error) {
                console.error('Error saving About Us data:', error);
                showErrorNotification('Failed to save. Please try again.');
            }
        }

        // ============ ADS BOTTOM MANAGEMENT ============
        let adsBottomData = {
            titles: {
                title1_en: '', title1_nl: '', title1_fr: '',
                title2_en: '', title2_nl: '', title2_fr: '',
                title3_en: '', title3_nl: '', title3_fr: ''
            },
            ad1: {
                imageUrl: '',
                title_en: '', title_nl: '', title_fr: '',
                body_en: '', body_nl: '', body_fr: ''
            },
            ad2: {
                imageUrl: '',
                title_en: '', title_nl: '', title_fr: '',
                body_en: '', body_nl: '', body_fr: ''
            },
            ad3: {
                imageUrl: '',
                title_en: '', title_nl: '', title_fr: '',
                body_en: '', body_nl: '', body_fr: ''
            }
        };

        let currentAdsBottomTab = 'titles';
        let currentAdsBottomLang = 'en';

        // Tab switching for Ads Bottom
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('ads-bottom-tab')) {
                document.querySelectorAll('.ads-bottom-tab').forEach(tab => tab.classList.remove('active'));
                e.target.classList.add('active');
                currentAdsBottomTab = e.target.dataset.tab;
                renderAdsBottomTab();
            }
            
            if (e.target.classList.contains('ads-bottom-lang-tab')) {
                document.querySelectorAll('.ads-bottom-lang-tab').forEach(tab => tab.classList.remove('active'));
                e.target.classList.add('active');
                currentAdsBottomLang = e.target.dataset.lang;
                renderAdsBottomTab();
            }
        });

        // Load Ads Bottom data from Firebase
        async function loadAdsBottomData() {
            try {
                const snapshot = await get(dbRef(database, 'adsBottom'));
                
                if (snapshot.exists()) {
                    adsBottomData = snapshot.val();
                }
            } catch (error) {
                console.error('Error loading Ads Bottom data:', error);
            }
        }

        // Render Ads Bottom tab content
        function renderAdsBottomTab() {
            const container = document.getElementById('ads-bottom-tab-content');
            
            // Language tabs
            const langTabs = `
                <div class="ads-bottom-lang-tabs">
                    <button class="ads-bottom-lang-tab ${currentAdsBottomLang === 'en' ? 'active' : ''}" data-lang="en">ðŸ‡¬ðŸ‡§ EN</button>
                    <button class="ads-bottom-lang-tab ${currentAdsBottomLang === 'nl' ? 'active' : ''}" data-lang="nl">ðŸ‡³ðŸ‡± NL</button>
                    <button class="ads-bottom-lang-tab ${currentAdsBottomLang === 'fr' ? 'active' : ''}" data-lang="fr">ðŸ‡«ðŸ‡· FR</button>
                </div>
            `;
            
            let content = '';
            
            if (currentAdsBottomTab === 'titles') {
                const title1 = adsBottomData.titles[`title1_${currentAdsBottomLang}`] || '';
                const title2 = adsBottomData.titles[`title2_${currentAdsBottomLang}`] || '';
                const title3 = adsBottomData.titles[`title3_${currentAdsBottomLang}`] || '';
                
                content = `
                    ${langTabs}
                    <div class="form-group">
                        <label>Title 1</label>
                        <input type="text" id="ads-bottom-title1" class="form-control" value="${escapeHtml(title1)}" placeholder="Enter title 1">
                    </div>
                    <div class="form-group">
                        <label>Title 2</label>
                        <input type="text" id="ads-bottom-title2" class="form-control" value="${escapeHtml(title2)}" placeholder="Enter title 2">
                    </div>
                    <div class="form-group">
                        <label>Title 3</label>
                        <input type="text" id="ads-bottom-title3" class="form-control" value="${escapeHtml(title3)}" placeholder="Enter title 3">
                    </div>
                    <button class="btn" id="save-ads-bottom-titles-btn">Save Titles</button>
                `;
            } else {
                // Ad tab (ad1, ad2, or ad3)
                const ad = adsBottomData[currentAdsBottomTab];
                const title = ad[`title_${currentAdsBottomLang}`] || '';
                const body = ad[`body_${currentAdsBottomLang}`] || '';
                
                content = `
                    ${langTabs}
                    <div class="form-group">
                        <label>Image</label>
                        <input type="file" id="ads-bottom-image-upload-${currentAdsBottomTab}" accept="image/*" style="margin-bottom: 0.5rem;">
                        ${ad.imageUrl ? `<img src="${ad.imageUrl}" style="max-width: 300px; display: block; margin-top: 0.5rem; border-radius: 4px;">` : '<p style="color: var(--color-sage);">No image uploaded</p>'}
                    </div>
                    <div class="form-group">
                        <label>Title</label>
                        <input type="text" id="ads-bottom-ad-title" class="form-control" value="${escapeHtml(title)}" placeholder="Enter title">
                    </div>
                    <div class="form-group">
                        <label>Body Text</label>
                        <p style="color: var(--color-sage); font-size: 0.9rem; margin-bottom: 0.5rem;">Tip: Press Enter to add line spacing between paragraphs</p>
                        <textarea id="ads-bottom-ad-body" class="admin-textarea" placeholder="Enter body text">${escapeHtml(body)}</textarea>
                    </div>
                    <button class="btn" id="save-ads-bottom-ad-btn">Save Ad</button>
                `;
            }
            
            container.innerHTML = content;
            
            // Attach save handlers
            attachAdsBottomSaveHandlers();
        }

        // Attach save button handlers for Ads Bottom
        function attachAdsBottomSaveHandlers() {
            const saveTitlesBtn = document.getElementById('save-ads-bottom-titles-btn');
            const saveAdBtn = document.getElementById('save-ads-bottom-ad-btn');
            
            if (saveTitlesBtn) {
                saveTitlesBtn.addEventListener('click', async () => {
                    adsBottomData.titles[`title1_${currentAdsBottomLang}`] = document.getElementById('ads-bottom-title1').value;
                    adsBottomData.titles[`title2_${currentAdsBottomLang}`] = document.getElementById('ads-bottom-title2').value;
                    adsBottomData.titles[`title3_${currentAdsBottomLang}`] = document.getElementById('ads-bottom-title3').value;
                    await saveAdsBottomData();
                });
            }
            
            if (saveAdBtn) {
                const imageInput = document.getElementById(`ads-bottom-image-upload-${currentAdsBottomTab}`);
                
                if (imageInput) {
                    imageInput.addEventListener('change', async (e) => {
                        const file = e.target.files[0];
                        if (!file) return;
                        
                        if (!file.type.startsWith('image/')) {
                            showErrorNotification('Please select an image file');
                            return;
                        }
                        
                        try {
                            const timestamp = Date.now();
                            const filename = `ads-bottom/${currentAdsBottomTab}-${timestamp}-${file.name}`;
                            const fileRef = storageRef(storage, filename);
                            
                            await uploadBytes(fileRef, file);
                            const downloadURL = await getDownloadURL(fileRef);
                            
                            adsBottomData[currentAdsBottomTab].imageUrl = downloadURL;
                            
                            await set(dbRef(database, 'adsBottom'), adsBottomData);
                            
                            renderAdsBottomTab();
                            showSuccessNotification('Image uploaded successfully!');
                        } catch (error) {
                            console.error('Error uploading image:', error);
                            showErrorNotification('Failed to upload image.');
                        }
                    });
                }
                
                saveAdBtn.addEventListener('click', async () => {
                    const title = document.getElementById('ads-bottom-ad-title').value;
                    const body = document.getElementById('ads-bottom-ad-body').value;
                    
                    adsBottomData[currentAdsBottomTab][`title_${currentAdsBottomLang}`] = title;
                    adsBottomData[currentAdsBottomTab][`body_${currentAdsBottomLang}`] = body;
                    
                    await saveAdsBottomData();
                });
            }
        }

        // Save Ads Bottom data to Firebase
        async function saveAdsBottomData() {
            try {
                await set(dbRef(database, 'adsBottom'), adsBottomData);
                showSuccessNotification('Ads Bottom content saved successfully!');
            } catch (error) {
                console.error('Error saving Ads Bottom data:', error);
                showErrorNotification('Failed to save. Please try again.');
            }
        }

        // ============ PACKAGE MANAGEMENT ============
        let packagesData = [];
        let currentPackageStatus = 'active';
        let packageModalOpen = false;
        let editingPackageId = null;

        // Load packages data from Firebase
        async function loadPackagesData() {
            try {
                const snapshot = await get(dbRef(database, 'packages'));
                if (snapshot.exists()) {
                    const data = snapshot.val();
                    packagesData = Object.keys(data).map(key => ({
                        id: key,
                        ...data[key]
                    }));
                } else {
                    packagesData = [];
                }
            } catch (error) {
                console.error('Error loading packages:', error);
                packagesData = [];
            }
        }

        // Save packages data to Firebase
        async function savePackagesData() {
            try {
                const dataToSave = {};
                packagesData.forEach(pkg => {
                    const { id, ...packageData } = pkg;
                    dataToSave[id] = packageData;
                });
                await set(dbRef(database, 'packages'), dataToSave);
            } catch (error) {
                console.error('Error saving packages:', error);
                throw error;
            }
        }

        // Render packages list
        function renderPackagesList() {
            const container = document.getElementById('package-list-container');
            const filteredPackages = packagesData.filter(pkg => 
                pkg.status === currentPackageStatus
            );

            if (filteredPackages.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: var(--color-sage);">
                        <p>No ${currentPackageStatus} packages found.</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = filteredPackages.map(pkg => `
                <div class="package-item" data-package-id="${pkg.id}" draggable="true">
                    <div class="package-item-content">
                        <div class="package-item-image">
                            ${pkg.imageUrl ? `<img src="${pkg.imageUrl}" alt="${pkg.title_en || 'Package'}">` : '<div class="no-image">No Image</div>'}
                        </div>
                        <div class="package-item-details">
                            <h3>${pkg.title_en || 'Untitled Package'}</h3>
                            <p>${pkg.description_en ? pkg.description_en.substring(0, 100) + '...' : 'No description'}</p>
                            <div class="package-item-meta">
                                <label class="our-picks-toggle">
                                    <input type="checkbox" class="our-picks-checkbox" data-package-id="${pkg.id}" ${pkg.showInOurPicks ? 'checked' : ''}>
                                    <span class="our-picks-toggle-slider"></span>
                                    <span class="our-picks-toggle-label">Show in Our Picks</span>
                                </label>
                            </div>
                            <div class="package-item-actions">
                                <button class="btn btn-small edit-package-btn" data-package-id="${pkg.id}">Edit</button>
                                <button class="btn btn-small btn-danger delete-package-btn" data-package-id="${pkg.id}">Delete</button>
                                <button class="btn btn-small toggle-status-btn" data-package-id="${pkg.id}">
                                    ${pkg.status === 'active' ? 'Deactivate' : 'Activate'}
                                </button>
                            </div>
                        </div>
                        <div class="package-drag-handle">â‹®â‹®</div>
                    </div>
                </div>
            `).join('');

            // Add drag and drop functionality
            setupDragAndDrop();
            
            // Add event listeners
            document.querySelectorAll('.edit-package-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const packageId = e.target.dataset.packageId;
                    openPackageModal(packageId);
                });
            });

            document.querySelectorAll('.delete-package-btn').forEach(btn => {
                btn.addEventListener('click', async (e) => {
                    const packageId = e.target.dataset.packageId;
                    await deletePackage(packageId);
                });
            });

            document.querySelectorAll('.toggle-status-btn').forEach(btn => {
                btn.addEventListener('click', async (e) => {
                    const packageId = e.target.dataset.packageId;
                    await togglePackageStatus(packageId);
                });
            });

            document.querySelectorAll('.our-picks-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', async (e) => {
                    const packageId = e.target.dataset.packageId;
                    await toggleOurPicks(packageId, e.target.checked);
                });
            });
        }

        // Setup drag and drop
        function setupDragAndDrop() {
            const packageItems = document.querySelectorAll('.package-item');
            let draggedElement = null;

            packageItems.forEach(item => {
                item.addEventListener('dragstart', (e) => {
                    draggedElement = item;
                    item.style.opacity = '0.5';
                });

                item.addEventListener('dragend', (e) => {
                    item.style.opacity = '1';
                });

                item.addEventListener('dragover', (e) => {
                    e.preventDefault();
                });

                item.addEventListener('drop', async (e) => {
                    e.preventDefault();
                    if (draggedElement !== item) {
                        const allItems = Array.from(packageItems);
                        const draggedIndex = allItems.indexOf(draggedElement);
                        const targetIndex = allItems.indexOf(item);

                        const draggedId = draggedElement.dataset.packageId;
                        const targetId = item.dataset.packageId;

                        // Reorder in data
                        const draggedPkg = packagesData.find(p => p.id === draggedId);
                        const draggedDataIndex = packagesData.indexOf(draggedPkg);
                        const targetPkg = packagesData.find(p => p.id === targetId);
                        const targetDataIndex = packagesData.indexOf(targetPkg);

                        packagesData.splice(draggedDataIndex, 1);
                        packagesData.splice(targetDataIndex, 0, draggedPkg);

                        await savePackagesData();
                        renderPackagesList();
                    }
                });
            });
        }

        // Open package modal
        function openPackageModal(packageId = null) {
            editingPackageId = packageId;
            const pkg = packageId ? packagesData.find(p => p.id === packageId) : null;

            const modalHTML = `
                <div id="package-modal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 10000; display: flex; align-items: center; justify-content: center; overflow-y: auto;">
                    <div style="background: white; padding: 2rem; border-radius: 8px; max-width: 800px; width: 90%; max-height: 90vh; overflow-y: auto; margin: 2rem;">
                        <h2>${packageId ? 'Edit Package' : 'Add New Package'}</h2>
                        
                        <!-- Language Tabs -->
                        <div class="package-lang-tabs" style="margin: 1rem 0; display: flex; gap: 0.5rem;">
                            <button class="package-lang-tab active" data-lang="en">ðŸ‡¬ðŸ‡§ EN</button>
                            <button class="package-lang-tab" data-lang="nl">ðŸ‡³ðŸ‡± NL</button>
                            <button class="package-lang-tab" data-lang="fr">ðŸ‡«ðŸ‡· FR</button>
                        </div>

                        <!-- Package Image -->
                        <div style="margin: 1rem 0;">
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Package Image</label>
                            <input type="file" id="package-image-input" accept="image/*" style="display: none;">
                            <button class="btn" id="package-upload-image-btn">Upload Image</button>
                            <div id="package-image-preview" style="margin-top: 1rem;">
                                ${pkg && pkg.imageUrl ? `<img src="${pkg.imageUrl}" style="max-width: 300px; border-radius: 8px;">` : ''}
                            </div>
                        </div>

                        <!-- Multi-language fields -->
                        <div id="package-lang-en" class="package-lang-content">
                            <div style="margin: 1rem 0;">
                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Title (English)</label>
                                <input type="text" id="package-title-en" class="form-input" value="${pkg ? (pkg.title_en || '') : ''}" style="width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px;">
                            </div>
                            <div style="margin: 1rem 0;">
                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Description (English)</label>
                                <p style="color: var(--color-sage); font-size: 0.9rem; margin-bottom: 0.5rem;">Tip: Press Enter to add line spacing between paragraphs</p>
                                <textarea id="package-description-en" class="admin-textarea">${pkg ? (pkg.description_en || '') : ''}</textarea>
                            </div>
                            <div style="margin: 1rem 0;">
                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Inclusions (English) - One per line</label>
                                <textarea id="package-inclusions-en" class="form-input" style="width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px; min-height: 80px;">${pkg ? (pkg.inclusions_en || '') : ''}</textarea>
                            </div>
                            <div style="margin: 1rem 0;">
                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Good to Know (English) - One per line</label>
                                <textarea id="package-goodtoknow-en" class="form-input" style="width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px; min-height: 80px;">${pkg ? (pkg.goodToKnow_en || '') : ''}</textarea>
                            </div>
                        </div>

                        <div id="package-lang-nl" class="package-lang-content" style="display: none;">
                            <div style="margin: 1rem 0;">
                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Title (Dutch)</label>
                                <input type="text" id="package-title-nl" class="form-input" value="${pkg ? (pkg.title_nl || '') : ''}" style="width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px;">
                            </div>
                            <div style="margin: 1rem 0;">
                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Description (Dutch)</label>
                                <p style="color: var(--color-sage); font-size: 0.9rem; margin-bottom: 0.5rem;">Tip: Press Enter to add line spacing between paragraphs</p>
                                <textarea id="package-description-nl" class="admin-textarea">${pkg ? (pkg.description_nl || '') : ''}</textarea>
                            </div>
                            <div style="margin: 1rem 0;">
                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Inclusions (Dutch) - One per line</label>
                                <textarea id="package-inclusions-nl" class="form-input" style="width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px; min-height: 80px;">${pkg ? (pkg.inclusions_nl || '') : ''}</textarea>
                            </div>
                            <div style="margin: 1rem 0;">
                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Good to Know (Dutch) - One per line</label>
                                <textarea id="package-goodtoknow-nl" class="form-input" style="width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px; min-height: 80px;">${pkg ? (pkg.goodToKnow_nl || '') : ''}</textarea>
                            </div>
                        </div>

                        <div id="package-lang-fr" class="package-lang-content" style="display: none;">
                            <div style="margin: 1rem 0;">
                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Title (French)</label>
                                <input type="text" id="package-title-fr" class="form-input" value="${pkg ? (pkg.title_fr || '') : ''}" style="width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px;">
                            </div>
                            <div style="margin: 1rem 0;">
                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Description (French)</label>
                                <p style="color: var(--color-sage); font-size: 0.9rem; margin-bottom: 0.5rem;">Tip: Press Enter to add line spacing between paragraphs</p>
                                <textarea id="package-description-fr" class="admin-textarea">${pkg ? (pkg.description_fr || '') : ''}</textarea>
                            </div>
                            <div style="margin: 1rem 0;">
                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Inclusions (French) - One per line</label>
                                <textarea id="package-inclusions-fr" class="form-input" style="width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px; min-height: 80px;">${pkg ? (pkg.inclusions_fr || '') : ''}</textarea>
                            </div>
                            <div style="margin: 1rem 0;">
                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Good to Know (French) - One per line</label>
                                <textarea id="package-goodtoknow-fr" class="form-input" style="width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px; min-height: 80px;">${pkg ? (pkg.goodToKnow_fr || '') : ''}</textarea>
                            </div>
                        </div>

                        <!-- Booking Link -->
                        <div style="margin: 1rem 0;">
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Booking/Action Link (URL)</label>
                            <input type="url" id="package-booking-link" class="form-input" value="${pkg ? (pkg.bookingLink || '') : ''}" placeholder="https://example.com/booking" style="width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px;">
                        </div>

                        <!-- Status -->
                        <div style="margin: 1rem 0;">
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Status</label>
                            <select id="package-status" style="width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px;">
                                <option value="active" ${pkg && pkg.status === 'active' ? 'selected' : ''}>Active</option>
                                <option value="inactive" ${pkg && pkg.status === 'inactive' ? 'selected' : ''}>Inactive</option>
                            </select>
                        </div>

                        <!-- Action Buttons -->
                        <div style="margin-top: 2rem; display: flex; gap: 1rem; justify-content: flex-end;">
                            <button class="btn" id="cancel-package-btn">Cancel</button>
                            <button class="btn" id="save-package-btn" style="background: var(--color-sage);">Save Package</button>
                        </div>
                    </div>
                </div>
            `;

            document.body.insertAdjacentHTML('beforeend', modalHTML);
            packageModalOpen = true;

            // Language tab switching
            document.querySelectorAll('.package-lang-tab').forEach(tab => {
                tab.addEventListener('click', (e) => {
                    const lang = e.target.dataset.lang;
                    document.querySelectorAll('.package-lang-tab').forEach(t => t.classList.remove('active'));
                    e.target.classList.add('active');
                    document.querySelectorAll('.package-lang-content').forEach(c => c.style.display = 'none');
                    document.getElementById(`package-lang-${lang}`).style.display = 'block';
                });
            });

            // Image upload
            const uploadBtn = document.getElementById('package-upload-image-btn');
            const imageInput = document.getElementById('package-image-input');
            let uploadedImageUrl = pkg ? pkg.imageUrl : null;

            uploadBtn.addEventListener('click', () => imageInput.click());
            
            imageInput.addEventListener('change', async (e) => {
                const file = e.target.files[0];
                if (!file) return;

                if (!file.type.startsWith('image/')) {
                    showErrorNotification('Please select an image file');
                    return;
                }

                try {
                    const timestamp = Date.now();
                    const filename = `packages/${timestamp}-${file.name}`;
                    const fileRef = storageRef(storage, filename);
                    
                    await uploadBytes(fileRef, file);
                    uploadedImageUrl = await getDownloadURL(fileRef);
                    
                    document.getElementById('package-image-preview').innerHTML = 
                        `<img src="${uploadedImageUrl}" style="max-width: 300px; border-radius: 8px;">`;
                    
                    showSuccessNotification('Image uploaded successfully!');
                } catch (error) {
                    console.error('Error uploading image:', error);
                    showErrorNotification('Failed to upload image.');
                }
            });

            // Save package
            document.getElementById('save-package-btn').addEventListener('click', async () => {
                const packageData = {
                    imageUrl: uploadedImageUrl,
                    title_en: document.getElementById('package-title-en').value,
                    title_nl: document.getElementById('package-title-nl').value,
                    title_fr: document.getElementById('package-title-fr').value,
                    description_en: document.getElementById('package-description-en').value,
                    description_nl: document.getElementById('package-description-nl').value,
                    description_fr: document.getElementById('package-description-fr').value,
                    inclusions_en: document.getElementById('package-inclusions-en').value,
                    inclusions_nl: document.getElementById('package-inclusions-nl').value,
                    inclusions_fr: document.getElementById('package-inclusions-fr').value,
                    goodToKnow_en: document.getElementById('package-goodtoknow-en').value,
                    goodToKnow_nl: document.getElementById('package-goodtoknow-nl').value,
                    goodToKnow_fr: document.getElementById('package-goodtoknow-fr').value,
                    bookingLink: document.getElementById('package-booking-link').value,
                    status: document.getElementById('package-status').value
                };

                if (!packageData.title_en) {
                    showErrorNotification('Please enter at least an English title');
                    return;
                }

                try {
                    if (editingPackageId) {
                        const pkgIndex = packagesData.findIndex(p => p.id === editingPackageId);
                        packagesData[pkgIndex] = { id: editingPackageId, ...packageData };
                    } else {
                        const newId = 'pkg_' + Date.now();
                        packagesData.push({ id: newId, ...packageData });
                    }

                    await savePackagesData();
                    showSuccessNotification('Package saved successfully!');
                    closePackageModal();
                    renderPackagesList();
                } catch (error) {
                    console.error('Error saving package:', error);
                    showErrorNotification('Failed to save package. Please try again.');
                }
            });

            // Cancel
            document.getElementById('cancel-package-btn').addEventListener('click', closePackageModal);
            
            // Click outside to close
            document.getElementById('package-modal').addEventListener('click', (e) => {
                if (e.target.id === 'package-modal') {
                    closePackageModal();
                }
            });
        }

        // Close package modal
        function closePackageModal() {
            const modal = document.getElementById('package-modal');
            if (modal) {
                modal.remove();
            }
            packageModalOpen = false;
            editingPackageId = null;
        }

        // Delete package
        async function deletePackage(packageId) {
            if (!confirm('Are you sure you want to delete this package?')) {
                return;
            }

            try {
                packagesData = packagesData.filter(p => p.id !== packageId);
                await savePackagesData();
                renderPackagesList();
                showSuccessNotification('Package deleted successfully!');
            } catch (error) {
                console.error('Error deleting package:', error);
                showErrorNotification('Failed to delete package.');
            }
        }

        // Toggle package status
        async function togglePackageStatus(packageId) {
            try {
                const pkg = packagesData.find(p => p.id === packageId);
                pkg.status = pkg.status === 'active' ? 'inactive' : 'active';
                await savePackagesData();
                renderPackagesList();
            } catch (error) {
                console.error('Error toggling status:', error);
                showErrorNotification('Failed to update status.');
            }
        }

        async function toggleOurPicks(packageId, showInOurPicks) {
            try {
                const pkg = packagesData.find(p => p.id === packageId);
                if (!pkg) {
                    throw new Error('Package not found');
                }
                pkg.showInOurPicks = showInOurPicks;
                await savePackagesData();
            } catch (error) {
                console.error('Error toggling Our Picks:', error);
                showErrorNotification('Failed to update Our Picks status.');
                // Revert the checkbox
                const checkbox = document.querySelector(`.our-picks-checkbox[data-package-id="${packageId}"]`);
                if (checkbox) checkbox.checked = !showInOurPicks;
            }
        }

        // Package tab switching
        document.querySelectorAll('.package-tab').forEach(tab => {
            tab.addEventListener('click', (e) => {
                currentPackageStatus = e.target.dataset.status;
                document.querySelectorAll('.package-tab').forEach(t => t.classList.remove('active'));
                e.target.classList.add('active');
                renderPackagesList();
            });
        });

        // Add new package button
        document.getElementById('add-package-btn').addEventListener('click', () => {
            openPackageModal();
        });

        // ============ ROOM MANAGEMENT ============
        let roomsData = [];
        let roomModalOpen = false;

        // Sanitize filename for Firebase Storage
        function sanitizeFilename(filename) {
            // Extract the file extension
            const lastDotIndex = filename.lastIndexOf('.');
            const name = lastDotIndex > 0 ? filename.substring(0, lastDotIndex) : filename;
            const ext = lastDotIndex > 0 ? filename.substring(lastDotIndex) : '';
            
            // Remove path separators and other potentially problematic characters from name
            const sanitizedName = name.replace(/[^a-zA-Z0-9_-]/g, '_');
            // Only allow alphanumeric and underscore in extension
            const sanitizedExt = ext.replace(/[^a-zA-Z0-9.]/g, '');
            
            return sanitizedName + sanitizedExt;
        }

        async function loadRoomsData() {
            try {
                const roomsSnapshot = await get(dbRef(database, 'rooms'));
                if (roomsSnapshot.exists()) {
                    const roomsObj = roomsSnapshot.val();
                    roomsData = Object.keys(roomsObj).map(id => ({
                        id,
                        ...roomsObj[id]
                    }));
                } else {
                    roomsData = [];
                }
            } catch (error) {
                console.error('Error loading rooms:', error);
                showErrorNotification('Failed to load rooms data.');
            }
        }

        function renderRoomsList() {
            const container = document.getElementById('room-list-container');
            if (!roomsData || roomsData.length === 0) {
                container.innerHTML = '<p style="color: var(--color-sage); text-align: center; margin: 2rem 0;">No rooms available. Click "Add New Room" to create one.</p>';
                attachRoomButtonListeners();
                return;
            }

            const roomsHTML = roomsData.map(room => {
                const escapedId = escapeHtml(room.id);
                const escapedName = escapeHtml(room.name_en || 'Untitled Room');
                const escapedBedType = escapeHtml(room.bedType_en || 'N/A');
                const status = room.status || 'available';
                const isAvailable = status === 'available';
                
                return `
                <div class="room-item" style="border: 1px solid var(--color-sage); border-radius: 8px; padding: 1rem; margin: 1rem 0;">
                    <div style="display: flex; justify-content: space-between; align-items: start;">
                        <div style="flex: 1;">
                            <h3 style="margin: 0 0 0.5rem 0;">${escapedName}</h3>
                            <p style="color: var(--color-sage); margin: 0.25rem 0;"><strong>Bed Type:</strong> ${escapedBedType}</p>
                            <p style="color: var(--color-sage); margin: 0.25rem 0;"><strong>Max Occupancy:</strong> ${room.maxOccupancy || 'N/A'} guests</p>
                            <p style="color: var(--color-sage); margin: 0.25rem 0;"><strong>Room Size:</strong> ${room.roomSize || 'N/A'} mÂ²</p>
                            <p style="color: var(--color-sage); margin: 0.25rem 0;"><strong>Photos:</strong> ${room.photos ? room.photos.length : 0}</p>
                            ${room.video ? '<p style="color: var(--color-sage); margin: 0.25rem 0;"><strong>Video:</strong> Yes</p>' : ''}
                            <div style="margin-top: 0.75rem; display: flex; align-items: center; gap: 0.5rem;">
                                <strong style="color: var(--color-sage);">Status:</strong>
                                <label style="display: flex; align-items: center; cursor: pointer;">
                                    <div style="position: relative; width: 50px; height: 24px; background: ${isAvailable ? '#4CAF50' : '#9E9E9E'}; border-radius: 12px; transition: background 0.3s;">
                                        <input type="checkbox" ${isAvailable ? 'checked' : ''} onchange="toggleRoomStatus('${escapedId}')" style="display: none;">
                                        <div style="position: absolute; top: 2px; left: ${isAvailable ? '26px' : '2px'}; width: 20px; height: 20px; background: white; border-radius: 50%; transition: left 0.3s;"></div>
                                    </div>
                                    <span style="margin-left: 0.5rem; font-weight: 600; color: ${isAvailable ? '#4CAF50' : '#9E9E9E'};">${isAvailable ? 'Available' : 'Offline'}</span>
                                </label>
                            </div>
                        </div>
                        <div style="display: flex; gap: 0.5rem;">
                            <button class="btn" onclick="editRoom('${escapedId}')" style="padding: 0.5rem 1rem;">Edit</button>
                            <button class="btn" onclick="deleteRoom('${escapedId}')" style="background: #d32f2f; padding: 0.5rem 1rem;">Delete</button>
                        </div>
                    </div>
                </div>
            `;
            }).join('');

            container.innerHTML = roomsHTML;
            attachRoomButtonListeners();
        }

        // Add event listener for "Add New Room" button
        // Must be attached after room management card is visible
        function attachRoomButtonListeners() {
            const addRoomBtn = document.getElementById('add-new-room-btn');
            if (addRoomBtn && !addRoomBtn.hasAttribute('data-listener-attached')) {
                addRoomBtn.addEventListener('click', () => {
                    openRoomModal();
                });
                addRoomBtn.setAttribute('data-listener-attached', 'true');
            }
        }

        async function openRoomModal(roomId = null) {
            if (roomModalOpen) return;

            const room = roomId ? roomsData.find(r => r.id === roomId) : null;
            
            // Load amenities for selection
            const amenitiesSnapshot = await get(dbRef(database, 'amenitiesMaster'));
            let amenitiesList = [];
            if (amenitiesSnapshot.exists()) {
                const amenitiesObj = amenitiesSnapshot.val();
                amenitiesList = Object.keys(amenitiesObj).map(id => ({
                    id,
                    ...amenitiesObj[id]
                }));
            }

            const modalHTML = `
                <div id="room-modal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 10000; display: flex; align-items: center; justify-content: center; overflow-y: auto;">
                    <div style="background: white; padding: 2rem; border-radius: 8px; max-width: 900px; width: 90%; max-height: 90vh; overflow-y: auto; margin: 2rem;">
                        <h2>${roomId ? 'Edit Room' : 'Add New Room'}</h2>
                        
                        <!-- Language Tabs -->
                        <div class="room-lang-tabs" style="margin: 1rem 0; display: flex; gap: 0.5rem;">
                            <button class="room-lang-tab active" data-lang="en">ðŸ‡¬ðŸ‡§ EN</button>
                            <button class="room-lang-tab" data-lang="nl">ðŸ‡³ðŸ‡± NL</button>
                            <button class="room-lang-tab" data-lang="fr">ðŸ‡«ðŸ‡· FR</button>
                        </div>

                        <!-- Multi-language fields -->
                        <div id="room-lang-en" class="room-lang-content">
                            <div style="margin: 1rem 0;">
                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Room Name (English) *</label>
                                <input type="text" id="room-name-en" class="form-input" value="${room ? (room.name_en || '') : ''}" style="width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px;">
                            </div>
                            <div style="margin: 1rem 0;">
                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Bed Type (English) *</label>
                                <input type="text" id="room-bedtype-en" class="form-input" value="${room ? (room.bedType_en || '') : ''}" placeholder="e.g., King Size Bed" style="width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px;">
                            </div>
                            <div style="margin: 1rem 0;">
                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Description (English)</label>
                                <textarea id="room-description-en" class="admin-textarea">${room ? (room.description_en || '') : ''}</textarea>
                            </div>
                        </div>

                        <div id="room-lang-nl" class="room-lang-content" style="display: none;">
                            <div style="margin: 1rem 0;">
                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Room Name (Dutch) *</label>
                                <input type="text" id="room-name-nl" class="form-input" value="${room ? (room.name_nl || '') : ''}" style="width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px;">
                            </div>
                            <div style="margin: 1rem 0;">
                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Bed Type (Dutch) *</label>
                                <input type="text" id="room-bedtype-nl" class="form-input" value="${room ? (room.bedType_nl || '') : ''}" placeholder="e.g., Kingsize Bed" style="width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px;">
                            </div>
                            <div style="margin: 1rem 0;">
                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Description (Dutch)</label>
                                <textarea id="room-description-nl" class="admin-textarea">${room ? (room.description_nl || '') : ''}</textarea>
                            </div>
                        </div>

                        <div id="room-lang-fr" class="room-lang-content" style="display: none;">
                            <div style="margin: 1rem 0;">
                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Room Name (French) *</label>
                                <input type="text" id="room-name-fr" class="form-input" value="${room ? (room.name_fr || '') : ''}" style="width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px;">
                            </div>
                            <div style="margin: 1rem 0;">
                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Bed Type (French) *</label>
                                <input type="text" id="room-bedtype-fr" class="form-input" value="${room ? (room.bedType_fr || '') : ''}" placeholder="e.g., Lit King Size" style="width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px;">
                            </div>
                            <div style="margin: 1rem 0;">
                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Description (French)</label>
                                <textarea id="room-description-fr" class="admin-textarea">${room ? (room.description_fr || '') : ''}</textarea>
                            </div>
                        </div>

                        <!-- Numeric Fields -->
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin: 1rem 0;">
                            <div>
                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Max Occupancy *</label>
                                <input type="number" id="room-max-occupancy" class="form-input" value="${room ? (room.maxOccupancy || '') : ''}" min="1" placeholder="e.g., 2" style="width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Room Size (mÂ²) *</label>
                                <input type="number" id="room-size" class="form-input" value="${room ? (room.roomSize || '') : ''}" min="1" placeholder="e.g., 25" style="width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px;">
                            </div>
                        </div>

                        <!-- Amenities Selection -->
                        <div style="margin: 1rem 0;">
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Amenities</label>
                            <div id="room-amenities-list" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 0.5rem; max-height: 200px; overflow-y: auto; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px;">
                                ${amenitiesList.map(amenity => {
                                    const isChecked = room && room.amenities && room.amenities[amenity.id];
                                    return `
                                        <label style="display: flex; align-items: center; gap: 0.5rem;">
                                            <input type="checkbox" value="${amenity.id}" ${isChecked ? 'checked' : ''} style="cursor: pointer;">
                                            <span>${amenity.name_en || amenity.name_nl || amenity.name_fr}</span>
                                        </label>
                                    `;
                                }).join('')}
                            </div>
                        </div>

                        <!-- Photo Gallery -->
                        <div style="margin: 1rem 0;">
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Room Photos</label>
                            <input type="file" id="room-photo-input" accept="image/*" multiple style="display: none;">
                            <button class="btn" id="room-upload-photo-btn">Upload Photos</button>
                            <p style="color: var(--color-sage); font-size: 0.9rem; margin-top: 0.5rem;">Drag photos to reorder them</p>
                            <div id="room-photo-gallery" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 1rem; margin-top: 1rem;">
                                ${room && room.photos ? room.photos.map((photo, index) => `
                                    <div class="room-photo-item" data-index="${index}" draggable="true" style="position: relative; cursor: move; border: 2px solid var(--color-sage); border-radius: 4px; overflow: hidden;">
                                        <img src="${photo.url}" style="width: 100%; height: 150px; object-fit: cover;">
                                        <button class="btn-delete-photo" data-index="${index}" style="position: absolute; top: 5px; right: 5px; background: #d32f2f; color: white; border: none; border-radius: 50%; width: 24px; height: 24px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 16px; padding: 0;">Ã—</button>
                                    </div>
                                `).join('') : ''}
                            </div>
                        </div>

                        <!-- Video Upload -->
                        <div style="margin: 1rem 0;">
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Room Video (Optional)</label>
                            <input type="file" id="room-video-input" accept="video/*" style="display: none;">
                            <button class="btn" id="room-upload-video-btn">Upload Video</button>
                            <div id="room-video-preview" style="margin-top: 1rem;">
                                ${room && room.video ? `
                                    <div style="position: relative; display: inline-block;">
                                        <video src="${room.video.url}" controls style="max-width: 300px; border-radius: 8px;"></video>
                                        <button class="btn" id="room-delete-video-btn" style="background: #d32f2f; margin-top: 0.5rem;">Delete Video</button>
                                    </div>
                                ` : ''}
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div style="margin-top: 2rem; display: flex; gap: 1rem; justify-content: flex-end;">
                            <button class="btn" id="cancel-room-btn">Cancel</button>
                            <button class="btn" id="save-room-btn" style="background: var(--color-sage);">Save Room</button>
                        </div>
                    </div>
                </div>
            `;

            document.body.insertAdjacentHTML('beforeend', modalHTML);
            roomModalOpen = true;

            // Language tab switching
            document.querySelectorAll('.room-lang-tab').forEach(tab => {
                tab.addEventListener('click', (e) => {
                    const lang = e.target.dataset.lang;
                    document.querySelectorAll('.room-lang-tab').forEach(t => t.classList.remove('active'));
                    e.target.classList.add('active');
                    document.querySelectorAll('.room-lang-content').forEach(c => c.style.display = 'none');
                    document.getElementById(`room-lang-${lang}`).style.display = 'block';
                });
            });

            // Photo upload and management
            let roomPhotos = room && room.photos ? [...room.photos] : [];
            
            const uploadPhotoBtn = document.getElementById('room-upload-photo-btn');
            const photoInput = document.getElementById('room-photo-input');
            
            uploadPhotoBtn.addEventListener('click', () => photoInput.click());
            
            photoInput.addEventListener('change', async (e) => {
                const files = Array.from(e.target.files);
                if (files.length === 0) return;

                uploadPhotoBtn.disabled = true;
                uploadPhotoBtn.textContent = 'Uploading...';

                try {
                    for (const file of files) {
                        const timestamp = Date.now();
                        const sanitizedName = sanitizeFilename(file.name);
                        const filename = `room-photos/${timestamp}-${sanitizedName}`;
                        const fileRef = storageRef(storage, filename);
                        await uploadBytes(fileRef, file);
                        const downloadURL = await getDownloadURL(fileRef);
                        
                        roomPhotos.push({
                            url: downloadURL,
                            filename: filename,
                            order: roomPhotos.length
                        });
                    }
                    
                    renderPhotoGallery();
                    e.target.value = '';
                } catch (error) {
                    console.error('Error uploading photos:', error);
                    showErrorNotification('Failed to upload photos.');
                } finally {
                    uploadPhotoBtn.disabled = false;
                    uploadPhotoBtn.textContent = 'Upload Photos';
                }
            });

            function renderPhotoGallery() {
                const gallery = document.getElementById('room-photo-gallery');
                gallery.innerHTML = roomPhotos.map((photo, index) => `
                    <div class="room-photo-item" data-index="${index}" draggable="true" style="position: relative; cursor: move; border: 2px solid var(--color-sage); border-radius: 4px; overflow: hidden;">
                        <img src="${photo.url}" style="width: 100%; height: 150px; object-fit: cover;">
                        <button class="btn-delete-photo" data-index="${index}" style="position: absolute; top: 5px; right: 5px; background: #d32f2f; color: white; border: none; border-radius: 50%; width: 24px; height: 24px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 16px; padding: 0;">Ã—</button>
                    </div>
                `).join('');

                // Add delete handlers
                gallery.querySelectorAll('.btn-delete-photo').forEach(btn => {
                    btn.addEventListener('click', async (e) => {
                        const index = parseInt(e.target.dataset.index);
                        const photo = roomPhotos[index];
                        
                        if (confirm('Delete this photo?')) {
                            try {
                                await deleteObject(storageRef(storage, photo.filename));
                                roomPhotos.splice(index, 1);
                                renderPhotoGallery();
                            } catch (error) {
                                console.error('Error deleting photo:', error);
                                showErrorNotification('Failed to delete photo.');
                            }
                        }
                    });
                });

                // Add drag and drop handlers
                const photoItems = gallery.querySelectorAll('.room-photo-item');
                let draggedItem = null;

                photoItems.forEach(item => {
                    item.addEventListener('dragstart', (e) => {
                        draggedItem = item;
                        e.dataTransfer.effectAllowed = 'move';
                    });

                    item.addEventListener('dragover', (e) => {
                        e.preventDefault();
                        e.dataTransfer.dropEffect = 'move';
                    });

                    item.addEventListener('drop', (e) => {
                        e.preventDefault();
                        if (draggedItem !== item) {
                            const fromIndex = parseInt(draggedItem.dataset.index);
                            const toIndex = parseInt(item.dataset.index);
                            
                            const [movedPhoto] = roomPhotos.splice(fromIndex, 1);
                            roomPhotos.splice(toIndex, 0, movedPhoto);
                            
                            renderPhotoGallery();
                        }
                    });
                });
            }

            renderPhotoGallery();

            // Video upload
            let roomVideo = room && room.video ? room.video : null;
            
            const uploadVideoBtn = document.getElementById('room-upload-video-btn');
            const videoInput = document.getElementById('room-video-input');
            const videoPreview = document.getElementById('room-video-preview');
            
            uploadVideoBtn.addEventListener('click', () => videoInput.click());
            
            videoInput.addEventListener('change', async (e) => {
                const file = e.target.files[0];
                if (!file) return;

                if (!file.type.startsWith('video/')) {
                    showErrorNotification('Please select a video file');
                    return;
                }

                uploadVideoBtn.disabled = true;
                uploadVideoBtn.textContent = 'Uploading...';

                try {
                    const timestamp = Date.now();
                    const sanitizedName = sanitizeFilename(file.name);
                    const filename = `room-videos/${timestamp}-${sanitizedName}`;
                    const fileRef = storageRef(storage, filename);
                    await uploadBytes(fileRef, file);
                    const downloadURL = await getDownloadURL(fileRef);
                    
                    roomVideo = {
                        url: downloadURL,
                        filename: filename
                    };
                    
                    videoPreview.innerHTML = `
                        <div style="position: relative; display: inline-block;">
                            <video src="${roomVideo.url}" controls style="max-width: 300px; border-radius: 8px;"></video>
                            <button class="btn" id="room-delete-video-btn" style="background: #d32f2f; margin-top: 0.5rem;">Delete Video</button>
                        </div>
                    `;
                    
                    document.getElementById('room-delete-video-btn').addEventListener('click', async () => {
                        if (confirm('Delete this video?')) {
                            try {
                                await deleteObject(storageRef(storage, roomVideo.filename));
                                roomVideo = null;
                                videoPreview.innerHTML = '';
                            } catch (error) {
                                console.error('Error deleting video:', error);
                                showErrorNotification('Failed to delete video.');
                            }
                        }
                    });
                    
                    e.target.value = '';
                } catch (error) {
                    console.error('Error uploading video:', error);
                    showErrorNotification('Failed to upload video.');
                } finally {
                    uploadVideoBtn.disabled = false;
                    uploadVideoBtn.textContent = 'Upload Video';
                }
            });

            // Delete video handler for existing video
            if (room && room.video) {
                document.getElementById('room-delete-video-btn')?.addEventListener('click', async () => {
                    if (confirm('Delete this video?')) {
                        try {
                            await deleteObject(storageRef(storage, roomVideo.filename));
                            roomVideo = null;
                            videoPreview.innerHTML = '';
                        } catch (error) {
                            console.error('Error deleting video:', error);
                            showErrorNotification('Failed to delete video.');
                        }
                    }
                });
            }

            // Close modal on background click
            document.getElementById('room-modal').addEventListener('click', (e) => {
                if (e.target.id === 'room-modal') {
                    closeRoomModal();
                }
            });

            // Cancel button
            document.getElementById('cancel-room-btn').addEventListener('click', closeRoomModal);

            // Save button
            document.getElementById('save-room-btn').addEventListener('click', async () => {
                const name_en = document.getElementById('room-name-en').value.trim();
                const name_nl = document.getElementById('room-name-nl').value.trim();
                const name_fr = document.getElementById('room-name-fr').value.trim();
                const bedType_en = document.getElementById('room-bedtype-en').value.trim();
                const bedType_nl = document.getElementById('room-bedtype-nl').value.trim();
                const bedType_fr = document.getElementById('room-bedtype-fr').value.trim();
                const description_en = document.getElementById('room-description-en').value.trim();
                const description_nl = document.getElementById('room-description-nl').value.trim();
                const description_fr = document.getElementById('room-description-fr').value.trim();
                const maxOccupancy = parseInt(document.getElementById('room-max-occupancy').value);
                const roomSize = parseFloat(document.getElementById('room-size').value);

                // Validation
                if (!name_en || !name_nl || !name_fr) {
                    showErrorNotification('Please fill in room name for all languages');
                    return;
                }
                if (!bedType_en || !bedType_nl || !bedType_fr) {
                    showErrorNotification('Please fill in bed type for all languages');
                    return;
                }
                if (!maxOccupancy || maxOccupancy < 1) {
                    showErrorNotification('Please enter a valid max occupancy');
                    return;
                }
                if (!roomSize || roomSize < 1) {
                    showErrorNotification('Please enter a valid room size');
                    return;
                }

                // Collect selected amenities
                const amenities = {};
                document.querySelectorAll('#room-amenities-list input[type="checkbox"]:checked').forEach(checkbox => {
                    amenities[checkbox.value] = true;
                });

                const roomData = {
                    name_en,
                    name_nl,
                    name_fr,
                    bedType_en,
                    bedType_nl,
                    bedType_fr,
                    description_en,
                    description_nl,
                    description_fr,
                    maxOccupancy,
                    roomSize,
                    amenities,
                    photos: roomPhotos,
                    status: room ? (room.status || 'available') : 'available',
                    ...(roomVideo && { video: roomVideo })
                };

                const saveBtn = document.getElementById('save-room-btn');
                saveBtn.disabled = true;
                saveBtn.textContent = 'Saving...';

                try {
                    const id = roomId || `room_${Date.now()}`;
                    await set(dbRef(database, `rooms/${id}`), roomData);
                    
                    await loadRoomsData();
                    renderRoomsList();
                    closeRoomModal();
                } catch (error) {
                    console.error('Error saving room:', error);
                    showErrorNotification('Failed to save room.');
                    saveBtn.disabled = false;
                    saveBtn.textContent = 'Save Room';
                }
            });

            function closeRoomModal() {
                document.getElementById('room-modal')?.remove();
                roomModalOpen = false;
            }
        }

        window.editRoom = function(roomId) {
            openRoomModal(roomId);
        };

        window.deleteRoom = async function(roomId) {
            if (!confirm('Are you sure you want to delete this room?')) return;

            try {
                const room = roomsData.find(r => r.id === roomId);
                
                // Delete photos from storage
                if (room.photos) {
                    for (const photo of room.photos) {
                        try {
                            await deleteObject(storageRef(storage, photo.filename));
                        } catch (error) {
                            console.error('Error deleting photo:', error);
                        }
                    }
                }
                
                // Delete video from storage
                if (room.video) {
                    try {
                        await deleteObject(storageRef(storage, room.video.filename));
                    } catch (error) {
                        console.error('Error deleting video:', error);
                    }
                }
                
                // Delete room from database
                await remove(dbRef(database, `rooms/${roomId}`));
                
                await loadRoomsData();
                renderRoomsList();
            } catch (error) {
                console.error('Error deleting room:', error);
                showErrorNotification('Failed to delete room.');
            }
        };

        window.toggleRoomStatus = async function(roomId) {
            try {
                const room = roomsData.find(r => r.id === roomId);
                if (!room) return;
                
                const currentStatus = room.status || 'available';
                const newStatus = currentStatus === 'available' ? 'offline' : 'available';
                
                // Update status in Firebase
                await set(dbRef(database, `rooms/${roomId}/status`), newStatus);
                
                // Update local data
                room.status = newStatus;
                
                // Re-render the list
                renderRoomsList();
            } catch (error) {
                console.error('Error toggling room status:', error);
                showErrorNotification('Failed to update room status.');
            }
        };

        // ============ MEETINGS MANAGEMENT ============
        let meetingsData = {};
        let meetingsPhotos = {};
        let currentMeetingLang = 'en';
        let editingMeetingId = null;
        let currentMeetingPhotoId = null;
        let meetingMainImage = null;
        let meetingDraft = null;

        function initializeMeetingDraft() {
            meetingDraft = {
                en: { name: '', description: '', setupStyles: '', facilities: '', food: '', parking: '', accommodation: '' },
                nl: { name: '', description: '', setupStyles: '', facilities: '', food: '', parking: '', accommodation: '' },
                fr: { name: '', description: '', setupStyles: '', facilities: '', food: '', parking: '', accommodation: '' }
            };
        }

        function syncMeetingDraft() {
            meetingDraft[currentMeetingLang] = {
                name: document.getElementById('meeting-name-input').value,
                description: document.getElementById('meeting-description-input').value,
                setupStyles: document.getElementById('meeting-setup-input').value,
                facilities: document.getElementById('meeting-facilities-input').value,
                food: document.getElementById('meeting-food-input').value,
                parking: document.getElementById('meeting-parking-input').value,
                accommodation: document.getElementById('meeting-accommodation-input').value
            };
        }

        function applyMeetingDraft(lang) {
            const draft = meetingDraft[lang];
            document.getElementById('meeting-name-input').value = draft.name || '';
            document.getElementById('meeting-description-input').value = draft.description || '';
            document.getElementById('meeting-setup-input').value = draft.setupStyles || '';
            document.getElementById('meeting-facilities-input').value = draft.facilities || '';
            document.getElementById('meeting-food-input').value = draft.food || '';
            document.getElementById('meeting-parking-input').value = draft.parking || '';
            document.getElementById('meeting-accommodation-input').value = draft.accommodation || '';
        }

        function updateMeetingLabels() {
            const labels = {
                en: {
                    name: 'Meeting Room Name (English)',
                    description: 'Description (English)',
                    setup: 'Setup Styles (English) - one per line',
                    facilities: 'Meeting Facilities (English) - one per line',
                    food: 'Food & Beverage (English)',
                    parking: 'Parking Option (English)',
                    accommodation: 'Overnight Accommodation (English)'
                },
                nl: {
                    name: 'Meeting Room Name (Nederlands)',
                    description: 'Description (Nederlands)',
                    setup: 'Setup Styles (Nederlands) - one per line',
                    facilities: 'Meeting Facilities (Nederlands) - one per line',
                    food: 'Food & Beverage (Nederlands)',
                    parking: 'Parking Option (Nederlands)',
                    accommodation: 'Overnight Accommodation (Nederlands)'
                },
                fr: {
                    name: 'Meeting Room Name (FranÃ§ais)',
                    description: 'Description (FranÃ§ais)',
                    setup: 'Setup Styles (FranÃ§ais) - one per line',
                    facilities: 'Meeting Facilities (FranÃ§ais) - one per line',
                    food: 'Food & Beverage (FranÃ§ais)',
                    parking: 'Parking Option (FranÃ§ais)',
                    accommodation: 'Overnight Accommodation (FranÃ§ais)'
                }
            };
            document.getElementById('meeting-name-label').textContent = labels[currentMeetingLang].name;
            document.getElementById('meeting-description-label').textContent = labels[currentMeetingLang].description;
            document.getElementById('meeting-setup-label').textContent = labels[currentMeetingLang].setup;
            document.getElementById('meeting-facilities-label').textContent = labels[currentMeetingLang].facilities;
            document.getElementById('meeting-food-label').textContent = labels[currentMeetingLang].food;
            document.getElementById('meeting-parking-label').textContent = labels[currentMeetingLang].parking;
            document.getElementById('meeting-accommodation-label').textContent = labels[currentMeetingLang].accommodation;
        }

        function parseListItems(value) {
            const trimmed = value.trim();
            if (!trimmed) return [];
            return trimmed.split('\n').map(line => line.trim()).filter(Boolean);
        }

        initializeMeetingDraft();

        // Show meetings management card
        document.getElementById('manage-meetings-btn').addEventListener('click', async () => {
            ensureDashboardVisible();
            hideAllManagementCards();
            
            const meetingsCard = document.getElementById('meetings-management-card');
            meetingsCard.style.display = 'block';
            meetingsCard.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            document.getElementById('vertical-menu').classList.remove('show');

            currentMeetingLang = 'en';
            document.querySelectorAll('.meeting-lang-tab').forEach(tab => {
                tab.classList.toggle('active', tab.dataset.lang === 'en');
            });
            updateMeetingLabels();
            initializeMeetingDraft();
            applyMeetingDraft(currentMeetingLang);

            await loadMeetingsData();
            await loadMeetingMainImage();
        });

        // Meeting language tab switching
        document.querySelectorAll('.meeting-lang-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                syncMeetingDraft();
                document.querySelectorAll('.meeting-lang-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                currentMeetingLang = tab.dataset.lang;
                updateMeetingLabels();
                applyMeetingDraft(currentMeetingLang);
            });
        });

        // Add/Save meeting room
        document.getElementById('add-meeting-btn').addEventListener('click', async () => {
            syncMeetingDraft();
            const nameEn = meetingDraft.en.name.trim();
            const nameNl = meetingDraft.nl.name.trim();
            const nameFr = meetingDraft.fr.name.trim();

            if (!nameEn && !nameNl && !nameFr) {
                showErrorNotification('Please enter a meeting room name in at least one language');
                return;
            }

            const timestamp = editingMeetingId ? meetingsData[editingMeetingId].timestamp : Date.now();
            const meetingId = editingMeetingId || `meeting_${timestamp}`;

            const meetingData = {
                name_en: nameEn,
                name_nl: nameNl,
                name_fr: nameFr,
                description_en: meetingDraft.en.description.trim(),
                description_nl: meetingDraft.nl.description.trim(),
                description_fr: meetingDraft.fr.description.trim(),
                setupStyles_en: parseListItems(meetingDraft.en.setupStyles),
                setupStyles_nl: parseListItems(meetingDraft.nl.setupStyles),
                setupStyles_fr: parseListItems(meetingDraft.fr.setupStyles),
                facilities_en: parseListItems(meetingDraft.en.facilities),
                facilities_nl: parseListItems(meetingDraft.nl.facilities),
                facilities_fr: parseListItems(meetingDraft.fr.facilities),
                food_en: meetingDraft.en.food.trim(),
                food_nl: meetingDraft.nl.food.trim(),
                food_fr: meetingDraft.fr.food.trim(),
                parking_en: meetingDraft.en.parking.trim(),
                parking_nl: meetingDraft.nl.parking.trim(),
                parking_fr: meetingDraft.fr.parking.trim(),
                accommodation_en: meetingDraft.en.accommodation.trim(),
                accommodation_nl: meetingDraft.nl.accommodation.trim(),
                accommodation_fr: meetingDraft.fr.accommodation.trim(),
                timestamp
            };

            try {
                await set(dbRef(database, `meetings/${meetingId}`), meetingData);
                initializeMeetingDraft();
                applyMeetingDraft(currentMeetingLang);
                editingMeetingId = null;
                document.getElementById('add-meeting-btn').textContent = 'Save Meeting Room';
                showSuccessNotification('Meeting room saved successfully!');
                await loadMeetingsData();
                currentMeetingPhotoId = meetingId;
                updateMeetingPhotoSelect();
                updateMeetingVideoSelect();
                await loadMeetingPhotos();
            } catch (error) {
                console.error('Error saving meeting room:', error);
                showErrorNotification('Failed to save meeting room. Please try again.');
            }
        });

        async function loadMeetingsData() {
            try {
                const snapshot = await get(dbRef(database, 'meetings'));
                meetingsData = snapshot.exists() ? snapshot.val() : {};
                renderMeetingsList();
                updateMeetingPhotoSelect();
                updateMeetingVideoSelect();
            } catch (error) {
                console.error('Error loading meetings:', error);
            }
        }

        function renderMeetingsList() {
            const container = document.getElementById('meeting-list');
            if (!container) return;

            if (!meetingsData || Object.keys(meetingsData).length === 0) {
                container.innerHTML = '<p style="color: var(--color-sage); text-align: center;">No meeting rooms added yet.</p>';
                return;
            }

            container.innerHTML = Object.keys(meetingsData).map(id => {
                const meeting = meetingsData[id];
                const nameEn = meeting.name_en || 'â€”';
                const nameNl = meeting.name_nl || 'â€”';
                const nameFr = meeting.name_fr || 'â€”';
                return `
                    <div class="meeting-item">
                        <div class="meeting-info">
                            <h4>${escapeHtml(nameEn)}</h4>
                            <p>NL: ${escapeHtml(nameNl)} | FR: ${escapeHtml(nameFr)}</p>
                        </div>
                        <div class="meeting-actions">
                            <button class="btn-edit-amenity" onclick="editMeeting('${id}')">Edit</button>
                            <button class="btn-delete-amenity" onclick="deleteMeeting('${id}')">Delete</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function updateMeetingPhotoSelect() {
            const select = document.getElementById('meeting-photo-select');
            if (!select) return;
            const status = document.getElementById('meeting-photo-status');

            if (!meetingsData || Object.keys(meetingsData).length === 0) {
                select.innerHTML = '<option value="">No meeting rooms available</option>';
                select.disabled = true;
                currentMeetingPhotoId = null;
                if (status) status.textContent = 'Add a meeting room to start uploading photos.';
                return;
            }

            select.disabled = false;
            const meetings = Object.keys(meetingsData).map(id => {
                const meeting = meetingsData[id];
                const name = meeting.name_en || meeting.name_nl || meeting.name_fr || 'Meeting Room';
                return { id, name };
            });

            if (!currentMeetingPhotoId || !meetingsData[currentMeetingPhotoId]) {
                currentMeetingPhotoId = meetings[0]?.id || null;
            }

            select.innerHTML = meetings.map(({ id, name }) => `
                <option value="${id}" ${id === currentMeetingPhotoId ? 'selected' : ''}>
                    ${escapeHtml(name)}
                </option>
            `).join('');

            if (status) {
                const activeName = meetings.find(({ id }) => id === currentMeetingPhotoId)?.name || 'this meeting room';
                status.textContent = `Uploading photos for ${activeName}.`;
            }
        }

        function updateMeetingVideoSelect() {
            const select = document.getElementById('meeting-video-select');
            if (!select) return;

            if (!meetingsData || Object.keys(meetingsData).length === 0) {
                select.innerHTML = '<option value="">No meeting rooms available</option>';
                select.disabled = true;
                return;
            }

            select.disabled = false;
            const meetings = Object.keys(meetingsData).map(id => {
                const meeting = meetingsData[id];
                const name = meeting.name_en || meeting.name_nl || meeting.name_fr || 'Meeting Room';
                return { id, name };
            });

            select.innerHTML = meetings.map(({ id, name }) => `
                <option value="${id}" ${id === currentMeetingPhotoId ? 'selected' : ''}>
                    ${escapeHtml(name)}
                </option>
            `).join('');
        }

        document.getElementById('meeting-photo-select').addEventListener('change', async (event) => {
            currentMeetingPhotoId = event.target.value || null;
            const status = document.getElementById('meeting-photo-status');
            if (status) {
                const meeting = currentMeetingPhotoId ? meetingsData[currentMeetingPhotoId] : null;
                const name = meeting ? (meeting.name_en || meeting.name_nl || meeting.name_fr || 'Meeting Room') : 'a meeting room';
                status.textContent = currentMeetingPhotoId ? `Uploading photos for ${name}.` : 'Select a meeting room to upload photos.';
            }
            await loadMeetingPhotos();
        });

        // Meeting photos upload
        document.getElementById('upload-meeting-photo-btn').addEventListener('click', () => {
            document.getElementById('meeting-photo-input').click();
        });

        document.getElementById('meeting-photo-input').addEventListener('change', async (e) => {
            const files = Array.from(e.target.files || []);
            if (!files.length) return;

            if (!currentMeetingPhotoId) {
                showErrorNotification('Please select a meeting room before uploading photos.');
                e.target.value = '';
                return;
            }

            const uploadBtn = document.getElementById('upload-meeting-photo-btn');
            uploadBtn.disabled = true;
            uploadBtn.textContent = 'Uploading...';

            try {
                let currentPhotos = meetingsPhotos[currentMeetingPhotoId] || [];
                let uploadCounter = 0;
                
                for (const file of files) {
                    if (!file.type.startsWith('image/')) continue;
                    const timestamp = Date.now() + uploadCounter;
                    uploadCounter += 1;
                    const sanitizedName = sanitizeFilename(file.name);
                    const filename = `meetings-photos/${currentMeetingPhotoId}/${timestamp}-${sanitizedName}`;
                    const fileRef = storageRef(storage, filename);
                    await uploadBytes(fileRef, file);
                    const downloadURL = await getDownloadURL(fileRef);
                    currentPhotos.push({
                        url: downloadURL,
                        filename,
                        timestamp,
                        order: currentPhotos.length
                    });
                }

                meetingsPhotos[currentMeetingPhotoId] = currentPhotos;
                await saveMeetingPhotos();
                await loadMeetingPhotos();
                e.target.value = '';
                showSuccessNotification('Photos uploaded successfully!');
            } catch (error) {
                console.error('Error uploading meeting photos:', error);
                showErrorNotification('Failed to upload photos.');
            } finally {
                uploadBtn.disabled = false;
                uploadBtn.textContent = 'Add Photos';
            }
        });

        async function loadMeetingPhotos() {
            try {
                if (!currentMeetingPhotoId) {
                    renderMeetingPhotos();
                    return;
                }
                const snapshot = await get(dbRef(database, `meetingsPhotos/${currentMeetingPhotoId}`));
                meetingsPhotos[currentMeetingPhotoId] = [];
                if (snapshot.exists()) {
                    meetingsPhotos[currentMeetingPhotoId] = Object.values(snapshot.val()).sort((a, b) => (a.order ?? 0) - (b.order ?? 0));
                }
                renderMeetingPhotos();
                renderMeetingVideoPreview();
            } catch (error) {
                console.error('Error loading meeting photos:', error);
            }
        }

        function renderMeetingPhotos() {
            const grid = document.getElementById('meeting-photo-grid');
            if (!grid) return;

            const photos = meetingsPhotos[currentMeetingPhotoId] || [];

            if (!currentMeetingPhotoId) {
                grid.innerHTML = '<p style="color: var(--color-sage);">Select a meeting room to manage its photo album.</p>';
                return;
            }

            if (photos.length === 0) {
                grid.innerHTML = '<p style="color: var(--color-sage);">No photos uploaded yet.</p>';
                return;
            }

            grid.innerHTML = '';
            photos.forEach((photo, index) => {
                const item = document.createElement('div');
                item.className = 'photo-item';
                item.draggable = true;
                item.dataset.index = index;
                item.innerHTML = `
                    <img src="${photo.url}" alt="Meeting room photo ${index + 1}">
                    <div class="photo-overlay">
                        <button class="btn-delete" onclick="deleteMeetingPhoto(${index})">Delete</button>
                    </div>
                `;
                item.addEventListener('dragstart', handleMeetingPhotoDragStart);
                item.addEventListener('dragover', handleDragOver);
                item.addEventListener('drop', handleMeetingPhotoDrop);
                item.addEventListener('dragend', handleMeetingPhotoDragEnd);
                grid.appendChild(item);
            });
        }

        let meetingPhotoDraggedIndex = null;

        function handleMeetingPhotoDragStart(e) {
            meetingPhotoDraggedIndex = parseInt(e.currentTarget.dataset.index);
            e.currentTarget.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
        }

        async function handleMeetingPhotoDrop(e) {
            e.stopPropagation();
            e.preventDefault();
            const dropIndex = parseInt(e.currentTarget.dataset.index);
            if (meetingPhotoDraggedIndex !== null && meetingPhotoDraggedIndex !== dropIndex) {
                await reorderMeetingPhotos(meetingPhotoDraggedIndex, dropIndex);
            }
        }

        function handleMeetingPhotoDragEnd(e) {
            e.currentTarget.classList.remove('dragging');
            meetingPhotoDraggedIndex = null;
            document.querySelectorAll('#meeting-photo-grid .photo-item').forEach(item => {
                item.classList.remove('drag-over');
            });
        }

        async function reorderMeetingPhotos(fromIndex, toIndex) {
            try {
                const photos = meetingsPhotos[currentMeetingPhotoId] || [];
                const [moved] = photos.splice(fromIndex, 1);
                photos.splice(toIndex, 0, moved);
                photos.forEach((photo, index) => { photo.order = index; });
                meetingsPhotos[currentMeetingPhotoId] = photos;
                await saveMeetingPhotos();
                renderMeetingPhotos();
            } catch (error) {
                console.error('Error reordering meeting photos:', error);
                showErrorNotification('Failed to reorder photos.');
            }
        }

        async function saveMeetingPhotos() {
            if (!currentMeetingPhotoId) return;
            const photos = meetingsPhotos[currentMeetingPhotoId] || [];
            const updates = {};
            photos.forEach(photo => { updates[photo.timestamp] = photo; });
            await set(dbRef(database, `meetingsPhotos/${currentMeetingPhotoId}`), updates);
        }

        window.deleteMeetingPhoto = async function(index) {
            if (!confirm('Are you sure you want to delete this photo?')) return;

            try {
                const photos = meetingsPhotos[currentMeetingPhotoId] || [];
                if (index < 0 || index >= photos.length) {
                    showErrorNotification('Invalid photo index.');
                    return;
                }
                const photo = photos[index];
                if (photo.filename) {
                    await deleteObject(storageRef(storage, photo.filename));
                }
                photos.splice(index, 1);
                photos.forEach((item, idx) => { item.order = idx; });
                meetingsPhotos[currentMeetingPhotoId] = photos;
                await saveMeetingPhotos();
                renderMeetingPhotos();
                showSuccessNotification('Photo deleted successfully!');
            } catch (error) {
                console.error('Error deleting meeting photo:', error);
                showErrorNotification('Failed to delete photo.');
            }
        };

        // Meeting video upload
        document.getElementById('upload-meeting-video-btn').addEventListener('click', () => {
            document.getElementById('meeting-video-input').click();
        });

        document.getElementById('meeting-video-input').addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if (!file) return;

            const meetingId = document.getElementById('meeting-video-select').value;
            if (!meetingId) {
                showErrorNotification('Please select a meeting room before uploading a video.');
                e.target.value = '';
                return;
            }

            if (!file.type.startsWith('video/')) {
                showErrorNotification('Please select a video file');
                return;
            }

            const uploadBtn = document.getElementById('upload-meeting-video-btn');
            uploadBtn.disabled = true;
            uploadBtn.textContent = 'Uploading...';

            try {
                const timestamp = Date.now();
                const sanitizedName = sanitizeFilename(file.name);
                const filename = `meetings-videos/${meetingId}/${timestamp}-${sanitizedName}`;
                const fileRef = storageRef(storage, filename);
                await uploadBytes(fileRef, file);
                const downloadURL = await getDownloadURL(fileRef);

                meetingsData[meetingId].video = {
                    url: downloadURL,
                    filename
                };

                await set(dbRef(database, `meetings/${meetingId}/video`), meetingsData[meetingId].video);
                renderMeetingVideoPreview();
                e.target.value = '';
                showSuccessNotification('Video uploaded successfully!');
            } catch (error) {
                console.error('Error uploading meeting video:', error);
                showErrorNotification('Failed to upload video.');
            } finally {
                uploadBtn.disabled = false;
                uploadBtn.textContent = 'Upload Video';
            }
        });

        document.getElementById('meeting-video-select').addEventListener('change', () => {
            renderMeetingVideoPreview();
        });

        function renderMeetingVideoPreview() {
            const preview = document.getElementById('meeting-video-preview');
            const meetingId = document.getElementById('meeting-video-select').value;
            if (!preview || !meetingId) {
                if (preview) preview.innerHTML = '';
                return;
            }

            const meeting = meetingsData[meetingId];
            if (meeting && meeting.video && meeting.video.url) {
                preview.innerHTML = `
                    <div style="position: relative; display: inline-block; margin-top: 1rem;">
                        <video src="${meeting.video.url}" controls style="max-width: 400px; border-radius: 8px;"></video>
                        <button class="btn" onclick="deleteMeetingVideo('${meetingId}')" style="background: #d32f2f; margin-top: 0.5rem; display: block;">Delete Video</button>
                    </div>
                `;
            } else {
                preview.innerHTML = '<p style="color: var(--color-sage); margin-top: 1rem;">No video uploaded for this meeting room.</p>';
            }
        }

        window.deleteMeetingVideo = async function(meetingId) {
            if (!confirm('Are you sure you want to delete this video?')) return;

            try {
                const meeting = meetingsData[meetingId];
                if (meeting && meeting.video && meeting.video.filename) {
                    await deleteObject(storageRef(storage, meeting.video.filename));
                }
                await remove(dbRef(database, `meetings/${meetingId}/video`));
                delete meetingsData[meetingId].video;
                renderMeetingVideoPreview();
                showSuccessNotification('Video deleted successfully!');
            } catch (error) {
                console.error('Error deleting meeting video:', error);
                showErrorNotification('Failed to delete video.');
            }
        };

        // Meeting main image
        document.getElementById('upload-meeting-main-image-btn').addEventListener('click', () => {
            document.getElementById('meeting-main-image-input').click();
        });

        document.getElementById('meeting-main-image-input').addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if (!file) return;

            if (!file.type.startsWith('image/')) {
                showErrorNotification('Please select an image file');
                return;
            }

            const uploadBtn = document.getElementById('upload-meeting-main-image-btn');
            uploadBtn.disabled = true;
            uploadBtn.textContent = 'Uploading...';

            try {
                if (meetingMainImage && meetingMainImage.filename) {
                    try {
                        await deleteObject(storageRef(storage, meetingMainImage.filename));
                    } catch (deleteError) {
                        console.warn('Failed to delete old meeting main image:', deleteError?.message || 'Unknown error');
                    }
                }

                const timestamp = Date.now();
                const sanitizedName = sanitizeFilename(file.name);
                const filename = `meetings-main/${timestamp}-${sanitizedName}`;
                const fileRef = storageRef(storage, filename);

                await uploadBytes(fileRef, file);
                const downloadURL = await getDownloadURL(fileRef);

                meetingMainImage = {
                    url: downloadURL,
                    filename,
                    timestamp
                };

                await set(dbRef(database, 'meetingsMainImage'), meetingMainImage);
                await loadMeetingMainImage();

                e.target.value = '';
                showSuccessNotification('Meetings main image uploaded successfully!');
            } catch (error) {
                console.error('Error uploading meetings main image:', error);
                showErrorNotification('Failed to upload main image.');
            } finally {
                uploadBtn.disabled = false;
                uploadBtn.textContent = 'Upload Main Image';
            }
        });

        async function loadMeetingMainImage() {
            try {
                const snapshot = await get(dbRef(database, 'meetingsMainImage'));
                meetingMainImage = snapshot.exists() ? snapshot.val() : null;
                const preview = document.getElementById('meeting-main-image-preview');
                if (!preview) return;

                if (meetingMainImage && meetingMainImage.url) {
                    preview.innerHTML = `
                        <div class="photo-item">
                            <img src="${meetingMainImage.url}" alt="Meetings main image">
                            <div class="photo-overlay">
                                <button class="btn-delete" onclick="deleteMeetingMainImage()">Delete</button>
                            </div>
                        </div>
                    `;
                } else {
                    preview.innerHTML = '<p style="color: var(--color-sage);">No main image uploaded.</p>';
                }
            } catch (error) {
                console.error('Error loading meetings main image:', error);
            }
        }

        window.deleteMeetingMainImage = async function() {
            if (!confirm('Are you sure you want to delete the main image?')) return;

            try {
                if (meetingMainImage && meetingMainImage.filename) {
                    await deleteObject(storageRef(storage, meetingMainImage.filename));
                }
                await remove(dbRef(database, 'meetingsMainImage'));
                meetingMainImage = null;
                await loadMeetingMainImage();
                showSuccessNotification('Main image deleted successfully!');
            } catch (error) {
                console.error('Error deleting meetings main image:', error);
                showErrorNotification('Failed to delete main image.');
            }
        };

        window.editMeeting = function(meetingId) {
            editingMeetingId = meetingId;
            const meeting = meetingsData[meetingId];

            // Populate draft with meeting data
            meetingDraft = {
                en: {
                    name: meeting.name_en || '',
                    description: meeting.description_en || '',
                    setupStyles: (meeting.setupStyles_en || []).join('\n'),
                    facilities: (meeting.facilities_en || []).join('\n'),
                    food: meeting.food_en || '',
                    parking: meeting.parking_en || '',
                    accommodation: meeting.accommodation_en || ''
                },
                nl: {
                    name: meeting.name_nl || '',
                    description: meeting.description_nl || '',
                    setupStyles: (meeting.setupStyles_nl || []).join('\n'),
                    facilities: (meeting.facilities_nl || []).join('\n'),
                    food: meeting.food_nl || '',
                    parking: meeting.parking_nl || '',
                    accommodation: meeting.accommodation_nl || ''
                },
                fr: {
                    name: meeting.name_fr || '',
                    description: meeting.description_fr || '',
                    setupStyles: (meeting.setupStyles_fr || []).join('\n'),
                    facilities: (meeting.facilities_fr || []).join('\n'),
                    food: meeting.food_fr || '',
                    parking: meeting.parking_fr || '',
                    accommodation: meeting.accommodation_fr || ''
                }
            };

            applyMeetingDraft(currentMeetingLang);
            document.getElementById('add-meeting-btn').textContent = 'Update Meeting Room';
            document.querySelector('.meeting-add-section').scrollIntoView({ behavior: 'smooth', block: 'start' });
        };

        window.deleteMeeting = async function(meetingId) {
            if (!confirm('Are you sure you want to delete this meeting room?')) return;

            try {
                // Delete photos from storage
                const photosSnapshot = await get(dbRef(database, `meetingsPhotos/${meetingId}`));
                if (photosSnapshot.exists()) {
                    await Promise.all(Object.values(photosSnapshot.val()).map(async (photo) => {
                        if (photo?.filename) {
                            try {
                                await deleteObject(storageRef(storage, photo.filename));
                            } catch (deleteError) {
                                console.warn('Failed to delete meeting photo:', deleteError?.message || 'Unknown error');
                            }
                        }
                    }));
                }

                // Delete video from storage
                const meeting = meetingsData[meetingId];
                if (meeting && meeting.video && meeting.video.filename) {
                    try {
                        await deleteObject(storageRef(storage, meeting.video.filename));
                    } catch (deleteError) {
                        console.warn('Failed to delete meeting video:', deleteError?.message || 'Unknown error');
                    }
                }

                // Delete from database
                await set(dbRef(database, `meetings/${meetingId}`), null);
                await set(dbRef(database, `meetingsPhotos/${meetingId}`), null);

                if (currentMeetingPhotoId === meetingId) {
                    currentMeetingPhotoId = null;
                }

                showSuccessNotification('Meeting room deleted successfully!');
                await loadMeetingsData();
                await loadMeetingPhotos();
            } catch (error) {
                console.error('Error deleting meeting room:', error);
                showErrorNotification('Failed to delete meeting room.');
            }
        };

        // ============ ATTRACTIONS MANAGEMENT ============
        let attractionsData = {};
        let currentAttractionLang = 'en';
        let editingAttractionId = null;
        let attractionDraft = null;
        let attractionImageTemp = null;

        function initializeAttractionDraft() {
            attractionDraft = {
                en: { title: '', description: '' },
                nl: { title: '', description: '' },
                fr: { title: '', description: '' }
            };
            attractionImageTemp = null;
        }

        function syncAttractionDraft() {
            attractionDraft[currentAttractionLang] = {
                title: document.getElementById('attraction-title-input').value,
                description: document.getElementById('attraction-description-input').value
            };
        }

        function applyAttractionDraft(lang) {
            const draft = attractionDraft[lang];
            document.getElementById('attraction-title-input').value = draft.title || '';
            document.getElementById('attraction-description-input').value = draft.description || '';
        }

        function updateAttractionLabels() {
            const labels = {
                en: { title: 'Attraction Title (English)', description: 'Description (English)' },
                nl: { title: 'Attraction Title (Nederlands)', description: 'Description (Nederlands)' },
                fr: { title: 'Attraction Title (FranÃ§ais)', description: 'Description (FranÃ§ais)' }
            };
            document.getElementById('attraction-title-label').textContent = labels[currentAttractionLang].title;
            document.getElementById('attraction-description-label').textContent = labels[currentAttractionLang].description;
        }

        initializeAttractionDraft();

        // Show attractions management card
        document.getElementById('manage-attractions-btn').addEventListener('click', async () => {
            ensureDashboardVisible();
            hideAllManagementCards();
            
            const attractionsCard = document.getElementById('attractions-management-card');
            attractionsCard.style.display = 'block';
            attractionsCard.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            document.getElementById('vertical-menu').classList.remove('show');

            currentAttractionLang = 'en';
            document.querySelectorAll('.attraction-lang-tab').forEach(tab => {
                tab.classList.toggle('active', tab.dataset.lang === 'en');
            });
            updateAttractionLabels();
            initializeAttractionDraft();
            applyAttractionDraft(currentAttractionLang);
            document.getElementById('attraction-link-input').value = '';
            document.getElementById('attraction-image-preview').innerHTML = '';

            await loadAttractionsData();
            await loadAttractionsMainImage();
        });

        // Attraction language tab switching
        document.querySelectorAll('.attraction-lang-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                syncAttractionDraft();
                document.querySelectorAll('.attraction-lang-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                currentAttractionLang = tab.dataset.lang;
                updateAttractionLabels();
                applyAttractionDraft(currentAttractionLang);
            });
        });

        // Upload attraction image
        document.getElementById('upload-attraction-image-btn').addEventListener('click', () => {
            document.getElementById('attraction-image-input').click();
        });

        document.getElementById('attraction-image-input').addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if (!file) return;

            if (!file.type.startsWith('image/')) {
                showErrorNotification('Please select an image file');
                return;
            }

            const uploadBtn = document.getElementById('upload-attraction-image-btn');
            uploadBtn.disabled = true;
            uploadBtn.textContent = 'Uploading...';

            try {
                const timestamp = Date.now();
                const sanitizedName = sanitizeFilename(file.name);
                const filename = `attractions/${timestamp}-${sanitizedName}`;
                const fileRef = storageRef(storage, filename);
                await uploadBytes(fileRef, file);
                const downloadURL = await getDownloadURL(fileRef);

                attractionImageTemp = {
                    url: downloadURL,
                    filename
                };

                document.getElementById('attraction-image-preview').innerHTML = `
                    <img src="${attractionImageTemp.url}" style="max-width: 300px; display: block; margin-top: 0.5rem; border-radius: 4px;">
                `;

                e.target.value = '';
            } catch (error) {
                console.error('Error uploading attraction image:', error);
                showErrorNotification('Failed to upload image.');
            } finally {
                uploadBtn.disabled = false;
                uploadBtn.textContent = 'Upload Image';
            }
        });

        // Add/Save attraction
        document.getElementById('add-attraction-btn').addEventListener('click', async () => {
            syncAttractionDraft();
            const titleEn = attractionDraft.en.title.trim();
            const titleNl = attractionDraft.nl.title.trim();
            const titleFr = attractionDraft.fr.title.trim();

            if (!titleEn && !titleNl && !titleFr) {
                showErrorNotification('Please enter an attraction title in at least one language');
                return;
            }

            const timestamp = editingAttractionId ? attractionsData[editingAttractionId].timestamp : Date.now();
            const attractionId = editingAttractionId || `attraction_${timestamp}`;
            const link = document.getElementById('attraction-link-input').value.trim();

            // Handle image: use temp image if uploaded, otherwise keep existing
            let imageData = attractionImageTemp;
            if (!imageData && editingAttractionId && attractionsData[editingAttractionId]) {
                imageData = attractionsData[editingAttractionId].image;
            }

            const attractionData = {
                title_en: titleEn,
                title_nl: titleNl,
                title_fr: titleFr,
                description_en: attractionDraft.en.description.trim(),
                description_nl: attractionDraft.nl.description.trim(),
                description_fr: attractionDraft.fr.description.trim(),
                link,
                image: imageData || null,
                timestamp
            };

            try {
                await set(dbRef(database, `attractions/${attractionId}`), attractionData);
                initializeAttractionDraft();
                applyAttractionDraft(currentAttractionLang);
                editingAttractionId = null;
                document.getElementById('attraction-link-input').value = '';
                document.getElementById('attraction-image-preview').innerHTML = '';
                document.getElementById('add-attraction-btn').textContent = 'Save Attraction';
                showSuccessNotification('Attraction saved successfully!');
                await loadAttractionsData();
            } catch (error) {
                console.error('Error saving attraction:', error);
                showErrorNotification('Failed to save attraction. Please try again.');
            }
        });

        async function loadAttractionsData() {
            try {
                const snapshot = await get(dbRef(database, 'attractions'));
                attractionsData = snapshot.exists() ? snapshot.val() : {};
                renderAttractionsList();
            } catch (error) {
                console.error('Error loading attractions:', error);
            }
        }

        function renderAttractionsList() {
            const container = document.getElementById('attraction-list');
            if (!container) return;

            if (!attractionsData || Object.keys(attractionsData).length === 0) {
                container.innerHTML = '<p style="color: var(--color-sage); text-align: center;">No attractions added yet.</p>';
                return;
            }

            container.innerHTML = Object.keys(attractionsData).map(id => {
                const attraction = attractionsData[id];
                const titleEn = attraction.title_en || 'â€”';
                const titleNl = attraction.title_nl || 'â€”';
                const titleFr = attraction.title_fr || 'â€”';
                const imageUrl = attraction.image?.url || '';
                return `
                    <div class="attraction-item">
                        ${imageUrl ? `<img src="${imageUrl}" alt="${escapeHtml(titleEn)}" class="attraction-thumbnail">` : ''}
                        <div class="attraction-info">
                            <h4>${escapeHtml(titleEn)}</h4>
                            <p>NL: ${escapeHtml(titleNl)} | FR: ${escapeHtml(titleFr)}</p>
                            ${attraction.link ? `<p style="font-size: 0.85rem; color: var(--color-sage);">Link: ${escapeHtml(attraction.link)}</p>` : ''}
                        </div>
                        <div class="attraction-actions">
                            <button class="btn-edit-amenity" onclick="editAttraction('${id}')">Edit</button>
                            <button class="btn-delete-amenity" onclick="deleteAttraction('${id}')">Delete</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        window.editAttraction = function(attractionId) {
            editingAttractionId = attractionId;
            const attraction = attractionsData[attractionId];

            attractionDraft = {
                en: { title: attraction.title_en || '', description: attraction.description_en || '' },
                nl: { title: attraction.title_nl || '', description: attraction.description_nl || '' },
                fr: { title: attraction.title_fr || '', description: attraction.description_fr || '' }
            };

            applyAttractionDraft(currentAttractionLang);
            document.getElementById('attraction-link-input').value = attraction.link || '';
            
            if (attraction.image && attraction.image.url) {
                attractionImageTemp = attraction.image;
                document.getElementById('attraction-image-preview').innerHTML = `
                    <img src="${attraction.image.url}" style="max-width: 300px; display: block; margin-top: 0.5rem; border-radius: 4px;">
                `;
            } else {
                attractionImageTemp = null;
                document.getElementById('attraction-image-preview').innerHTML = '';
            }

            document.getElementById('add-attraction-btn').textContent = 'Update Attraction';
            document.querySelector('.attraction-add-section').scrollIntoView({ behavior: 'smooth', block: 'start' });
        };

        window.deleteAttraction = async function(attractionId) {
            if (!confirm('Are you sure you want to delete this attraction?')) return;

            try {
                const attraction = attractionsData[attractionId];
                
                // Delete image from storage
                if (attraction && attraction.image && attraction.image.filename) {
                    try {
                        await deleteObject(storageRef(storage, attraction.image.filename));
                    } catch (deleteError) {
                        console.warn('Failed to delete attraction image:', deleteError?.message || 'Unknown error');
                    }
                }

                // Delete from database
                await set(dbRef(database, `attractions/${attractionId}`), null);

                showSuccessNotification('Attraction deleted successfully!');
                await loadAttractionsData();
            } catch (error) {
                console.error('Error deleting attraction:', error);
                showErrorNotification('Failed to delete attraction.');
            }
        };

        // ============ ATTRACTIONS MAIN IMAGE ============
        let attractionsMainImage = null;

        async function loadAttractionsMainImage() {
            try {
                const snapshot = await get(dbRef(database, 'attractionsMainImage'));
                if (snapshot.exists()) {
                    attractionsMainImage = snapshot.val();
                    renderAttractionsMainImagePreview();
                } else {
                    attractionsMainImage = null;
                    const preview = document.getElementById('attraction-main-image-preview');
                    if (preview) preview.innerHTML = '';
                }
            } catch (error) {
                console.error('Error loading attractions main image:', error);
            }
        }

        function renderAttractionsMainImagePreview() {
            const preview = document.getElementById('attraction-main-image-preview');
            if (!preview) return;

            if (attractionsMainImage && attractionsMainImage.url) {
                preview.innerHTML = `
                    <div style="position: relative; display: inline-block; margin-top: 1rem;">
                        <img src="${attractionsMainImage.url}" style="max-width: 100%; max-height: 300px; display: block; border-radius: 4px;">
                        <button onclick="deleteAttractionsMainImage()" style="position: absolute; top: 0.5rem; right: 0.5rem; background: rgba(255,0,0,0.8); color: white; border: none; border-radius: 50%; width: 30px; height: 30px; cursor: pointer; font-size: 1.2rem;">&times;</button>
                    </div>
                `;
            } else {
                preview.innerHTML = '';
            }
        }

        document.getElementById('upload-attraction-main-image-btn').addEventListener('click', () => {
            document.getElementById('attraction-main-image-input').click();
        });

        document.getElementById('attraction-main-image-input').addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if (!file) return;

            if (!file.type.startsWith('image/')) {
                showErrorNotification('Please select an image file');
                return;
            }

            const uploadBtn = document.getElementById('upload-attraction-main-image-btn');
            uploadBtn.disabled = true;
            uploadBtn.textContent = 'Uploading...';

            try {
                // Delete old image if exists
                if (attractionsMainImage && attractionsMainImage.filename) {
                    try {
                        await deleteObject(storageRef(storage, attractionsMainImage.filename));
                    } catch (deleteError) {
                        console.warn('Failed to delete old attractions main image:', deleteError?.message || 'Unknown error');
                    }
                }

                const timestamp = Date.now();
                const sanitizedName = sanitizeFilename(file.name);
                const filename = `attractions-main/${timestamp}-${sanitizedName}`;
                const fileRef = storageRef(storage, filename);
                await uploadBytes(fileRef, file);
                const downloadURL = await getDownloadURL(fileRef);

                const imageData = {
                    url: downloadURL,
                    filename,
                    timestamp
                };

                await set(dbRef(database, 'attractionsMainImage'), imageData);
                attractionsMainImage = imageData;
                renderAttractionsMainImagePreview();

                e.target.value = '';
                showSuccessNotification('Attractions main image uploaded successfully!');
            } catch (error) {
                console.error('Error uploading attractions main image:', error);
                showErrorNotification('Failed to upload image.');
            } finally {
                uploadBtn.disabled = false;
                uploadBtn.textContent = 'Upload Main Image';
            }
        });

        window.deleteAttractionsMainImage = async function() {
            if (!confirm('Are you sure you want to delete the attractions main image?')) return;

            try {
                if (attractionsMainImage && attractionsMainImage.filename) {
                    try {
                        await deleteObject(storageRef(storage, attractionsMainImage.filename));
                    } catch (deleteError) {
                        console.warn('Failed to delete attractions main image:', deleteError?.message || 'Unknown error');
                    }
                }

                await set(dbRef(database, 'attractionsMainImage'), null);
                attractionsMainImage = null;
                renderAttractionsMainImagePreview();

                showSuccessNotification('Attractions main image deleted successfully!');
            } catch (error) {
                console.error('Error deleting attractions main image:', error);
                showErrorNotification('Failed to delete image.');
            }
        };

        // ============ ROOMS MAIN IMAGE MANAGEMENT ============
        let roomsMainImage = null;

        // Upload rooms main image
        document.getElementById('upload-rooms-main-image-btn').addEventListener('click', () => {
            document.getElementById('rooms-main-image-input').click();
        });

        document.getElementById('rooms-main-image-input').addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if (!file) return;

            if (!file.type.startsWith('image/')) {
                showErrorNotification('Please select an image file');
                return;
            }

            const uploadBtn = document.getElementById('upload-rooms-main-image-btn');
            uploadBtn.disabled = true;
            uploadBtn.textContent = 'Uploading...';

            try {
                // Delete old image if exists
                if (roomsMainImage && roomsMainImage.filename) {
                    try {
                        await deleteObject(storageRef(storage, roomsMainImage.filename));
                    } catch (deleteError) {
                        console.warn('Failed to delete old rooms main image:', deleteError?.message || 'Unknown error');
                    }
                }

                const timestamp = Date.now();
                const sanitizedName = sanitizeFilename(file.name);
                const filename = `rooms-main/${timestamp}-${sanitizedName}`;
                const fileRef = storageRef(storage, filename);
                await uploadBytes(fileRef, file);
                const downloadURL = await getDownloadURL(fileRef);

                const imageData = {
                    url: downloadURL,
                    filename,
                    timestamp
                };

                await set(dbRef(database, 'roomsMainImage'), imageData);
                roomsMainImage = imageData;
                await loadRoomsMainImage();

                e.target.value = '';
                showSuccessNotification('Rooms main image uploaded successfully!');
            } catch (error) {
                console.error('Error uploading rooms main image:', error);
                showErrorNotification('Failed to upload image.');
            } finally {
                uploadBtn.disabled = false;
                uploadBtn.textContent = 'Upload Main Image';
            }
        });

        async function loadRoomsMainImage() {
            try {
                const snapshot = await get(dbRef(database, 'roomsMainImage'));
                roomsMainImage = snapshot.exists() ? snapshot.val() : null;
                const preview = document.getElementById('rooms-main-image-preview');
                if (!preview) return;

                if (roomsMainImage && roomsMainImage.url) {
                    preview.innerHTML = `
                        <div class="photo-item">
                            <img src="${roomsMainImage.url}" alt="Rooms main image">
                            <div class="photo-overlay">
                                <button class="btn-delete" onclick="deleteRoomsMainImage()">Delete</button>
                            </div>
                        </div>
                    `;
                } else {
                    preview.innerHTML = '<p style="color: var(--color-sage);">No main image uploaded.</p>';
                }
            } catch (error) {
                console.error('Error loading rooms main image:', error);
            }
        }

        window.deleteRoomsMainImage = async function() {
            if (!confirm('Are you sure you want to delete the rooms main image?')) return;

            try {
                if (roomsMainImage && roomsMainImage.filename) {
                    await deleteObject(storageRef(storage, roomsMainImage.filename));
                }
                await set(dbRef(database, 'roomsMainImage'), null);
                roomsMainImage = null;
                await loadRoomsMainImage();
                showSuccessNotification('Rooms main image deleted successfully!');
            } catch (error) {
                console.error('Error deleting rooms main image:', error);
                showErrorNotification('Failed to delete image.');
            }
        };

        // ============ INFO MAIN IMAGE MANAGEMENT ============
        let infoMainImage = null;

        // Upload info main image
        document.getElementById('upload-info-main-image-btn').addEventListener('click', () => {
            document.getElementById('info-main-image-input').click();
        });

        document.getElementById('info-main-image-input').addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if (!file) return;

            if (!file.type.startsWith('image/')) {
                showErrorNotification('Please select an image file');
                return;
            }

            const uploadBtn = document.getElementById('upload-info-main-image-btn');
            uploadBtn.disabled = true;
            uploadBtn.textContent = 'Uploading...';

            try {
                // Delete old image if exists
                if (infoMainImage && infoMainImage.filename) {
                    try {
                        await deleteObject(storageRef(storage, infoMainImage.filename));
                    } catch (deleteError) {
                        console.warn('Failed to delete old info main image:', deleteError?.message || 'Unknown error');
                    }
                }

                const timestamp = Date.now();
                const sanitizedName = sanitizeFilename(file.name);
                const filename = `info-main/${timestamp}-${sanitizedName}`;
                const fileRef = storageRef(storage, filename);
                await uploadBytes(fileRef, file);
                const downloadURL = await getDownloadURL(fileRef);

                const imageData = {
                    url: downloadURL,
                    filename,
                    timestamp
                };

                await set(dbRef(database, 'infoMainImage'), imageData);
                infoMainImage = imageData;
                await loadInfoMainImage();

                e.target.value = '';
                showSuccessNotification('Info main image uploaded successfully!');
            } catch (error) {
                console.error('Error uploading info main image:', error);
                showErrorNotification('Failed to upload image.');
            } finally {
                uploadBtn.disabled = false;
                uploadBtn.textContent = 'Upload Main Image';
            }
        });

        async function loadInfoMainImage() {
            try {
                const snapshot = await get(dbRef(database, 'infoMainImage'));
                infoMainImage = snapshot.exists() ? snapshot.val() : null;
                const preview = document.getElementById('info-main-image-preview');
                if (!preview) return;

                if (infoMainImage && infoMainImage.url) {
                    preview.innerHTML = `
                        <div class="photo-item">
                            <img src="${infoMainImage.url}" alt="Info main image">
                            <div class="photo-overlay">
                                <button class="btn-delete" onclick="deleteInfoMainImage()">Delete</button>
                            </div>
                        </div>
                    `;
                } else {
                    preview.innerHTML = '<p style="color: var(--color-sage);">No main image uploaded.</p>';
                }
            } catch (error) {
                console.error('Error loading info main image:', error);
            }
        }

        window.deleteInfoMainImage = async function() {
            if (!confirm('Are you sure you want to delete the info main image?')) return;

            try {
                if (infoMainImage && infoMainImage.filename) {
                    await deleteObject(storageRef(storage, infoMainImage.filename));
                }
                await set(dbRef(database, 'infoMainImage'), null);
                infoMainImage = null;
                await loadInfoMainImage();
                showSuccessNotification('Info main image deleted successfully!');
            } catch (error) {
                console.error('Error deleting info main image:', error);
                showErrorNotification('Failed to delete image.');
            }
        };

        // ============ GROUP REQUEST MAIN IMAGE MANAGEMENT ============
        let groupMainImage = null;

        // Upload group request main image
        document.getElementById('upload-group-main-image-btn').addEventListener('click', () => {
            document.getElementById('group-main-image-input').click();
        });

        document.getElementById('group-main-image-input').addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if (!file) return;

            if (!file.type.startsWith('image/')) {
                showErrorNotification('Please select an image file');
                return;
            }

            const uploadBtn = document.getElementById('upload-group-main-image-btn');
            uploadBtn.disabled = true;
            uploadBtn.textContent = 'Uploading...';

            try {
                // Delete old image if exists
                if (groupMainImage && groupMainImage.filename) {
                    try {
                        await deleteObject(storageRef(storage, groupMainImage.filename));
                    } catch (deleteError) {
                        console.warn('Failed to delete old group main image:', deleteError?.message || 'Unknown error');
                    }
                }

                const timestamp = Date.now();
                const sanitizedName = sanitizeFilename(file.name);
                const filename = `group-main/${timestamp}-${sanitizedName}`;
                const fileRef = storageRef(storage, filename);
                await uploadBytes(fileRef, file);
                const downloadURL = await getDownloadURL(fileRef);

                const imageData = {
                    url: downloadURL,
                    filename,
                    timestamp
                };

                await set(dbRef(database, 'groupMainImage'), imageData);
                groupMainImage = imageData;
                await loadGroupMainImage();

                e.target.value = '';
                showSuccessNotification('Group request main image uploaded successfully!');
            } catch (error) {
                console.error('Error uploading group main image:', error);
                showErrorNotification('Failed to upload image.');
            } finally {
                uploadBtn.disabled = false;
                uploadBtn.textContent = 'Upload Main Image';
            }
        });

        async function loadGroupMainImage() {
            try {
                const snapshot = await get(dbRef(database, 'groupMainImage'));
                groupMainImage = snapshot.exists() ? snapshot.val() : null;
                const preview = document.getElementById('group-main-image-preview');
                if (!preview) return;

                if (groupMainImage && groupMainImage.url) {
                    preview.innerHTML = `
                        <div class="photo-item">
                            <img src="${groupMainImage.url}" alt="Group request main image">
                            <div class="photo-overlay">
                                <button class="btn-delete" onclick="deleteGroupMainImage()">Delete</button>
                            </div>
                        </div>
                    `;
                } else {
                    preview.innerHTML = '<p style="color: var(--color-sage);">No main image uploaded.</p>';
                }
            } catch (error) {
                console.error('Error loading group main image:', error);
            }
        }

        window.deleteGroupMainImage = async function() {
            if (!confirm('Are you sure you want to delete the group request main image?')) return;

            try {
                if (groupMainImage && groupMainImage.filename) {
                    await deleteObject(storageRef(storage, groupMainImage.filename));
                }
                await set(dbRef(database, 'groupMainImage'), null);
                groupMainImage = null;
                await loadGroupMainImage();
                showSuccessNotification('Group request main image deleted successfully!');
            } catch (error) {
                console.error('Error deleting group main image:', error);
                showErrorNotification('Failed to delete image.');
            }
        };

        // ============ INFO MANAGEMENT ============
        let currentInfoTab = 'checkin';
        let currentInfoLang = 'en';
        let infoData = {
            checkin: { en: '', nl: '', fr: '', lineSpacing: '1.6' },
            checkout: { en: '', nl: '', fr: '', lineSpacing: '1.6' },
            breakfast: { en: '', nl: '', fr: '', lineSpacing: '1.6' },
            payment: { en: '', nl: '', fr: '', lineSpacing: '1.6' },
            services: { en: '', nl: '', fr: '', lineSpacing: '1.6' },
            general: { en: '', nl: '', fr: '', lineSpacing: '1.6' },
            parking: { en: '', nl: '', fr: '', lineSpacing: '1.6' },
            traffic: { en: '', nl: '', fr: '', lineSpacing: '1.6' },
            camera: { en: '', nl: '', fr: '', lineSpacing: '1.6' }
        };

        // Show info management card
        document.getElementById('manage-info-btn').addEventListener('click', async () => {
            ensureDashboardVisible();
            hideAllManagementCards();
            
            const infoCard = document.getElementById('info-management-card');
            infoCard.style.display = 'block';
            infoCard.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            document.getElementById('vertical-menu').classList.remove('show');

            await loadInfoData();
            renderInfoTab();
        });

        // Tab switching
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('info-tab')) {
                document.querySelectorAll('.info-tab').forEach(tab => tab.classList.remove('active'));
                e.target.classList.add('active');
                currentInfoTab = e.target.dataset.tab;
                renderInfoTab();
            }
            
            if (e.target.classList.contains('info-lang-tab')) {
                document.querySelectorAll('.info-lang-tab').forEach(tab => tab.classList.remove('active'));
                e.target.classList.add('active');
                currentInfoLang = e.target.dataset.lang;
                renderInfoTab();
            }
        });

        // Load Info data from Firebase
        async function loadInfoData() {
            try {
                const snapshot = await get(dbRef(database, 'hotelInfo'));
                
                if (snapshot.exists()) {
                    infoData = snapshot.val();
                }
            } catch (error) {
                console.error('Error loading Info data:', error);
            }
        }

        // Get title for each tab
        function getInfoTabTitle(tab) {
            const titles = {
                checkin: 'Check-in',
                checkout: 'Check-out',
                breakfast: 'Breakfast',
                payment: 'Payment Methods',
                services: 'Services',
                general: 'General',
                parking: 'Parking Information',
                traffic: 'Traffic-Calmed Streets',
                camera: 'Camera Surveillance Notice'
            };
            return titles[tab] || tab;
        }

        // Render tab content
        function renderInfoTab() {
            const container = document.getElementById('info-tab-content');
            
            // Language tabs
            const langTabs = `
                <div class="info-lang-tabs">
                    <button class="info-lang-tab ${currentInfoLang === 'en' ? 'active' : ''}" data-lang="en" aria-label="English">ðŸ‡¬ðŸ‡§ EN</button>
                    <button class="info-lang-tab ${currentInfoLang === 'nl' ? 'active' : ''}" data-lang="nl" aria-label="Nederlands">ðŸ‡³ðŸ‡± NL</button>
                    <button class="info-lang-tab ${currentInfoLang === 'fr' ? 'active' : ''}" data-lang="fr" aria-label="FranÃ§ais">ðŸ‡«ðŸ‡· FR</button>
                </div>
            `;
            
            const textValue = infoData[currentInfoTab][currentInfoLang] || '';
            const lineSpacing = infoData[currentInfoTab].lineSpacing || '1.6';
            const tabTitle = getInfoTabTitle(currentInfoTab);
            
            const content = `
                ${langTabs}
                <div class="info-section">
                    <h4>${escapeHtml(tabTitle)}</h4>
                    <p style="color: var(--color-sage); font-size: 0.9rem; margin-bottom: 0.5rem;">Enter the information text in ${currentInfoLang === 'en' ? 'English' : currentInfoLang === 'nl' ? 'Dutch' : 'French'}. Press Enter to add line spacing between paragraphs.</p>
                    <textarea id="info-text-input" class="admin-textarea" placeholder="Enter ${tabTitle.toLowerCase()} information">${escapeHtml(textValue)}</textarea>
                    
                    <div style="margin-top: 1.5rem;">
                        <label for="line-spacing-input" style="display: block; color: var(--color-sage); font-size: 0.9rem; margin-bottom: 0.5rem;">Line Spacing (line-height)</label>
                        <input type="number" id="line-spacing-input" min="1" max="3" step="0.1" value="${lineSpacing}" style="padding: 0.5rem; border: 1px solid var(--color-sage); border-radius: 4px; width: 100px; font-family: 'Raleway', sans-serif;">
                        <span style="color: var(--color-sage); font-size: 0.85rem; margin-left: 0.5rem;">(1.0 - 3.0, default: 1.6)</span>
                    </div>
                </div>
                <button class="btn" id="save-info-btn">Save ${escapeHtml(tabTitle)}</button>
            `;
            
            container.innerHTML = content;
            
            // Attach save handler
            attachInfoSaveHandler();
        }

        // Attach save button handler
        function attachInfoSaveHandler() {
            const saveBtn = document.getElementById('save-info-btn');
            
            if (saveBtn) {
                saveBtn.addEventListener('click', async () => {
                    const value = document.getElementById('info-text-input').value;
                    const lineSpacing = document.getElementById('line-spacing-input').value;
                    infoData[currentInfoTab][currentInfoLang] = value;
                    infoData[currentInfoTab].lineSpacing = lineSpacing;
                    await saveInfoData();
                });
            }
        }

        // Save to Firebase
        async function saveInfoData() {
            try {
                await set(dbRef(database, 'hotelInfo'), infoData);
                showSuccessNotification('Info content saved successfully!');
            } catch (error) {
                console.error('Error saving Info data:', error);
                showErrorNotification('Failed to save. Please try again.');
            }
        }

        // ==================== PRIVACY POLICY MANAGEMENT ====================
        
        let privacyPolicyData = {
            en: '',
            nl: '',
            fr: ''
        };

        document.getElementById('manage-privacy-policy-btn').addEventListener('click', async () => {
            document.getElementById('vertical-menu').classList.remove('show');
            await loadPrivacyPolicy();
            showPrivacyPolicyModal();
        });

        async function loadPrivacyPolicy() {
            try {
                const snapshot = await get(dbRef(database, 'privacyPolicy'));
                if (snapshot.exists()) {
                    privacyPolicyData = snapshot.val();
                } else {
                    privacyPolicyData = { en: '', nl: '', fr: '' };
                }
            } catch (error) {
                console.error('Error loading privacy policy:', error);
                showErrorNotification('Failed to load privacy policy data.');
            }
        }

        function showPrivacyPolicyModal() {
            const modal = document.createElement('div');
            modal.className = 'policy-edit-modal show';
            modal.id = 'privacy-policy-modal';
            modal.innerHTML = `
                <div class="policy-edit-content">
                    <h3>Manage Privacy Policy</h3>
                    <div class="policy-modal-tabs">
                        <button class="policy-modal-tab active" data-lang="en">ðŸ‡¬ðŸ‡§ EN</button>
                        <button class="policy-modal-tab" data-lang="nl">ðŸ‡³ðŸ‡± NL</button>
                        <button class="policy-modal-tab" data-lang="fr">ðŸ‡«ðŸ‡· FR</button>
                    </div>
                    <div class="policy-modal-body">
                        <div class="policy-modal-panel" data-lang="en">
                            <div class="form-group">
                                <label>Privacy Policy Content (English)</label>
                                <div id="privacy-editor-en" class="quill-editor"></div>
                            </div>
                        </div>
                        <div class="policy-modal-panel" data-lang="nl" style="display: none;">
                            <div class="form-group">
                                <label>Privacy Policy Content (Nederlands)</label>
                                <div id="privacy-editor-nl" class="quill-editor"></div>
                            </div>
                        </div>
                        <div class="policy-modal-panel" data-lang="fr" style="display: none;">
                            <div class="form-group">
                                <label>Privacy Policy Content (FranÃ§ais)</label>
                                <div id="privacy-editor-fr" class="quill-editor"></div>
                            </div>
                        </div>
                    </div>
                    <div class="policy-edit-actions">
                        <button class="btn" onclick="savePrivacyPolicy()">Save Changes</button>
                        <button class="btn btn-cancel" onclick="closePrivacyPolicyModal()">Cancel</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);

            // Initialize Quill editors
            window.privacyEditors = {
                en: new Quill('#privacy-editor-en', {
                    theme: 'snow',
                    modules: {
                        toolbar: [
                            [{ 'header': [1, 2, 3, false] }],
                            ['bold', 'italic', 'underline'],
                            [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                            ['link'],
                            ['clean']
                        ]
                    }
                }),
                nl: new Quill('#privacy-editor-nl', {
                    theme: 'snow',
                    modules: {
                        toolbar: [
                            [{ 'header': [1, 2, 3, false] }],
                            ['bold', 'italic', 'underline'],
                            [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                            ['link'],
                            ['clean']
                        ]
                    }
                }),
                fr: new Quill('#privacy-editor-fr', {
                    theme: 'snow',
                    modules: {
                        toolbar: [
                            [{ 'header': [1, 2, 3, false] }],
                            ['bold', 'italic', 'underline'],
                            [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                            ['link'],
                            ['clean']
                        ]
                    }
                })
            };

            // Set existing content
            window.privacyEditors.en.root.innerHTML = privacyPolicyData.en || '';
            window.privacyEditors.nl.root.innerHTML = privacyPolicyData.nl || '';
            window.privacyEditors.fr.root.innerHTML = privacyPolicyData.fr || '';

            // Tab switching
            modal.querySelectorAll('.policy-modal-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    modal.querySelectorAll('.policy-modal-tab').forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    const lang = tab.dataset.lang;
                    modal.querySelectorAll('.policy-modal-panel').forEach(panel => {
                        panel.style.display = panel.dataset.lang === lang ? 'block' : 'none';
                    });
                });
            });
        }

        window.closePrivacyPolicyModal = function() {
            document.getElementById('privacy-policy-modal')?.remove();
            window.privacyEditors = null;
        };

        window.savePrivacyPolicy = async function() {
            try {
                privacyPolicyData = {
                    en: window.privacyEditors.en.root.innerHTML,
                    nl: window.privacyEditors.nl.root.innerHTML,
                    fr: window.privacyEditors.fr.root.innerHTML
                };

                await set(dbRef(database, 'privacyPolicy'), privacyPolicyData);
                showSuccessNotification('Privacy Policy saved successfully!');
                closePrivacyPolicyModal();
            } catch (error) {
                console.error('Error saving privacy policy:', error);
                showErrorNotification('Failed to save privacy policy. Please try again.');
            }
        };

        // ==================== TERMS & CONDITIONS MANAGEMENT ====================
        
        let termsData = {
            en: '',
            nl: '',
            fr: ''
        };

        document.getElementById('manage-terms-btn').addEventListener('click', async () => {
            document.getElementById('vertical-menu').classList.remove('show');
            await loadTerms();
            showTermsModal();
        });

        async function loadTerms() {
            try {
                const snapshot = await get(dbRef(database, 'termsAndConditions'));
                if (snapshot.exists()) {
                    termsData = snapshot.val();
                } else {
                    termsData = { en: '', nl: '', fr: '' };
                }
            } catch (error) {
                console.error('Error loading terms:', error);
                showErrorNotification('Failed to load terms data.');
            }
        }

        function showTermsModal() {
            const modal = document.createElement('div');
            modal.className = 'policy-edit-modal show';
            modal.id = 'terms-modal';
            modal.innerHTML = `
                <div class="policy-edit-content">
                    <h3>Manage Terms & Conditions</h3>
                    <div class="policy-modal-tabs">
                        <button class="policy-modal-tab active" data-lang="en">ðŸ‡¬ðŸ‡§ EN</button>
                        <button class="policy-modal-tab" data-lang="nl">ðŸ‡³ðŸ‡± NL</button>
                        <button class="policy-modal-tab" data-lang="fr">ðŸ‡«ðŸ‡· FR</button>
                    </div>
                    <div class="policy-modal-body">
                        <div class="policy-modal-panel" data-lang="en">
                            <div class="form-group">
                                <label>Terms & Conditions Content (English)</label>
                                <div id="terms-editor-en" class="quill-editor"></div>
                            </div>
                        </div>
                        <div class="policy-modal-panel" data-lang="nl" style="display: none;">
                            <div class="form-group">
                                <label>Terms & Conditions Content (Nederlands)</label>
                                <div id="terms-editor-nl" class="quill-editor"></div>
                            </div>
                        </div>
                        <div class="policy-modal-panel" data-lang="fr" style="display: none;">
                            <div class="form-group">
                                <label>Terms & Conditions Content (FranÃ§ais)</label>
                                <div id="terms-editor-fr" class="quill-editor"></div>
                            </div>
                        </div>
                    </div>
                    <div class="policy-edit-actions">
                        <button class="btn" onclick="saveTerms()">Save Changes</button>
                        <button class="btn btn-cancel" onclick="closeTermsModal()">Cancel</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);

            // Initialize Quill editors
            window.termsEditors = {
                en: new Quill('#terms-editor-en', {
                    theme: 'snow',
                    modules: {
                        toolbar: [
                            [{ 'header': [1, 2, 3, false] }],
                            ['bold', 'italic', 'underline'],
                            [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                            ['link'],
                            ['clean']
                        ]
                    }
                }),
                nl: new Quill('#terms-editor-nl', {
                    theme: 'snow',
                    modules: {
                        toolbar: [
                            [{ 'header': [1, 2, 3, false] }],
                            ['bold', 'italic', 'underline'],
                            [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                            ['link'],
                            ['clean']
                        ]
                    }
                }),
                fr: new Quill('#terms-editor-fr', {
                    theme: 'snow',
                    modules: {
                        toolbar: [
                            [{ 'header': [1, 2, 3, false] }],
                            ['bold', 'italic', 'underline'],
                            [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                            ['link'],
                            ['clean']
                        ]
                    }
                })
            };

            // Set existing content
            window.termsEditors.en.root.innerHTML = termsData.en || '';
            window.termsEditors.nl.root.innerHTML = termsData.nl || '';
            window.termsEditors.fr.root.innerHTML = termsData.fr || '';

            // Tab switching
            modal.querySelectorAll('.policy-modal-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    modal.querySelectorAll('.policy-modal-tab').forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    const lang = tab.dataset.lang;
                    modal.querySelectorAll('.policy-modal-panel').forEach(panel => {
                        panel.style.display = panel.dataset.lang === lang ? 'block' : 'none';
                    });
                });
            });
        }

        window.closeTermsModal = function() {
            document.getElementById('terms-modal')?.remove();
            window.termsEditors = null;
        };

        window.saveTerms = async function() {
            try {
                termsData = {
                    en: window.termsEditors.en.root.innerHTML,
                    nl: window.termsEditors.nl.root.innerHTML,
                    fr: window.termsEditors.fr.root.innerHTML
                };

                await set(dbRef(database, 'termsAndConditions'), termsData);
                showSuccessNotification('Terms & Conditions saved successfully!');
                closeTermsModal();
            } catch (error) {
                console.error('Error saving terms:', error);
                showErrorNotification('Failed to save terms. Please try again.');
            }
        };

        // ========================================
        // Translation Management System
        // ========================================

        // Define all translatable strings with their default English values
        const translationKeys = {
            // Navigation Menu
            nav: {
                home: "Home",
                rooms: "Rooms",
                packages: "Packages",
                facilities: "Facilities",
                meetings: "Meetings",
                info: "Info",
                more: "More",
                attractions: "Attractions",
                groupRequest: "Group Request",
                bookNow: "Book Now"
            },
            // Home Page
            home: {
                title: "Welcome to Hotel Elisabeth Mechelen",
                checkInLabel: "Check-in",
                checkOutLabel: "Check-out",
                searchButton: "Search",
                aboutUsTitle: "ELISABETH HOTEL",
                ourPicksTitle: "Our Picks"
            },
            // Rooms Page
            rooms: {
                pageTitle: "Our Rooms & Suites",
                tagline: "Exclusive Accommodations",
                mainTitle: "Discover Your Perfect Stay",
                subtitle: "Experience comfort and elegance in every detail",
                sectionTitle: "Our Rooms & Suites",
                ctaTitle: "Ready to Book Your Stay?",
                ctaButton: "Book Now",
                introText: "Each of our thoughtfully designed rooms offers a perfect blend of contemporary style and timeless comfort. From cozy retreats to spacious suites, find your ideal sanctuary in the heart of Mechelen.",
                loading: "Loading rooms...",
                ctaText: "Experience the perfect blend of comfort and refinement",
                checkinLabel: "Check-in",
                checkoutLabel: "Check-out",
                selectDatePlaceholder: "Select date",
                searchButton: "Search"
            },
            // Packages Page
            packages: {
                pageTitle: "Our Packages",
                mainTitle: "Special Packages & Offers",
                subtitle: "Discover our exclusive deals and special offers for an unforgettable stay",
                loading: "Loading packages...",
                noAvailable: "No Packages Available",
                checkBackSoon: "Check back soon for exciting new offers!",
                sectionIncluded: "Included",
                sectionGoodToKnow: "Good to Know",
                teaserDefault: "Click for more details",
                viewDetails: "View Details",
                hideDetails: "Hide Details",
                bookNow: "Book Now"
            },
            // Facilities Page
            facilities: {
                pageTitle: "Facilities & Services",
                mainTitle: "Discover Our Facilities",
                subtitle: "From wellness experiences to business essentials",
                heroTagline: "Hotel Elisabeth Mechelen",
                heroSubtitle: "Thoughtfully curated spaces designed for comfort and ease.",
                loading: "Loading facilities...",
                closeButton: "Close lightbox",
                previousButton: "Previous photo",
                nextButton: "Next photo"
            },
            // Meetings Page
            meetings: {
                pageTitle: "Meetings & Events",
                mainTitle: "Your Perfect Event Space",
                subtitle: "Professional meeting rooms and event facilities"
            },
            // Info Page
            info: {
                pageTitle: "Hotel Information",
                mainTitle: "Everything You Need to Know",
                heroTagline: "Everything You Need to Know",
                heroSubtitle: "Essential details for a seamless stay",
                introText: "Welcome to Hotel Elisabeth Mechelen. Below you'll find all the essential information about check-in procedures, services, amenities, and policies to make your stay as comfortable and enjoyable as possible.",
                checkInTitle: "Check-in",
                checkOutTitle: "Check-out",
                breakfastTitle: "Breakfast",
                paymentTitle: "Payment Methods",
                servicesTitle: "Services",
                generalTitle: "General Information",
                parkingTitle: "Parking Information",
                loading: "Loading..."
            },
            // Attractions Page
            attractions: {
                pageTitle: "Local Attractions",
                mainTitle: "Discover Mechelen",
                subtitle: "Explore the best of our beautiful city",
                heroTitle: "Discover Mechelen",
                heroSubtitle: "Your next adventure awaits",
                loading: "Loading attractions...",
                noAvailable: "No Attractions Available"
            },
            // Group Request Page
            groupRequest: {
                pageTitle: "Group Accommodation Request",
                mainTitle: "Group Booking Request",
                tagline: "Special Group Bookings",
                heroSubtitle: "Plan your perfect group stay with customized arrangements and personalized service",
                formTitle: "Request Your Group Booking",
                formSubtitle: "Fill out the form below and we'll get back to you shortly with a customized quotation.",
                submitButton: "Submit Group Request",
                fieldFirstName: "First Name *",
                fieldLastName: "Last Name *",
                fieldEmail: "Email Address *",
                fieldTelephone: "Telephone Number *",
                fieldCheckinDate: "Check-in Date *",
                fieldCheckoutDate: "Check-out Date *",
                fieldTotalGuests: "Total Number of Guests *",
                fieldSingleRooms: "Number of Single Rooms",
                fieldTwinRooms: "Number of Twin Rooms (2 Separate Beds)",
                fieldDoubleRooms: "Number of Double Rooms (One Double Bed)",
                fieldTripleRooms: "Number of Triple Rooms (3 Single Beds)",
                fieldGroupType: "Group Type *",
                selectGroupType: "Select group type",
                optionBusiness: "Business",
                optionFamilyReunion: "Family Reunion",
                optionBirthday: "Birthday",
                optionBachelorParty: "Bachelor Party",
                optionBacheloretteParty: "Bachelorette Party",
                optionWedding: "Wedding",
                optionOther: "Other",
                fieldMealOption: "Meal Option *",
                selectMealOption: "Select meal option",
                optionBreakfastOnly: "Breakfast Only",
                optionBreakfastPackedLunch: "Breakfast and Packed Lunch",
                optionPackedLunchOnly: "Packed Lunch Only",
                optionBreakfastDinner: "Breakfast and Dinner",
                optionFullBoard: "Breakfast, Lunch and Dinner",
                optionDinnerOnly: "Dinner Only",
                optionNoFood: "We do not require food service",
                fieldMessage: "Additional Message",
                messagePlaceholder: "Please provide any additional information or special requests...",
                consentText: "Yes, I agree for Elisabeth Hotel Mechelen / Group Daedalus to use my details for the purpose of transmitting information about Elisabeth Hotel Mechelen / Group Daedalus and statistical purposes. I can revoke this consent at any time by sending an e-mail to info@elisabeth-hotel.be. Further information on the handling of your data can be found in our privacy policy. *",
                successTitle: "Thank You!",
                successMessage: "Your group request has been successfully submitted. We will contact you shortly to discuss your booking.",
                errorMessage: "There was an error submitting your request. Please try again or contact us directly at info@elisabeth-hotel.be.",
                selectDatePlaceholder: "Select date"
            },
            // Careers Page
            careers: {
                pageTitle: "Career Opportunities",
                heroTagline: "Join Our Team",
                heroSubtitle: "Be part of an exceptional hospitality experience",
                sectionTitle: "Work With Us",
                introText: "At Hotel Elisabeth Mechelen, we believe in creating memorable experiences for our guests while fostering a supportive and dynamic work environment for our team.",
                filterLabel: "Filter by Department:",
                optionAllDepartments: "All Departments",
                loading: "Loading career opportunities...",
                noOpenings: "No Current Openings",
                noOpeningsText: "We currently don't have any open positions, but we're always looking for talented individuals. Please check back soon!",
                ctaTitle: "Questions About Working With Us?",
                ctaText: "Feel free to reach out to our HR department",
                contactButton: "Contact Us"
            },
            // Policies Page
            policies: {
                pageTitle: "Hotel Policies",
                intro: "Read our hotel policies regarding check-in, check-out, cancellations, and guest conduct."
            },
            // Footer
            footer: {
                contactTitle: "Contact",
                phoneLabel: "PHONE:",
                emailLabel: "EMAIL:",
                addressLabel: "ADDRESS:",
                socialTitle: "Social",
                informationTitle: "Information",
                privacyPolicy: "Privacy Policy",
                termsConditions: "Terms & Conditions",
                hotelPolicies: "Hotel Policies",
                careers: "Careers"
            },
            // Common Elements
            common: {
                loading: "Loading...",
                save: "Save",
                cancel: "Cancel",
                delete: "Delete",
                edit: "Edit",
                add: "Add",
                upload: "Upload",
                close: "Close",
                back: "Back",
                next: "Next",
                previous: "Previous"
            }
        };

        // Function to create a translation item UI
        function createTranslationItem(key, englishText, section) {
            const item = document.createElement('div');
            item.className = 'translation-item';
            item.innerHTML = `
                <div class="translation-key">
                    <strong>${key}</strong>
                </div>
                <div class="translation-inputs">
                    <div class="translation-lang-group">
                        <label>ðŸ‡¬ðŸ‡§ English (Default)</label>
                        <input type="text" 
                               class="translation-input" 
                               data-key="${section}.${key}" 
                               data-lang="en" 
                               value="${englishText}"
                               placeholder="English text">
                    </div>
                    <div class="translation-lang-group">
                        <label>ðŸ‡³ðŸ‡± Nederlands</label>
                        <input type="text" 
                               class="translation-input" 
                               data-key="${section}.${key}" 
                               data-lang="nl" 
                               value=""
                               placeholder="Dutch translation">
                    </div>
                    <div class="translation-lang-group">
                        <label>ðŸ‡«ðŸ‡· FranÃ§ais</label>
                        <input type="text" 
                               class="translation-input" 
                               data-key="${section}.${key}" 
                               data-lang="fr" 
                               value=""
                               placeholder="French translation">
                    </div>
                </div>
            `;
            return item;
        }

        // Function to populate translation sections
        function populateTranslations() {
            // Clear existing content
            Object.keys(translationKeys).forEach(section => {
                const container = document.getElementById(`${section}-translations`);
                if (container) {
                    container.innerHTML = '';
                    const keys = translationKeys[section];
                    Object.keys(keys).forEach(key => {
                        const item = createTranslationItem(key, keys[key], section);
                        container.appendChild(item);
                    });
                }
            });
        }

        // Function to load translations from Firebase
        async function loadTranslationsFromFirebase() {
            try {
                const snapshot = await get(dbRef(database, 'translations'));
                if (snapshot.exists()) {
                    const translations = snapshot.val();
                    
                    // Populate input fields with loaded translations
                    document.querySelectorAll('.translation-input').forEach(input => {
                        const key = input.dataset.key;
                        const lang = input.dataset.lang;
                        const [section, subkey] = key.split('.');
                        
                        if (translations[section] && translations[section][subkey] && translations[section][subkey][lang]) {
                            input.value = translations[section][subkey][lang];
                        }
                    });
                    
                    showSuccessNotification('Translations loaded successfully!');
                } else {
                    showErrorNotification('No translations found in Firebase. Using defaults.');
                }
            } catch (error) {
                console.error('Error loading translations:', error);
                showErrorNotification('Failed to load translations from Firebase.');
            }
        }

        // Function to save all translations to Firebase
        async function saveAllTranslations() {
            try {
                const translations = {};
                
                // Collect all translation inputs
                document.querySelectorAll('.translation-input').forEach(input => {
                    const key = input.dataset.key;
                    const lang = input.dataset.lang;
                    const value = input.value.trim();
                    const [section, subkey] = key.split('.');
                    
                    if (!translations[section]) {
                        translations[section] = {};
                    }
                    if (!translations[section][subkey]) {
                        translations[section][subkey] = {};
                    }
                    translations[section][subkey][lang] = value;
                });
                
                // Save to Firebase
                await set(dbRef(database, 'translations'), translations);
                showSuccessNotification('All translations saved successfully!');
            } catch (error) {
                console.error('Error saving translations:', error);
                showErrorNotification('Failed to save translations. Please try again.');
            }
        }

        // Event listener for Page Translations button
        document.getElementById('page-translations-btn').addEventListener('click', () => {
            const translationCard = document.getElementById('translation-management-card');
            const verticalMenu = document.getElementById('vertical-menu');
            
            ensureDashboardVisible();
            hideAllManagementCards();
            translationCard.style.display = 'block';
            translationCard.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            showActionBar('Translation Management', []);
            verticalMenu.classList.remove('show');
            
            // Populate translations on first load
            populateTranslations();
        });

        // Event listeners for translation management buttons
        document.getElementById('save-all-translations-btn').addEventListener('click', saveAllTranslations);
        document.getElementById('load-translations-btn').addEventListener('click', loadTranslationsFromFirebase);

    </script>
</body>
</html>
